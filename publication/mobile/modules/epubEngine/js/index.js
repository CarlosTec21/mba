var CSSJSON=new function(){var e=this;e.init=function(){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.repeat=function(e){return new Array(1+e).join(this)}},e.init();var t=/\/\*[\s\S]*?\*\//g,n=/([^\:]+):([^\;]*);/,s=/(\/\*[\s\S]*?\*\/)|([^\s\;\{\}][^\;\{\}]*(?=\{))|(\})|([^\;\{\}]+\;(?!\s*\*\/))/gim,o=1,r=2,a=3,u=4,l=function(e){return"undefined"==typeof e||0==e.length||null==e},p=function(e){return!l(e)&&(e.attributes&&e.children)};e.toJSON=function(p,h){var c={children:{},attributes:{}},d=null,f=0;if("undefined"==typeof h)var h={ordered:!1,comments:!1,stripComments:!1,split:!1};for(h.stripComments&&(h.comments=!1,p=p.replace(t,""));null!=(d=s.exec(p));)if(!l(d[o])&&h.comments){var m=d[o].trim();c[f++]=m}else if(l(d[r])){if(!l(d[a]))return c;if(!l(d[u])){var g=d[u].trim(),v=n.exec(g);if(v){var y=v[1].trim(),b=v[2].trim();if(h.ordered){var E={};E.name=y,E.value=b,E.type="attr",c[f++]=E}else if(y in c.attributes){var S=c.attributes[y];S instanceof Array||(c.attributes[y]=[S]),c.attributes[y].push(b)}else c.attributes[y]=b}else c[f++]=g}}else{var y=d[r].trim(),P=e.toJSON(p,h);if(h.ordered){var E={};E.name=y,E.value=P,E.type="rule",c[f++]=E}else{if(h.split)var _=y.split(",");else var _=[y];for(i in _){var T=_[i].trim();if(T in c.children)for(var w in P.attributes)c.children[T].attributes[w]=P.attributes[w];else c.children[T]=P}}}return c},e.toCSS=function(e,t,n){var s="";if("undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=!1),e.attributes)for(i in e.attributes){var o=e.attributes[i];if(o instanceof Array)for(var r=0;r<o.length;r++)s+=d(i,o[r],t);else s+=d(i,o,t)}if(e.children){var a=!0;for(i in e.children)n&&!a?s+="\n":a=!1,s+=f(i,e.children[i],t)}return s},e.toHEAD=function(t,i,n){var s=document.getElementsByTagName("head")[0],o=document.getElementById(i),r=null!==o&&o instanceof HTMLStyleElement;if(!l(t)&&s instanceof HTMLHeadElement){if(r){if(n!==!0&&!l(n))return;o.removeAttribute("id")}p(t)&&(t=e.toCSS(t));var a=document.createElement("style");if(a.type="text/css",l(i)?a.id="cssjson_"+c():a.id=i,a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),s.appendChild(a),h(a))r&&o.parentNode.removeChild(o);else{if(a.parentNode.removeChild(a),!r)return;o.setAttribute("id",i),a=o}return a}},"undefined"!=typeof window&&(window.createCSS=e.toHEAD);var h=function(e){return e instanceof HTMLStyleElement&&e.sheet.cssRules.length>0},c=function(){return Date.now()||+new Date},d=function(e,t,i){return"\t".repeat(i)+e+": "+t+";\n"},f=function(t,i,n){var s="\t".repeat(n)+t+" {\n";return s+=e.toCSS(i,n+1),s+="\t".repeat(n)+"}\n"}},Tween=function(){function e(){}e.create=function(){var e=null,t=null,i=null;return function(n,s){for(e=[],t=arguments.length,i=2;i<t;i++)e[i-2]=arguments[i];return function(){s.apply(n,[].concat(arguments,e))}}}();var t=function(e,t,i,n,s,o,r){this.init(e,t,i,n,s,o,r)},i=t.prototype;return i.obj={},i.prop="",i.func=function(e,t,i,n){return i*e/n+t},i.begin=0,i.change=0,i.prevTime=0,i.prevPos=0,i.looping=!1,i._duration=0,i._time=0,i._pos=0,i._position=0,i._startTime=0,i._finish=0,i.name="",i.suffixe="",i._listeners=[],i.setTime=function(e){this.prevTime=this._time,e>this.getDuration()?this.looping?(this.rewind(e-this._duration),this.update(),this.broadcastMessage("onMotionLooped",{target:this,type:"onMotionLooped"})):(this._time=this._duration,this.update(),this.stop(),this.broadcastMessage("onMotionFinished",{target:this,type:"onMotionFinished"})):e<0?(this.rewind(),this.update()):(this._time=e,this.update())},i.getTime=function(){return this._time},i.setDuration=function(e){this._duration=null==e||e<0?1e5:e},i.getDuration=function(){return this._duration},i.setPosition=function(){var e=null;return function(t){this.prevPos=this._pos,e=""!=this.suffixe?this.suffixe:"",this.obj[this.prop]=Math.round(t)+e,this._pos=t,this.broadcastMessage("onMotionChanged",{target:this,type:"onMotionChanged"})}}(),i.getPosition=function(e){return void 0==e&&(e=this._time),this.func(e,this.begin,this.change,this._duration)},i.setFinish=function(e){this.change=e-this.begin},i.getFinish=function(){return this.begin+this.change},i.init=function(e,t,i,n,s,o,r){arguments.length&&(this._listeners=new Array,this.addListener(this),r&&(this.suffixe=r),this.obj=e,this.prop=t,this.begin=n,this._pos=n,this.setDuration(o),null!=i&&""!=i&&(this.func=i),this.setFinish(s))},i.start=function(){this.rewind(),this.startEnterFrame(),this.broadcastMessage("onMotionStarted",{target:this,type:"onMotionStarted"})},i.rewind=function(e){this.stop(),this._time=void 0==e?0:e,this.fixTime(),this.update()},i.fforward=function(){this._time=this._duration,this.fixTime(),this.update()},i.update=function(){this.setPosition(this.getPosition(this._time))},i.startEnterFrame=function(){this.stopEnterFrame(),this.isPlaying=!0,this.onEnterFrame()},i.onEnterFrame=function(){this.isPlaying&&(this.nextFrame(),window.requestAnimationFrame(e.create(this,this.onEnterFrame)))},i.nextFrame=function(){this.setTime((this.getTimer()-this._startTime)/1e3)},i.stop=function(){this.stopEnterFrame(),this.broadcastMessage("onMotionStopped",{target:this,type:"onMotionStopped"})},i.stopEnterFrame=function(){this.isPlaying=!1},i.continueTo=function(e,t){this.begin=this._pos,this.setFinish(e),void 0!=this._duration&&this.setDuration(t),this.start()},i.resume=function(){this.fixTime(),this.startEnterFrame(),this.broadcastMessage("onMotionResumed",{target:this,type:"onMotionResumed"})},i.yoyo=function(){this.continueTo(this.begin,this._time)},i.addListener=function(e){return this.removeListener(e),this._listeners.push(e)},i.removeListener=function(){var e=null,t=null;return function(i){for(e=this._listeners,t=e.length;t--;)if(e[t]==i)return e.splice(t,1),!0;return!1}}(),i.broadcastMessage=function(){var e=null,t=null,i=null,n=null,s=null,o=null;return function(){for(e=[],t=o=arguments.length;o--;)e.push(arguments[t-(o+1)]);for(i=e.shift(),n=this._listeners,s=n.length;s--;)n[s][i]&&n[s][i].apply(n[s],e)}}(),i.fixTime=function(){this._startTime=this.getTimer()-1e3*this._time},i.getTimer=function(){return(new Date).getTime()-this._time},t.backEaseIn=function(e,t,i,n,s,o){if(void 0==r)var r=1.70158;return i*(e/=n)*e*((r+1)*e-r)+t},t.backEaseOut=function(e,t,i,n,s,o){if(void 0==r)var r=1.70158;return i*((e=e/n-1)*e*((r+1)*e+r)+1)+t},t.backEaseInOut=function(e,t,i,n,s,o){if(void 0==r)var r=1.70158;return(e/=n/2)<1?i/2*(e*e*(((r*=1.525)+1)*e-r))+t:i/2*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)+t},t.elasticEaseIn=function(e,t,i,n,s,o){if(0==e)return t;if(1==(e/=n))return t+i;if(o||(o=.3*n),!s||s<Math.abs(i)){s=i;var r=o/4}else var r=o/(2*Math.PI)*Math.asin(i/s);return-(s*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/o))+t},t.elasticEaseOut=function(e,t,i,n,s,o){if(0==e)return t;if(1==(e/=n))return t+i;if(o||(o=.3*n),!s||s<Math.abs(i)){s=i;var r=o/4}else var r=o/(2*Math.PI)*Math.asin(i/s);return s*Math.pow(2,-10*e)*Math.sin((e*n-r)*(2*Math.PI)/o)+i+t},t.elasticEaseInOut=function(e,t,i,n,s,o){if(0==e)return t;if(2==(e/=n/2))return t+i;if(!o)var o=n*(.3*1.5);if(!s||s<Math.abs(i))var s=i,r=o/4;else var r=o/(2*Math.PI)*Math.asin(i/s);return e<1?-.5*(s*Math.pow(2,10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/o))+t:s*Math.pow(2,-10*(e-=1))*Math.sin((e*n-r)*(2*Math.PI)/o)*.5+i+t},t.bounceEaseOut=function(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t},t.bounceEaseIn=function(e,i,n,s){return n-t.bounceEaseOut(s-e,0,n,s)+i},t.bounceEaseInOut=function(e,i,n,s){return e<s/2?.5*t.bounceEaseIn(2*e,0,n,s)+i:.5*t.bounceEaseOut(2*e-s,0,n,s)+.5*n+i},t.strongEaseInOut=function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},t.regularEaseIn=function(e,t,i,n){return i*(e/=n)*e+t},t.regularEaseOut=function(e,t,i,n){return-i*(e/=n)*(e-2)+t},t.regularEaseInOut=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},t.strongEaseIn=function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},t.strongEaseOut=function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},t.strongEaseInOut=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},t}();!function(){function e(t,i,n){function s(r,a){if(!i[r]){if(!t[r]){var u="function"==typeof require&&require;if(!a&&u)return u(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var p=i[r]={exports:{}};t[r][0].call(p.exports,function(e){var i=t[r][1][e];return s(i||e)},p,p.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}return e}()({1:[function(e,t,i){(function(n,s){!function(e,n){"object"==typeof i&&"undefined"!=typeof t?t.exports=n():"function"==typeof define&&define.amd?define(n):e.ES6Promise=n()}(this,function(){"use strict";function t(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function i(e){return"function"==typeof e}function o(e){H=e}function r(e){Z=e}function a(){return function(){return n.nextTick(c)}}function u(){return"undefined"!=typeof z?function(){z(c)}:h()}function l(){var e=0,t=new X(c),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}function p(){var e=new MessageChannel;return e.port1.onmessage=c,function(){return e.port2.postMessage(0)}}function h(){var e=setTimeout;return function(){return e(c,1)}}function c(){for(var e=0;e<j;e+=2){var t=Q[e],i=Q[e+1];t(i),Q[e]=void 0,Q[e+1]=void 0}j=0}function d(){try{var e=Function("return this")().require("vertx");return z=e.runOnLoop||e.runOnContext,u()}catch(t){return h()}}function f(e,t){var i=this,n=new this.constructor(g);void 0===n[$]&&x(n);var s=i._state;if(s){var o=arguments[s-1];Z(function(){return C(s,n,o,i._result)})}else O(i,n,e,t);return n}function m(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var i=new t(g);return _(i,e),i}function g(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function b(e,t,i,n){try{e.call(t,i,n)}catch(s){return s}}function E(e,t,i){Z(function(e){var n=!1,s=b(i,t,function(i){n||(n=!0,t!==i?_(e,i):w(e,i))},function(t){n||(n=!0,A(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&s&&(n=!0,A(e,s))},e)}function S(e,t){t._state===te?w(e,t._result):t._state===ie?A(e,t._result):O(t,void 0,function(t){return _(e,t)},function(t){return A(e,t)})}function P(e,t,n){t.constructor===e.constructor&&n===f&&t.constructor.resolve===m?S(e,t):void 0===n?w(e,t):i(n)?E(e,t,n):w(e,t)}function _(e,i){if(e===i)A(e,v());else if(t(i)){var n=void 0;try{n=i.then}catch(s){return void A(e,s)}P(e,i,n)}else w(e,i)}function T(e){e._onerror&&e._onerror(e._result),M(e)}function w(e,t){e._state===ee&&(e._result=t,e._state=te,0!==e._subscribers.length&&Z(M,e))}function A(e,t){e._state===ee&&(e._state=ie,e._result=t,Z(T,e))}function O(e,t,i,n){var s=e._subscribers,o=s.length;e._onerror=null,s[o]=t,s[o+te]=i,s[o+ie]=n,0===o&&e._state&&Z(M,e)}function M(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var n=void 0,s=void 0,o=e._result,r=0;r<t.length;r+=3)n=t[r],s=t[r+i],n?C(i,n,s,o):s(o);e._subscribers.length=0}}function C(e,t,n,s){var o=i(n),r=void 0,a=void 0,u=!0;if(o){try{r=n(s)}catch(l){u=!1,a=l}if(t===r)return void A(t,y())}else r=s;t._state!==ee||(o&&u?_(t,r):u===!1?A(t,a):e===te?w(t,r):e===ie&&A(t,r))}function L(e,t){try{t(function(t){_(e,t)},function(t){A(e,t)})}catch(i){A(e,i)}}function D(){return ne++}function x(e){e[$]=ne++,e._state=void 0,e._result=void 0,e._subscribers=[]}function I(){return new Error("Array Methods must be provided an Array")}function N(e){return new se(this,e).promise}function k(e){var t=this;return new t(F(e)?function(i,n){for(var s=e.length,o=0;o<s;o++)t.resolve(e[o]).then(i,n)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function R(e){var t=this,i=new t(g);return A(i,e),i}function V(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function G(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function U(){var e=void 0;if("undefined"!=typeof s)e=s;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=e.Promise;if(i){var n=null;try{n=Object.prototype.toString.call(i.resolve())}catch(t){}if("[object Promise]"===n&&!i.cast)return}e.Promise=oe}var B=void 0;B=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var F=B,j=0,z=void 0,H=void 0,Z=function(e,t){Q[j]=e,Q[j+1]=t,j+=2,2===j&&(H?H(c):J())},W="undefined"!=typeof window?window:void 0,Y=W||{},X=Y.MutationObserver||Y.WebKitMutationObserver,q="undefined"==typeof self&&"undefined"!=typeof n&&"[object process]"==={}.toString.call(n),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Q=new Array(1e3),J=void 0;J=q?a():X?l():K?p():void 0===W&&"function"==typeof e?d():h();var $=Math.random().toString(36).substring(2),ee=void 0,te=1,ie=2,ne=0,se=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(g),this.promise[$]||x(this.promise),F(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?w(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&w(this.promise,this._result))):A(this.promise,I())}return e.prototype._enumerate=function(e){for(var t=0;this._state===ee&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var i=this._instanceConstructor,n=i.resolve;if(n===m){var s=void 0,o=void 0,r=!1;try{s=e.then}catch(a){r=!0,o=a}if(s===f&&e._state!==ee)this._settledAt(e._state,t,e._result);else if("function"!=typeof s)this._remaining--,this._result[t]=e;else if(i===oe){var u=new i(g);r?A(u,o):P(u,e,s),this._willSettleAt(u,t)}else this._willSettleAt(new i(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,i){var n=this.promise;n._state===ee&&(this._remaining--,e===ie?A(n,i):this._result[t]=i),0===this._remaining&&w(n,this._result)},e.prototype._willSettleAt=function(e,t){var i=this;O(e,void 0,function(e){return i._settledAt(te,t,e)},function(e){return i._settledAt(ie,t,e)})},e}(),oe=function(){function e(t){this[$]=D(),this._result=this._state=void 0,this._subscribers=[],g!==t&&("function"!=typeof t&&V(),this instanceof e?L(this,t):G())}return e.prototype["catch"]=function(e){return this.then(null,e)},e.prototype["finally"]=function(e){var t=this,n=t.constructor;return i(e)?t.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):t.then(e,e)},e}();return oe.prototype.then=f,oe.all=N,oe.race=k,oe.resolve=m,oe.reject=R,oe._setScheduler=o,oe._setAsap=r,oe._asap=Z,oe.polyfill=U,oe.Promise=oe,oe})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(e,t,i){function n(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(h===setTimeout)return setTimeout(e,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function r(e){if(c===clearTimeout)return clearTimeout(e);if((c===s||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function a(){g&&f&&(g=!1,f.length?m=f.concat(m):v=-1,m.length&&u())}function u(){if(!g){var e=o(a);g=!0;for(var t=m.length;t;){for(f=m,m=[];++v<t;)f&&f[v].run();v=-1,t=m.length}f=null,g=!1,r(e)}}function l(e,t){this.fun=e,this.array=t}function p(){}var h,c,d=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(e){h=n}try{c="function"==typeof clearTimeout?clearTimeout:s}catch(e){c=s}}();var f,m=[],g=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];m.push(new l(e,t)),1!==m.length||g||o(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=p,d.addListener=p,d.once=p,d.off=p,d.removeListener=p,d.removeAllListeners=p,d.emit=p,d.prependListener=p,d.prependOnceListener=p,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],3:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./EpubConfig/EpubDefaultConfig"),o=e("./utils/enums"),r=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.setConfig=function(t){e.prototype.setConfig.call(this,t),this.device=this.userAgent.device.type,this.browser=this.userAgent.browser.name,this.os=this.userAgent.os.name;var i="device_"+this.device,n="browser_"+this.browser,s="os_"+this.os;document.documentElement.classList.add("pagetype-"+o.READER_TYPES[this.readerPageSrcType].toLowerCase()),"function"==typeof this[i]&&this[i](),"function"==typeof this[n]&&this[n](),"function"==typeof this[s]&&this[s]()},t.prototype.device_phone=function(){},t.prototype.device_tab=function(){},t.prototype.device_desktop=function(){this.timeToRefreshScreenResize=0},t.prototype.browser_safari=function(){},t.prototype.browser_chrome=function(){},t.prototype.browser_firefox=function(){},t.prototype.browser_ie=function(){},t.prototype.browser_edge=function(){},t.prototype.browser_android=function(){},t.prototype.os_windows=function(){},t.prototype.os_mac=function(){},t.prototype.os_iOS=function(){},t.prototype.os_android=function(){},t}(s["default"]);i["default"]=r},{"./EpubConfig/EpubDefaultConfig":4,"./utils/enums":84}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("../utils/enums"),o=e("../EpubEvent");!function(e){e.CONTAIN="contain",e.COVER_HORIZONTALLY="coverHorizontally"}(n=i.PagesSizeTypes||(i.PagesSizeTypes={}));var r;!function(e){e.X="x",e.Y="y"}(r=i.NavigationAxis||(i.NavigationAxis={}));var a=function(){function e(e){this._linksSizePageWidth=0,this._linksSizePageHeight=0,this._paddingBottom=0,this._paddingTop=0,this._paddingLeft=0,this._paddingRight=0,this._maxSpreadsLength=3,this._pageQuantity=0,this._firstSpreadSize=1,this._pageSizeType=n.CONTAIN,this._pageSizeMaxHeight=0,this._coverPageCenter=!1,this._currentPageAtInit=1,this.countPageChange=0,this._currentPage=1,this.lastPage=1,this.domMode="html",this._spreadDraggable=!0,this.highQualityKey="hdpi",this._linkBoxAspect=s.LinksBehaviors.blink,this._linkBlinkDuration=1e3,this._pdfHTMLMaxFontLoad=0,this.pageBgColor="#fff",this.pagesRetina=!0,this._verticalSlider=!1,this.timeToRefreshScreenResize=50,this.switchLandScapeUsingPageSize=!1,this.pagesBySpreadMax=2,this.pagesBySpreadUseApiPageManager=!1,this.scrollablePages=[],this._zoomDoubleClick=!0,this._zoomSingleClick=!1,this.zoomPinch=!0,this.zoomRetina=!0,this._zoomFactor=.008,this._maxZoom=1,this.defaultPageScaleAt=.75,this.maxPageTotalScale=1.5,this._transitionTime=.2,this._use3DMatrixTransform=!1,this._useMatrixTransformZoomable=!0,this._useMatrixTransformScrollable=!0,this._enableAspLinks=!0,this._readerPageSrcType=s.READER_TYPES.EPUB_HTML,this.pageNeverChanged=!0,this.mainViewElementClassName="webpub-viewer__epub-container",this.spreadViewElementClassName="webpub-viewer__epub-container-spread",this.zoomableViewElementClassName="webpub-viewer__epub-container-spread-zoomable";this._currentPageAtInit=parseInt(w.Main.urlManager.get("page")||this._currentPage,10),this.epubEvent=w.epubEvent,this.userAgent=w.Param.userAgent,this.pageMargin=[0,0,0,0],this.linksSizePageWidth=parseFloat(w.Main.xmlManager.get("common-configuration","contents","swf","width")),this.linksSizePageHeight=parseFloat(w.Main.xmlManager.get("common-configuration","contents","swf","height")),this.menuViewPageControlItems=w.Main.xmlManager.get("common-ui","panelViewControlItems"),this.scrollablePages=w.Main.xmlManager.get("comboPages","scrollablePages"),this._firstSpreadSize=w.Main.pageLayoutService.get("pagesOnFirstFrame"),this.handleTransparentPageConfig()}return e.prototype.paddinigsUpdate=function(){var e=this.paddings;this.paddingLeft=~~e.paddingLeft+this.pageMargin[0],this.paddingTop=~~e.paddingTop+this.pageMargin[1],this.paddingRight=~~e.paddingRight+this.pageMargin[2],this.paddingBottom=~~e.paddingBottom+this.pageMargin[3]},Object.defineProperty(e.prototype,"paddings",{get:function(){return w.Main.viewerService.getPadding()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossNavPublication",{get:function(){return this.pageSizeType===n.COVER_HORIZONTALLY},enumerable:!0,configurable:!0}),e.prototype.isCrossNavPage=function(e){var t=this.scrollablePages.includes(e);return this.isCrossNavPublication||t},e.prototype.hasCrossNavPage=function(){var e=this.scrollablePages.length>0;return this.isCrossNavPublication||e},Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(e){this._paddingBottom=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(e){this._paddingTop=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(e){this._paddingLeft=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(e){this._paddingRight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linksSizePageHeight",{get:function(){return this._linksSizePageHeight},set:function(e){this._linksSizePageHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linksSizePageWidth",{get:function(){return this._linksSizePageWidth/2},set:function(e){this._linksSizePageWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkBoxAspect",{get:function(){return this._linkBoxAspect},set:function(e){this._linkBoxAspect=s.LinksBehaviors[e]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkBlinkDuration",{get:function(){return this._linkBlinkDuration},set:function(e){this._linkBlinkDuration=e,this.addLinkStyleTags()},enumerable:!0,configurable:!0}),e.prototype.handleTransparentPageConfig=function(){var e=w.Main.configsJsonManager.getPagesData(["isTransparent"]);if(e){for(var t="",i=0;i<e.length;i++){var n=e[i];n&&n.isTransparent&&(t+=".pagetype-epub_html .webpub-viewer__epub-container-spread-page.spread-page-"+(i+1)+":before{display: none}")}var s=document.head.appendChild(document.createElement("style"));s.innerHTML=t}},e.prototype.addLinkStyleTags=function(e){void 0===e&&(e="ms"),void 0===this.styleElement&&(this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement));var t=".webpub-viewer__epub-container .epub-links_container-link{-webkit-animation-duration: "+(this.linkBlinkDuration+e)+"!important;animation-duration: "+(this.linkBlinkDuration+e)+"!important;}";this.styleElement.type="text/css",this.styleElement.innerText=t},Object.defineProperty(e.prototype,"navigationAxis",{get:function(){return this.verticalSlider===!1?r.X:r.Y},set:function(e){e===r.X?this.verticalSlider=!1:this.verticalSlider=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalSlider",{get:function(){return this._verticalSlider},set:function(e){this._verticalSlider=e,this._verticalSlider?w.Param.viewMain.classList.add("webpub-viewer__container-vertical"):w.Param.viewMain.classList.remove("webpub-viewer__container-vertical")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transitionTime",{get:function(){return this._transitionTime},set:function(e){isNaN(e)||(e=Math.max(e,1e-4),this._transitionTime=e||0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this._pageQuantity},set:function(e){this._pageQuantity=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return 0===this.countPageChange&&(this._currentPage=this._currentPageAtInit),this._currentPage},set:function(e){this.countPageChange++,this.pageNeverChanged&&e!=this._currentPageAtInit&&(this.pageNeverChanged=!1),e=~~e,e>this.pageQuantity?e=this.pageQuantity:e<1&&(e=1),this.lastPage=this._currentPage,this._currentPage=e,this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CHANGE,data:{pageNumber:e,useAnimationTime:!0,pageNeverChanged:this.pageNeverChanged}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPageNoAnimation",{get:function(){return 0===this.countPageChange&&(this._currentPage=this._currentPageAtInit),this._currentPage},set:function(e){this.countPageChange++,this.pageNeverChanged&&e!=this._currentPageAtInit&&(this.pageNeverChanged=!1),e=~~e,e>this.pageQuantity?e=this.pageQuantity:e<1&&(e=1),this.lastPage=this._currentPage,this._currentPage=e,this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CHANGE,data:{pageNumber:e,useAnimationTime:!1,pageNeverChanged:this.pageNeverChanged}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSpreadSize",{get:function(){return this._firstSpreadSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coverPageCenter",{get:function(){return this._coverPageCenter},set:function(e){this._coverPageCenter=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"use3DMatrixTransform",{get:function(){return this._use3DMatrixTransform},set:function(e){this._use3DMatrixTransform=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useMatrixTransformZoomable",{get:function(){return this._useMatrixTransformZoomable},set:function(e){this._useMatrixTransformZoomable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxZoom",{get:function(){return this._maxZoom},set:function(e){this._maxZoom=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomFactor",{get:function(){return this._zoomFactor},set:function(e){this._zoomFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomDoubleClick",{get:function(){return this._zoomDoubleClick},set:function(e){this._zoomDoubleClick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomSingleClick",{get:function(){return this._zoomSingleClick},set:function(e){this._zoomSingleClick=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"menuViewPageControlItems",{get:function(){return this._menuViewPageControlItems},set:function(e){this._menuViewPageControlItems=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useMatrixTransformScrollable",{get:function(){return this._useMatrixTransformScrollable},set:function(e){this._useMatrixTransformScrollable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxSpreadsLength",{get:function(){return this._maxSpreadsLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.ePubConfig.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.ePubConfig.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeType",{get:function(){return this._pageSizeType},set:function(e){this._pageSizeType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageMargin",{get:function(){return this._pageMargin},set:function(e){this._pageMargin=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readerPageSrcType",{get:function(){return this._readerPageSrcType},set:function(e){"string"==typeof e&&(e=s.READER_TYPES[e]),this._readerPageSrcType=s.READER_TYPES[e]?e:this.readerPageSrcType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableAspLinks",{get:function(){return this._enableAspLinks},set:function(e){this._enableAspLinks=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mustLoadEpubHtmlCss",{get:function(){return this.readerPageSrcType===s.READER_TYPES.EPUB_HTML},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mustLoadPdfHtmlCss",{get:function(){return this.readerPageSrcType===s.READER_TYPES.PDF_HTML},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadDraggable",{get:function(){return this._spreadDraggable},set:function(e){this._spreadDraggable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pdfHTMLMaxFontLoad",{get:function(){return this._pdfHTMLMaxFontLoad},set:function(e){this._pdfHTMLMaxFontLoad=e||0},enumerable:!0,configurable:!0}),e.prototype.checkEnableAspLinks=function(){switch(this.enableAspLinks=!1,this.readerPageSrcType){case s.READER_TYPES.PDF_SVG:this.enableAspLinks=!0;break;case s.READER_TYPES.PDF_HTML:this.enableAspLinks=!0;break;case s.READER_TYPES.PDF_IMG:this.enableAspLinks=!0;break;case s.READER_TYPES.PDF_PDF:this.enableAspLinks=!0}},e.prototype.updateConfigFromUrlData=function(){var e=w.Main.urlManager.get("reader-params");try{e=window.decodeURI(e),"undefined"!=typeof e&&this.setConfigLoc(new window.Function("return "+e)())}catch(t){}},e.prototype.setConfigLoc=function(e){var t="";for(t in e)"undefined"!=typeof this[t]&&(this[t]=e[t])},e.prototype.checkZoomLevel=function(){this.menuViewPageControlItems&&"true"===this.menuViewPageControlItems.enable&&w.Main.viewerService.get("zoom","max-scale")?(this.maxPageTotalScale=w.Main.viewerService.get("zoom","max-scale")/1.666,this.defaultPageScaleAt=this.maxPageTotalScale/2):w.Main.viewerService.get("zoom","max-scale")&&(this.maxPageTotalScale=this.defaultPageScaleAt=w.Main.viewerService.get("zoom","max-scale")/1.666)},e.prototype.setConfig=function(e){this.setConfigLoc(e),this.checkEnableAspLinks(),this.updateConfigFromUrlData(),this.checkZoomLevel(),this.ePubConfig instanceof Object==!1&&(this.ePubConfig={})},e}();i["default"]=a},{"../EpubEvent":7,"../utils/enums":84}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./utils/XHRPromise"),s=e("./utils/XHRPromise"),o=function(){function e(e){this.config=e,this.parseCss=!0,this.shadowSelector="",this.urls=[],this.styles=[],this.fontList=[]}return Object.defineProperty(e.prototype,"pdfHTMLMaxFontLoad",{get:function(){return this.config.pdfHTMLMaxFontLoad},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var t=this;this.onProgressPercentage=e;var i=window.document.querySelector(".force-font-load");this.setUrls();var n=this.load();return n.then(function(){t.appendStyle(),null===i&&(t.styles.forEach(function(e){t.parse(e)}),t.fontsLettersAppend()),t.clearUnNeeded()}),n},e.prototype.setUrls=function(){var e;this.config.mustLoadEpubHtmlCss&&(e=w.Main.xmlManager.get("common-ui","assets","epub-idGeneratedStyles"),e&&(this.urls=this.urls.concat(w.Utils.resolveVariable(e.url).split(",")))),this.config.mustLoadPdfHtmlCss&&(e=w.Main.xmlManager.get("common-ui","assets","pdf-HTML-idGeneratedStyles"),e&&(this.urls=this.urls.concat(w.Utils.resolveVariable(e.url).split(","))))},
e.prototype.load=function(){for(var e=this,t=[],i=0,o=this.urls.length;i<o;i++)t.push(new n["default"](s.Protocol.GET,this.urls[i]).init());return t.length?Promise.all(t).then(function(t){t.forEach(function(t){e.styles.push(t.responseText)})}):Promise.resolve()},e.prototype.parse=function(e){var t=CSSJSON.toJSON(e,{ordered:!0,comments:!1,stripComments:!1,split:!1}),i={};return this.cloneCssObject(t,i),e},e.prototype.cloneCssObject=function(e,t){var i;for(var n in e)isNaN(Number(n))||(i=this.shadowSelector,0===e[n].name.indexOf("@")&&(this.fontsExtractFromCssObject(e[n]),i=""),t[n]=t[n]||{},t[n].type=e[n].type,t[n].name=i+e[n].name,t[n].value=t[n].value||{},this.cloneCssObjectValues(e[n].value,t[n].value))},e.prototype.cloneCssObjectValues=function(e,t){for(var i in e)isNaN(Number(i))||this.cloneCssObject(t[i],e[i])},e.prototype.fontsExtractFromCssObject=function(e){if(0===e.name.indexOf("@font-face")){var t,i=e.value[1].value,n=i.match(/\([^)]*/gi);n&&(t=n[0].replace("(",""),this.fontList.push(e))}},e.prototype.fontsLettersAppend=function(){var e=[],t=document.createElement("div");t.className="force-font-load";for(var i=function(i,s){if(i>=n.pdfHTMLMaxFontLoad&&0!==n.pdfHTMLMaxFontLoad)return"break";var o=n.fontList[i].value,r=o[0].value,a=o[1].value,u=document.createElement("span");u.style.fontFamily=r,setTimeout(function(){t.appendChild(u)},100*i),e.push("@font-face {"),e.push("font-family: '"+r+"';"),e.push("src: "+a+";}")},n=this,s=0,o=this.fontList.length;s<o;s++){var r=i(s,o);if("break"===r)break}document.body.appendChild(t),this.fontFaces=e.join(" ")},e.prototype.appendStyle=function(){CSSJSON.toHEAD(this.styles.join("\n"))},e.prototype.clearUnNeeded=function(){this.urls=[],this.fontList=[],this.shadowSelector="",this.fontFaces=""},e.prototype.getStyleElement=function(e){return void 0===e&&(e=""),"<style>"+this.styles.join("")+e+"</style>"},e}();i.EpubCssManager=o},{"./utils/XHRPromise":82}],6:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),e("es6-promise");var n=e("./EpubEvent"),s=e("./EpubScrollables"),o=function(){function e(e,t){w.epubEvent=w.epubEvent||new n.EpubEvent,this.epubEvent=w.epubEvent,"string"==typeof e&&"object"==typeof t&&this.onFire(e,t)}return e.prototype.onFire=function(e,t){return this["allowed_"+e]&&(this.epubEvent.fire({type:n.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:!0,action:this["allowed_"+e].bind(this,t)}}),document.dispatchEvent(new CustomEvent(s.EVENT_FORCE_CHECK_LAST_ACTION))),!1},e.prototype.allowed_action=function(e,t){var i=this;t.then(function(){var n,s,o,r=e[1].trim();return 0===r.indexOf("http")?void i.allowed_url([null,r],t):0===r.indexOf("javascript")||0===r.indexOf("js:")||0===r.indexOf("js :")?void i.allowed_javascript([null,r],t):0===r.indexOf("NIApi")?void i.allowed_NIApi([null,r],t):(o=r.match(/^mailto:|^mailto :/gi),null!==o&&0!==o.length?void i.allowed_mailto([null,r],t):(n=/-([0-9]*).xhtml$/gim,s=n.exec(r)||[],void(s.length>0&&i.allowed_gotoPage([null,~~s[1]],t))))})},e.prototype.allowed_gotoPage=function(e,t){t.then(function(t){t===!0&&NIApi.page.open(e[1])})},e.prototype.allowed_nextPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openNext()})},e.prototype.allowed_prevPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openPrevious()})},e.prototype.allowed_lastPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openLast()})},e.prototype.allowed_firstPage=function(e,t){t.then(function(e){e===!0&&NIApi.page.openFirst()})},e.prototype.allowed_mailto=function(e,t){t.then(function(t){if(t===!0){var i=e[1].trim(),n="mailto:",s=i.match(/^mailto:|^mailto :/gi);null!==s&&0!==s.length&&(n=""),window.location.href=n+i}})},e.prototype.allowed_url=function(e,t){t.then(function(t){if(t===!0){var i=e[1];w.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:i}}),NIApi.navigator.openUrl(i)}})},e.prototype.allowed_popup=function(e,t){t.then(function(t){t===!0&&NIApi.lightbox.openPopup(null,e[2])})},e.prototype.allowed_lightbox=function(e,t){t.then(function(t){t===!0&&NIApi.lightbox.openPopup(null,e[2])})},e.prototype.allowed_javascript=function(e,t){t.then(function(t){if(t===!0){var i,n=e[1].split(":");n.shift(),i=n.join(":").trim(),new Function(i)()}})},e.prototype.allowed_NIApi=function(e,t){t.then(function(t){if(t===!0){var i=e[1];new Function(i)()}})},e}();i.EpubDomApi=o;var r=new o,a=r.onFire.bind(r);i["default"]=a},{"./EpubEvent":7,"./EpubScrollables":56,"es6-promise":1}],7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;!function(e){e[e.SCREEN_ORIENTATION=0]="SCREEN_ORIENTATION",e[e.PAGE_CHANGE=1]="PAGE_CHANGE",e[e.PAGE_ZOOM=2]="PAGE_ZOOM",e[e.PAGE_CLICK=3]="PAGE_CLICK",e[e.PAGE_CLICK_PERMISSION=4]="PAGE_CLICK_PERMISSION",e[e.PAGE_IN_DOM=5]="PAGE_IN_DOM",e[e.MOUSE_WHEEL=6]="MOUSE_WHEEL",e[e.ELEMENT_SCROLL=7]="ELEMENT_SCROLL",e[e.TOUCH_POINTERDOWN=8]="TOUCH_POINTERDOWN",e[e.TOUCH_POINTERCANCEL=9]="TOUCH_POINTERCANCEL",e[e.TOUCH_POINTERLEAVE=10]="TOUCH_POINTERLEAVE",e[e.TOUCH_POINTERUP=11]="TOUCH_POINTERUP",e[e.TOUCH_POINTERMOVE=12]="TOUCH_POINTERMOVE",e[e.ZOOM_CONTROLLER_RANGE=13]="ZOOM_CONTROLLER_RANGE",e[e.ZOOM_CONTROLLER_LEVEL_CLICK=14]="ZOOM_CONTROLLER_LEVEL_CLICK",e[e.FULLSCREEN_TOGGLE=15]="FULLSCREEN_TOGGLE",e[e.ADMIN_LINK_CREATE=16]="ADMIN_LINK_CREATE",e[e.ACTION_LINK_SUCCESS=17]="ACTION_LINK_SUCCESS"}(n=i.EPUB_EVENTS||(i.EPUB_EVENTS={}));var s=function(){function e(){this.listeners={},this.iName="EpubEvent"}return e.prototype.addListener=function(e,t){"string"==typeof e&&(e=n[e]),"undefined"==typeof this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].indexOf(t)===-1&&this.listeners[e].push(t)},e.prototype.fire=function(e){var t,i,s,o=0,r=0;if(e.target||(e.target=this),e.context||(e.context=this),t=e.type,"string"==typeof e.type&&(t=e.type,t=n[t]),this.listeners[t]instanceof Array){i=this.listeners[t],s=[];var a=void 0;for(r=i.length;o<r;o++)s.push(i[o]);for(;a=s.shift();)i.indexOf(a)!==-1&&a(e)}},e.prototype.removeListener=function(e,t){var i,s=0,o=0;if("string"==typeof e&&(e=n[e]),this.listeners[e]instanceof Array)for(i=this.listeners[e],s=i.length;o<s;o++){if(null!==t&&i[o]===t){i.splice(o,1);break}null===t&&i.splice(o,1)}},e}();i.EpubEvent=s},{}],8:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./EpubManager");!function(e){e.NONE="none",e.VIEW_DRIVE_ITEM="viewDriveItem"}(n||(n={}));var o=function(){function e(){w.Class.EpubGalleryManager=e,this.registerApi()}return e.prototype.registerApi=function(){NIApi.register("gallery.open",this.open.bind(this)),NIApi.register("gallery.openAssetInApp",this.openAssetInApp.bind(this)),NIApi.register("gallery.doActionInApp",this.doActionInApp.bind(this))},e.prototype.open=function(e,t,i,n){void 0===n&&(n=s.OpenTarget.BLANK),w.API.menuClose();var o=this.getGalleryUrl(e,t,i);return w.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:o}}),w.Param.isApp?void this.openAssetInApp(t,i):n===s.OpenTarget.POPUP?void this.openAsPopup(o):void window.open(o,n)},e.prototype.openAssetInApp=function(e,t){var i=this.getAction(e,t);this.doActionInApp(i)},e.prototype.doActionInApp=function(e){var t=w.Starter.main.backHomeParamString,i="-"+w.Starter.main.backHomeString,n={action:e,currentPage:w.Main.pagesLoaderNew.getCurrentPage()},s=encodeURI(JSON.stringify(n));document.location.href=""+t+s+i},e.prototype.getGalleryUrl=function(e,t,i){var n=this.getRootGalleryUrl(e);return t&&(n+="#/view/"+t,i&&(n+="/"+i)),n},e.prototype.getRootGalleryUrl=function(e){return e?w.Utils.resolveVariable("${media}"+e+"/"):w.Main.xmlManager.get("common-configuration","contents","gallery","path")},e.prototype.openAsPopup=function(e){new w.Class.LightboxManagerNew({animation:"none",header:"visible",id:"drivePopup",url:e})},e.prototype.getAction=function(e,t){return e?this.getViewDriveItemAction(e,t):this.getNoneAction()},e.prototype.getViewDriveItemAction=function(e,t){return{type:n.VIEW_DRIVE_ITEM,assetId:e,page:t}},e.prototype.getNoneAction=function(){return{type:n.NONE}},e}();i.EpubGalleryManager=o,i["default"]=o},{"./EpubManager":14}],9:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubGesturesEvent/Defs"),s=e("./EpubGesturesEvent/MouseWheelManager"),o=e("./utils/isTouchSupported"),r=function(){function e(t,i){this.gestureEventList={},this.moveDifferer=n.getMoveDifferer(),this.gestureData=n.getGestureData(),this.preventDefaultOnMove=!1,this.wheelData=n.getWheelData(),this._enableScrollElement=!1,this._enableCheckMediaPreventDefault=!0,this.touchConvert=function(e,t){for(var i=t.length,n=0,s=0,o=0,r=0,a=0,u=0;u<i;u++)s+=t[u].clientX,o+=t[u].clientY,r=r||t[0].clientX,a=a||t[0].clientY,r-=t[u].clientX,a-=t[u].clientY,n+=this.touchConvert_getDistance(r,a),r=t[u].clientX,a=t[u].clientY;e.hypotenuse=n,e.epubClientX=s/i,e.epubClientY=o/i},this.parent=t,this.element=i,this.element.epubGesturesEvent=this,this.resetMoveDiffererByKeyBinded=this.resetMoveDiffererByKey.bind(this),this.gestureID=Date.now().toString().concat("_UID_",(e.UID++).toString()),this.touchStart=this.touchStart.bind(this),this.touchEnd=this.touchEnd.bind(this),this.touchMove=this.touchMove.bind(this),this.mouseDown=this.mouseDown.bind(this),this.mouseUp=this.mouseUp.bind(this),this.mouseMove=this.mouseMove.bind(this),this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=this.pointerMove.bind(this),this.gestureEventList[e.GESTURESNAME.PINCHGESTURE]=[],this.gestureEventList[e.GESTURESNAME.PRESSGESTURE]=[],this.gestureEventList[e.GESTURESNAME.PANGESTURE]=[],this.gestureEventList[e.GESTURESNAME.TAPGESTURE]=[],this.gestureEventList[e.GESTURESNAME.DBLTAPGESTURE]=[],this.gestureEventList[e.GESTURESNAME.SWIPEGESTURE]=[],this.gestureEventList[e.GESTURESNAME.MOUSEWHEELGESTURE]=[],this.eventsStatus=e.EVENTSSTATUS.data,this.initEvent()}return Object.defineProperty(e.prototype,"enableScrollElement",{get:function(){return this._enableScrollElement},set:function(e){this._enableScrollElement=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCheckMediaPreventDefault",{get:function(){return this._enableCheckMediaPreventDefault},set:function(e){this._enableCheckMediaPreventDefault=e},enumerable:!0,configurable:!0}),e.prototype.initEvent=function(){var t=this;if(o.isTouchSupported()){var i={capture:!1,passive:!0};this.element.addEventListener(e.EVENTSTYPE.TOUCH.TOUCHSTART,this.touchStart,!1),this.element.addEventListener(e.EVENTSTYPE.TOUCH.TOUCHEND,this.touchEnd,i),this.element.addEventListener(e.EVENTSTYPE.TOUCH.TOUCHMOVE,this.touchMove,i)}this.element.addEventListener(e.EVENTSTYPE.MOUSE.MOUSEDOWN,this.mouseDown),this.element.addEventListener(e.EVENTSTYPE.MOUSE.MOUSEUP,this.mouseUp),this.element.addEventListener(e.EVENTSTYPE.MOUSE.MOUSEMOVE,this.mouseMove),document.addEventListener("mouseup",function(e){t.mouseUpDoc(e)},!0),this.mouseWheelManager=new s.MouseWheelManager(this.element),this.mouseWheelHandler=this.mouseWheelHandler.bind(this),this.onScroll=this.onScroll.bind(this),this.mouseWheelManager.addListeners(this.mouseWheelHandler,this.onScroll)},e.prototype.ePreventDefault=function(e){e.preventDefault()},e.prototype.mouseWheelHandler=function(t){var i=t.data,n=i.deltaX*this.wheelData.deltaX<0,s=i.deltaY*this.wheelData.deltaY<0;0===i.deltaX&&(n=!1),0===i.deltaY&&(s=!1),i.gestureData=this.gestureData,Math.abs(i.deltaX)>Math.abs(i.deltaY)?(n=!0,s=!1):Math.abs(i.deltaX)<Math.abs(i.deltaY)&&(n=!1,s=!0),this.gestureData.wheel.isX=n,this.gestureData.wheel.isY=s,this.callGestureEvent(e.GESTURESNAME.MOUSEWHEELGESTURE,i),this.wheelData.deltaX=i.deltaX||this.wheelData.deltaX,this.wheelData.deltaY=i.deltaY||this.wheelData.deltaY},e.prototype.onScroll=function(e){this.preventAllGesture()},e.prototype.mouseDown=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchStart(e)},e.prototype.mouseUpDoc=function(t){e._eventsStatus=this.eventsStatus;var i=this.getStat(e._eventsStatus,"start");i.stat!==!1&&(t.hypotenuse=0,t.epubClientX=t.clientX,t.epubClientY=t.clientY,this.onTouchEnd(t))},e.prototype.mouseUp=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchEnd(e)},e.prototype.mouseMove=function(e){e.hypotenuse=0,e.epubClientX=e.clientX,e.epubClientY=e.clientY,this.onTouchMove(e)},e.prototype.touchStart=function(e){e.changedTouches.length>0&&this.resetMoveDifferer(),this.touchConvert(e,e.touches),this.onTouchStart(e)},e.prototype.touchEnd=function(e){return 0===e.touches.length?(this.touchConvert(e,e.changedTouches),void this.onTouchEnd(e)):void this.resetMoveDifferer()},e.prototype.touchMove=function(e){this.preventDefaultOnMove&&this.ePreventDefault(e),this.touchConvert(e,e.touches),this.onTouchMove(e)},e.prototype.pointerDown=function(e){var t=e.data.currentEvent,i=e.data.touches,n=e.data.changedTouches;n.length>0&&this.resetMoveDifferer(),this.touchConvert(t,i),this.onTouchStart(t)},e.prototype.pointerUp=function(e){var t=e.data.currentEvent,i=e.data.touches,n=e.data.changedTouches;return 0===i.length?(this.touchConvert(t,n),void this.onTouchEnd(t)):void this.resetMoveDifferer()},e.prototype.pointerMove=function(e){var t=e.data.currentEvent,i=e.data.touches;this.preventDefaultOnMove&&this.ePreventDefault(t),this.touchConvert(t,i),this.onTouchMove(t)},e.prototype.overrideEventData=function(e,t,i,n,s,o,r,a,u,l,p,h,c){this.gestureData.resetAxis=this.resetMoveDiffererByKeyBinded,this.gestureData.type=t,this.gestureData.pinchZoomDiff=p,this.gestureData.x.pointDiff=i,this.gestureData.x.vectorDiff=s,this.gestureData.x.countDiff=r,this.gestureData.x.isVector=u,this.gestureData.x.client=h,this.gestureData.y.pointDiff=n,this.gestureData.y.vectorDiff=o,this.gestureData.y.countDiff=a,this.gestureData.y.isVector=l,this.gestureData.y.client=c,e.gestureData=this.gestureData},e.clearGlobalTapGestureTimer=function(){for(var t=e.globalTapGestureTimer.length,i=0;i<t;i++)clearTimeout(e.globalTapGestureTimer[i]);e.globalTapGestureTimer=[]},e.prototype.callGestureEvent=function(e,t,i){for(var n=this.gestureEventList[e].length,s=0;s<n;s++)this.gestureEventList[e][s](t,i)},e.prototype.touchConvert_getDistance=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},e.prototype.getStat=function(e,t){return e[t]},e.prototype.setStat=function(t,i,n,s){e.lastTime=s,t[i].stat=n;var o=n?"true":"false";t[i].lastTime=t[i].time,t[i].time=s,t[i][o]=t[i][o],t[i][o].lastTime=t[i][o].time,t[i][o].time=s,clearTimeout(t[i].timer)},e.prototype.setMoveDifferer=function(t){return this.moveDifferer.x.count=this.moveDifferer.x.count||t.epubClientX,this.moveDifferer.x.countDiff+=Math.abs(t.epubClientX-this.moveDifferer.x.count),this.moveDifferer.x.count=t.epubClientX,this.moveDifferer.y.count=this.moveDifferer.y.count||t.epubClientY,this.moveDifferer.y.countDiff+=Math.abs(t.epubClientY-this.moveDifferer.y.count),this.moveDifferer.y.count=t.epubClientY,this.moveDifferer.hypotenuse=this.moveDifferer.hypotenuse||t.hypotenuse,this.moveDifferer.hypotenuseDiff=t.hypotenuse-this.moveDifferer.hypotenuse,this.moveDifferer.hypotenuse=t.hypotenuse,!(this.moveDifferer.x.countDiff<e.STARTMOVEAT&&this.moveDifferer.y.countDiff<e.STARTMOVEAT&&0===this.moveDifferer.hypotenuseDiff)&&(this.moveDifferer.x.pos=this.moveDifferer.x.pos||t.epubClientX,this.moveDifferer.x.diff=t.epubClientX-this.moveDifferer.x.pos,this.moveDifferer.x.vector=this.moveDifferer.x.vector||t.epubClientX,Math.abs(t.epubClientX-this.moveDifferer.x.vector)<Math.abs(this.moveDifferer.x.vectorDiff)&&(this.moveDifferer.x.vector=t.epubClientX),this.moveDifferer.y.pos=this.moveDifferer.y.pos||t.epubClientY,this.moveDifferer.y.diff=t.epubClientY-this.moveDifferer.y.pos,this.moveDifferer.y.vector=this.moveDifferer.y.vector||t.epubClientY,Math.abs(t.epubClientY-this.moveDifferer.y.vector)<Math.abs(this.moveDifferer.y.vectorDiff)&&(this.moveDifferer.y.vector=t.epubClientY),this.moveDifferer.x.vectorDiff=t.epubClientX-this.moveDifferer.x.vector,this.moveDifferer.y.vectorDiff=t.epubClientY-this.moveDifferer.y.vector,!0)},e.prototype.resetMoveDiffererByKey=function(e){this.moveDifferer[e].diff=0,this.moveDifferer[e].count=0,this.moveDifferer[e].countDiff=0,this.moveDifferer[e].pos=0,this.moveDifferer[e].vector=0,this.moveDifferer[e].vectorDiff=0,this.moveDifferer.hypotenuseDiff=0,this.moveDifferer.hypotenuse=0},e.prototype.resetMoveDifferer=function(){this.resetMoveDiffererByKey("x"),this.resetMoveDiffererByKey("y")},e.prototype.resetStat=function(){this.eventsStatus=e.EVENTSSTATUS.data},e.prototype.onTouchStart=function(t){e._eventsStatus=this.eventsStatus;var i=this.getStat(e._eventsStatus,"start");i.stat!==!0&&(this.resetMoveDifferer(),this.setStat(e._eventsStatus,"start",!0,Date.now()),this.setStat(e._eventsStatus,"end",!1,e.lastTime),this.setStat(e._eventsStatus,"move",!1,e.lastTime),this.defineGesture(t,"start"))},e.prototype.onTouchEnd=function(t){e._eventsStatus=this.eventsStatus,this.setStat(e._eventsStatus,"start",!1,Date.now()),this.setStat(e._eventsStatus,"end",!0,e.lastTime),this.defineGesture(t,"end"),this.resetMoveDifferer()},e.prototype.onTouchMove=function(t){e._eventsStatus=this.eventsStatus,this.setStat(e._eventsStatus,"move",!1,Date.now());var i=this.getStat(e._eventsStatus,"start");if(i.stat===!0&&this.getStat(e._eventsStatus,"end").stat===!1){this.checkMediaPreventDefault(t);var n=this.setMoveDifferer(t);n===!0&&(e.clearGlobalTapGestureTimer(),this.setStat(e._eventsStatus,"move",!0,e.lastTime),this.defineGesture(t,"move"))}},e.prototype.checkMediaPreventDefault=function(e){if(this.enableCheckMediaPreventDefault!==!1){var t=e.target,i=t.tagName;if(void 0===i)return void(this.scrollableElement()===!1&&this.ePreventDefault(e));i=i.toLowerCase(),"video"!==i&&"audio"!==i&&this.scrollableElement()===!1&&this.ePreventDefault(e)}},e.prototype.tapGesture=function(t,i){var n=this;if("end"!==i)return!1;e._eventsStatus=this.eventsStatus;var s=this.getStat(e._eventsStatus,"start"),o=this.getStat(e._eventsStatus,"end"),r=this.getStat(e._eventsStatus,"move");return r.stat===!1&&o.stat===!0&&0!==s.lastTime&&(t.defaultPreventGesture===!0?e.clearGlobalTapGestureTimer():clearTimeout(s.timer),this.overrideEventData(t,e.GESTURESNAME.TAPGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),s.timer=setTimeout(function(){n.callGestureEvent(e.GESTURESNAME.TAPGESTURE,t)},e.TAPTIME),e.globalTapGestureTimer.push(s.timer)),!1},e.prototype.dblTapGesture=function(t,i){if("end"!==i)return!1;e._eventsStatus=this.eventsStatus;var n=this.getStat(e._eventsStatus,"start"),s=this.getStat(e._eventsStatus,"end"),o=this.getStat(e._eventsStatus,"move");return o.stat===!1&&s["true"].time-n["true"].lastTime<e.DBLTAPTIME&&(e.clearGlobalTapGestureTimer(),this.overrideEventData(t,e.GESTURESNAME.DBLTAPGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0)},e.prototype.panGesture=function(t,i){if("end"===i||"start"===i)return!1;e._eventsStatus=this.eventsStatus;var n=this.getStat(e._eventsStatus,"move");return n.stat!==!1&&(this.ePreventDefault(t),this.overrideEventData(t,e.GESTURESNAME.PANGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0)},e.prototype.pinchGesture=function(e){},e.prototype.pressGesture=function(e){},e.prototype.neutralSwipeGesture=function(t){return(0!==this.moveDifferer.x.vectorDiff||0!==this.moveDifferer.y.vectorDiff)&&(this.ePreventDefault(t),this.overrideEventData(t,e.GESTURESNAME.SWIPEGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,!1,!1,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0)},e.prototype.swipeGesture=function(t){e._eventsStatus=this.eventsStatus;var i=!1,n=!1,s=this.getStat(e._eventsStatus,"start"),o=this.getStat(e._eventsStatus,"end"),r=this.getStat(e._eventsStatus,"move");return r.stat!==!1&&o.stat!==!1&&(i=Math.abs(this.moveDifferer.x.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS,i===!1&&(i=Math.abs(this.moveDifferer.x.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS_IN_TIME&&o.time-s.lastTime<=e.SWIPEGESTURE_AT_TIME),n=Math.abs(this.moveDifferer.y.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS,n===!1&&(n=Math.abs(this.moveDifferer.y.vectorDiff)>e.SWIPEGESTURE_AT_PIXELS_IN_TIME&&o.lastTime-s.lastTime<=e.SWIPEGESTURE_AT_TIME),i===!1&&n===!1?this.neutralSwipeGesture(t):(this.overrideEventData(t,e.GESTURESNAME.SWIPEGESTURE,this.moveDifferer.x.diff,this.moveDifferer.y.diff,this.moveDifferer.x.vectorDiff,this.moveDifferer.y.vectorDiff,this.moveDifferer.x.countDiff,this.moveDifferer.y.countDiff,i,n,this.moveDifferer.hypotenuseDiff,t.epubClientX,t.epubClientY),!0))},e.prototype.defineGesture=function(t,i){if(t.defaultPreventGesture===!0||e.PREVENT_ALL===!0)return this.resetStat(),this.resetMoveDifferer(),void e.clearGlobalTapGestureTimer();this.tapGesture(t,i),e._eventsStatus=this.eventsStatus;this.getStat(e._eventsStatus,"start");return this.dblTapGesture(t,i)===!0?(this.callGestureEvent(e.GESTURESNAME.DBLTAPGESTURE,t),void e.clearGlobalTapGestureTimer()):this.swipeGesture(t)===!0?(this.callGestureEvent(e.GESTURESNAME.SWIPEGESTURE,t),void((t.defaultPreventGesture===!0||e.PREVENT_ALL)&&e.clearGlobalTapGestureTimer())):this.panGesture(t,i)===!0?(this.callGestureEvent(e.GESTURESNAME.PANGESTURE,t),void((t.defaultPreventGesture===!0||e.PREVENT_ALL)&&e.clearGlobalTapGestureTimer())):void 0},e.prototype.setEnableScrollElement=function(e){this.enableScrollElement=e},e.prototype.setEnableCheckMediaPreventDefault=function(e){this.enableCheckMediaPreventDefault=e},e.prototype.scrollableElement=function(){return this.enableScrollElement!==!1&&null!==this.element.parentElement},e.prototype.preventAllGesture_reset=function(){e.PREVENT_ALL=!1},e.preventAllGestureStatus=function(){return e.PREVENT_ALL},e.prototype.preventAllGesture=function(){clearTimeout(e.timer),e.PREVENT_ALL=!0,e.timer=setTimeout(this.preventAllGesture_reset,100)},e.prototype.addEventListener=function(e,t){var i="gesture_".concat(e,"_",this.gestureID);return"undefined"==typeof t[i]&&(t[i]=!0,this.gestureEventList[e].push(t),!0)},e.prototype.removeEventListener=function(e,t){var i="gesture_".concat(e,"_",this.gestureID);if("undefined"==typeof t[i])return!1;for(var n=0,s=this.gestureEventList[e].length;n<s;n++)if(void 0!==this.gestureEventList[e][n][i])return this.gestureEventList[e][n][i]=null,delete this.gestureEventList[e][n][i],!0;return!1},e.prototype.resetMoveXDifferer=function(){this.resetMoveDiffererByKey("x")},e.prototype.resetMoveYDifferer=function(){this.resetMoveDiffererByKey("y")},e.EVENTSTYPE=n.getEventsType(),e.UID=0,e.DBLTAPTIME=500,e.TAPTIME=300,e.PREVENT_ALL=!1,e.STARTMOVEAT=10,e.SWIPEGESTURE_AT_TIME=200,e.SWIPEGESTURE_AT_PIXELS_IN_TIME=7,e.SWIPEGESTURE_AT_PIXELS=50,e.EVENTSSTATUS={get data(){return n.getEpubEventStatusManager()}},e.lastTime=0,e.globalTapGestureTimer=[],e.timer=0,e.GESTURESNAME=n.getGesturesName(),e}();i["default"]=r},{"./EpubGesturesEvent/Defs":10,"./EpubGesturesEvent/MouseWheelManager":12,"./utils/isTouchSupported":86}],10:[function(e,t,i){"use strict";function n(){return{stat:!1,time:0,lastTime:0,timere:0,"true":{time:0,lastTime:0},"false":{time:0,lastTime:0}}}function s(){return{start:n(),end:n(),move:n()}}function o(){return{MOUSE:{MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",CLICK:"click"},TOUCH:{TOUCHSTART:"touchstart",TOUCHEND:"touchend",TOUCHMOVE:"touchmove"},MSPOINTER:{POINTERDOWN:"MSPointerDown",POINTERCANCEL:"MSPointerCancel",POINTERLEAVE:"MSPointerLeave",POINTERUP:"MSPointerUp",POINTERMOVE:"MSPointerMove"},POINTER:{POINTERDOWN:"pointerdown",POINTERCANCEL:"pointercancel",POINTERLEAVE:"pointerleave",POINTERUP:"pointerup",POINTERMOVE:"pointermove"},MOUSEWHEEL:"mousewheel",WHEEL:"wheel",DOMMOUSESCROLL:"DOMMouseScroll"}}function r(){return{PINCHGESTURE:"pinchGesture",PRESSGESTURE:"pressGesture",PANGESTURE:"panGesture",TAPGESTURE:"tapGesture",DBLTAPGESTURE:"dblTapGesture",SWIPEGESTURE:"swipeGesture",MOUSEWHEELGESTURE:"mouseWheelGesture"}}function a(){return{x:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},y:{diff:0,count:0,countDiff:0,pos:0,vector:0,vectorDiff:0},hypotenuse:0,hypotenuseDiff:0}}function u(){return{type:"",pinchZoomDiff:0,wheel:{isX:!1,isY:!1},x:{pointDiff:0,vectorDiff:0,client:0,isVector:!1},y:{pointDiff:0,vectorDiff:0,client:0,isVector:!1}}}function l(){return{timerID:0,currentTime:0,deltaX:0,deltaY:0}}Object.defineProperty(i,"__esModule",{value:!0}),i.getEpubEventStatus=n,i.getEpubEventStatusManager=s,i.getEventsType=o,i.getGesturesName=r,i.getMoveDifferer=a,i.getGestureData=u,i.getWheelData=l},{}],11:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){this.element=e,this.config=t,this.enableKeyBoard=!0,this.isMouseenter=!0,this.spreadDraggable&&(this.keyUp=this.keyUpPre.bind(this),this.element.setAttribute("tabindex","1"),this.setEvents())}return Object.defineProperty(e.prototype,"spreadDraggable",{get:function(){return this.config.spreadDraggable},enumerable:!0,configurable:!0}),e.prototype.setEvents=function(){var e=this;window.addEventListener("keyup",this.keyUp),this.element.addEventListener("mouseenter",function(t){e.isMouseenter=!0}),this.element.addEventListener("mouseleave",function(t){e.isMouseenter=!1})},e.prototype.isEditableElement=function(){var e=document.activeElement;if(null!==e&&"false"!==e.getAttribute("contenteditable")){var t=e.tagName.toLowerCase();if("input"===t||"textarea"===t||"select"===t||"true"===e.getAttribute("contenteditable"))return!0}return!1},e.prototype.keyUpPre=function(e){var t=e.key||e.keyIdentifier;if(this.element===document.activeElement||this.isMouseenter!==!1&&(this.isEditableElement()!==!0||document.hasFocus()!==!0))switch(t){case"ArrowLeft":this.pagePrevious();break;case"ArrowUp":this.pagePrevious();break;case"ArrowRight":this.pageNext();break;case"ArrowDown":this.pageNext();break;case"Left":this.pagePrevious();break;case"Up":this.pagePrevious();break;case"Right":this.pageNext();break;case"Down":this.pageNext()}},e.prototype.pageNext=function(){NIApi.page.openNext()},e.prototype.pagePrevious=function(){NIApi.page.openPrevious()},e}();i.EpubKeyBoardEvent=n},{}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EpubGesturesEvent/Defs"),s=e("../EpubEvent"),o=function(){function e(t){this.element=t,this.lastSentWheelTimestamp=0,this.lastHighWheelTimestamp=0,this.lastThreadResponseTimestamp=0,this.lastThreadBlockTimestamp=0,this.browserName=w.Param.userAgent.browser.name,this.epubEvent=new s.EpubEvent;var i="WheelEvent"in window?e.EVENTSTYPE.WHEEL:e.EVENTSTYPE.MOUSEWHEEL;this.element.addEventListener(i,this.mouseWheelHandler.bind(this),!1),this.initCheckThreadBlockDaemon()}return e.prototype.addListeners=function(e,t){this.epubEvent.addListener(s.EPUB_EVENTS.MOUSE_WHEEL,e)},e.prototype.removeListeners=function(e,t){this.epubEvent.removeListener(s.EPUB_EVENTS.MOUSE_WHEEL,e)},e.prototype.initCheckThreadBlockDaemon=function(){var e=this;this.lastThreadResponseTimestamp=Date.now(),setInterval(function(){var t=Date.now(),i=t-e.lastThreadResponseTimestamp;i>50&&(e.lastThreadBlockTimestamp=t),e.lastThreadResponseTimestamp=t},0)},e.prototype.mouseWheelHandler=function(e){this.isWheelDeltaTooLow(e)||(this.updateHighWheelTimestamp(),this.isLastThreadBlockTooClose()||this.isLastSentWheelTooClose()||this.sendWheelEvent(e))},e.prototype.isWheelDeltaTooLow=function(e){var t=15,i=this.getWheelDelta(e),n=0===e.deltaMode;return n&&i<t},e.prototype.getWheelDelta=function(e){return Math.max(Math.abs(e.deltaY),Math.abs(e.deltaX))},e.prototype.updateHighWheelTimestamp=function(){this.lastHighWheelTimestamp=Date.now()},e.prototype.isLastThreadBlockTooClose=function(){var e=250,t=this.lastHighWheelTimestamp-this.lastThreadBlockTimestamp;return t<e},e.prototype.isLastSentWheelTooClose=function(){var e=800,t=this.lastHighWheelTimestamp-this.lastSentWheelTimestamp;return t<e},e.prototype.sendWheelEvent=function(e){this.lastSentWheelTimestamp=Date.now(),this.dispatchEventsWheel(e)},e.prototype.dispatchEventsWheel=function(e){this.epubEvent.fire({type:s.EPUB_EVENTS.MOUSE_WHEEL,data:e})},e.windowScrollInit=!1,e.windowMouseWheelInit=!1,e.windowScrollStatus=!1,e.EVENTSTYPE=n.getEventsType(),e.GESTURESNAME=n.getGesturesName(),e}();i.MouseWheelManager=o},{"../EpubEvent":7,"../EpubGesturesEvent/Defs":10}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubManager"),s=e("./EpubDomApi"),o=e("./polyfill/closest");o["default"]();var r;!function(e){var t=function(){function e(){w.EpubDomApi=s["default"],w.Class.EpubManager=n["default"]}return e}();e.EpubMain=t}(r||(r={})),new r.EpubMain},{"./EpubDomApi":6,"./EpubManager":14,"./polyfill/closest":81}],14:[function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(s,o){function r(e){try{u(n.next(e))}catch(t){o(t)}}function a(e){try{u(n["throw"](e))}catch(t){o(t)}}function u(e){e.done?s(e.value):new i(function(t){t(e.value)}).then(r,a)}u((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(s)throw new TypeError("Generator is already executing.");for(;u;)try{if(s=1,o&&(r=2&i[0]?o["return"]:i[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,o=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(r=u.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){u.label=i[1];break}if(6===i[0]&&u.label<r[1]){u.label=r[1],r=i;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(i);break}r[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(n){i=[6,n],o=0}finally{s=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var s,o,r,a,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(i,"__esModule",{value:!0});var o,r=e("./EpubConfig"),a=e("./EpubCssManager"),u=e("./EpubNavigationTypeManager"),l=e("./EpubSpreads"),p=e("./EpubStatistics"),h=e("./components/pageControl/Controller"),c=e("./EpubEvent"),d=e("./EpubGesturesEvent/EpubKeyBoardEvent"),f=e("./utils/functions"),m=e("./EpubGesturesEvent"),g=e("./EpubConfig/EpubDefaultConfig"),v=e("./EpubGalleryManager");!function(e){e.GALLERY="GALLERY",e.APP_CONTAINER="APP_CONTAINER"}(o||(o={}));var y;!function(e){e.GO_TO_PREVIOUS="goToPrevious",e.STAY="stay",e.GO_TO_NEXT="goToNext"}(y||(y={}));var b;!function(e){e.SELF="_self",e.BLANK="_blank",e.POPUP="popup"}(b||(b={})),i.OpenTarget=b;var E;!function(e){e.TOGGLE_SHARE_PANEL="toggleSharePanel",e.TOGGLE_SEARCH_PANEL="toggleSearchPanel",e.TOGGLE_FAVORITE_PANEL="toggleFavoritePanel",e.TOGGLE_THUMBNAIL_PANEL="toggleThumbnailPanel",e.TOGGLE_SUMMARY_PANEL="toggleSummaryPanel",e.MAILTO="mailto",e.GO_TO_PAGE="goToPage",e.POPUP="popup",e.OPEN_NEW_TAB="openNewTab",e.OPEN_SAME_TAB="openSameTab",e.SHOW_TOOLTIP="showTooltip",e.HIDE_TOOLTIP="hideTooltip"}(E||(E={}));var S=function(){function e(e,t){this.parent=e,this.viewMain=t,this.epubMode=!0,this.screenSize={width:0,height:0,
ratio:0},this.goToPage=function(e,t){void 0===t&&(t=!0),t?this.currentPage=e:this.currentPageNoAnimation=e},this.userInteractions(!1),w.epubEvent=w.epubEvent||new c.EpubEvent,this.epubEvent=w.epubEvent,this.config=new r["default"](this),this.epubStatistics=new p.EpubStatistics(this),this.galleryManager=new v["default"],this.registerApi(),this.initListeners()}return Object.defineProperty(e.prototype,"defaultPageScaleAt",{get:function(){return this.config.defaultPageScaleAt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationAxis",{get:function(){return this.config.navigationAxis},set:function(e){this.config.navigationAxis=e,this.epubSpreads.updateSpreads(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transitionTime",{get:function(){return this.config.transitionTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.config.currentPage},set:function(e){this.config.currentPage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPageNoAnimation",{get:function(){return this.config.currentPageNoAnimation},set:function(e){this.config.currentPageNoAnimation=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax},enumerable:!0,configurable:!0}),e.prototype.registerApi=function(){var e=this;NIApi.register("page.openNext",function(){return e.pageNext(),Promise.resolve()}),NIApi.register("page.openPrevious",function(){return e.pagePrevious(),Promise.resolve()}),NIApi.register("page.openFirst",function(){return e.pageFirst(),Promise.resolve()}),NIApi.register("page.openLast",function(){return e.pageLast(),Promise.resolve()}),NIApi.register("page.open",function(t){return e.goToPage(t),Promise.resolve()})},e.prototype.isFocusable=function(){var e,t,i=document.activeElement;return!i||(e=i.readOnly,t=i.getAttribute("contenteditable"),e!==!1&&"true"!==t)},e.prototype.focusOn=function(){this.isFocusable()===!0&&this.epubSpreads.getMainViewElement().focus()},e.prototype.initListeners=function(){var e=this;document.addEventListener("WebPublicationAction",this.onApiCall.bind(this),!0),this.epubEvent.addListener(c.EPUB_EVENTS.PAGE_CLICK,function(t){e.toggleMenu()}),this.epubEvent.addListener(c.EPUB_EVENTS.PAGE_CHANGE,function(t){void 0!==e.epubSpreads&&(t.data.useAnimationTime===!1?e.epubSpreads.updateSpreads(0):e.epubSpreads.updateSpreads(e.transitionTime),w.Main.pageManager.set(e.currentPage),w.Main.pagesLoaderNew.setCurrentPage(e.currentPage),e.setDocumentPagesAttributes(),t.data.pageNeverChanged||(e.focusOn(),setTimeout(function(){e.focusOn()},200)))}),w.Main.pageManager.onChange(function(t){t=~~t,e.currentPage!==t&&e.goToPage(t)}),this.epubEvent.addListener(c.EPUB_EVENTS.PAGE_ZOOM,function(t){w.Param.zoom=t.data.status;var i=e.viewMain.classList.contains("epub-view_state-zoom-in");w.Param.zoom===!1&&i?e.viewMain.classList.remove("epub-view_state-zoom-in"):w.Param.zoom!==!0||i||e.viewMain.classList.add("epub-view_state-zoom-in"),w.Utils.callEvent(window,"webpub-zoom")}),this.preventDocumentScroll()},e.prototype.onApiCall=function(e){var t=this,i=this.isFromTapEvent(e),n=this.isFromSpread(e);i&&n?this.callIfClickAuthorized(function(){t.handleInddPluginEvent(e)}):this.handleInddPluginEvent(e)},e.prototype.isOriginalEventSent=function(e){return e.detail&&e.detail.event&&e.detail.event.type},e.prototype.isFromTapEvent=function(e){if(this.isOriginalEventSent(e)){var t=e.detail.event.type,i=[m["default"].EVENTSTYPE.MOUSE.CLICK,m["default"].EVENTSTYPE.TOUCH.TOUCHEND];if(i.includes(t))return!0}return!1},e.prototype.isFromSpread=function(e){if(this.isOriginalEventSent(e))for(var t=e.detail.event.target,i=this.epubSpreads.epubSpreads.map(function(e){return e.element}),n=0;n<i.length;n++){var s=i[n],o=t instanceof Node&&s.contains(t);if(o)return!0}return!1},e.prototype.callIfClickAuthorized=function(e){var t=this;this.epubEvent.fire({type:c.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:!0,action:function(i){return t.clickAction(i,e)}}})},e.prototype.clickAction=function(e,t){e.then(function(e){e&&t()})},e.prototype.handleInddPluginEvent=function(e){var t=e.detail,i=t.type,n=t.params,s=t.event;switch(i){case E.TOGGLE_SHARE_PANEL:NIApi.panels.share.toggle();break;case E.TOGGLE_SEARCH_PANEL:NIApi.panels.search.toggle();break;case E.TOGGLE_FAVORITE_PANEL:NIApi.panels.favorites.toggle();break;case E.TOGGLE_THUMBNAIL_PANEL:NIApi.panels.thumbnail.toggle();break;case E.TOGGLE_SUMMARY_PANEL:NIApi.panels.summary.toggle();break;case E.MAILTO:n&&n.email&&(window.location.href="mailto:"+n.email);break;case E.GO_TO_PAGE:n&&n.page&&(NIApi.page.open(n.page),NIApi.lightbox.closeAll(),NIApi.menu.close());break;case E.POPUP:case E.OPEN_NEW_TAB:case E.OPEN_SAME_TAB:var r=n.assetDriveItem,a=void 0===r?{type:void 0,globalId:void 0}:r,u=n.subAssetDriveItem,l=n.pageNumber,p=n.param,h=this.resolveParams(n),c=[o.GALLERY,o.APP_CONTAINER].includes(a.type);if(c){var d=u&&u.globalId,f=this.getTargetFromEventType(i);NIApi.gallery.open(a.globalId,d,l,f);break}if(w.Param.isApp||i===E.POPUP){this.openPopup(h);break}var m=this.getTargetFromEventType(i);p&&!a.globalId&&w.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:h.param}}),window.open(h.param,m);break;case E.SHOW_TOOLTIP:if(s){var g={X:s.clientX,Y:s.clientY+25};n.content&&w.Main.tooltipManager.showAfterDelay(n.content,g)}break;case E.HIDE_TOOLTIP:w.Main.tooltipManager.hide()}},e.prototype.resolveParams=function(e){var t=e.assetDriveItem&&e.assetDriveItem.relUrl&&"EXTERNAL_LINK"!==e.assetDriveItem.type?"${media}"+e.assetDriveItem.relUrl.replace(/^\/?\d+\//g,""):e.param;return e.pageNumber&&(t+="#page="+e.pageNumber),t=w.Utils.resolveVariable(t),e.param=t,e},e.prototype.getTargetFromEventType=function(e){switch(e){case E.POPUP:return b.POPUP;case E.OPEN_SAME_TAB:return b.SELF;case E.OPEN_NEW_TAB:default:return b.BLANK}},e.prototype.openPopup=function(e){e.id="epub-lightbox-"+Date.now().toString();var t=NIApi.lightbox.getOpenList();NIApi.lightbox.openPopup(null,e),setTimeout(function(){t.then(function(e){return e.forEach(function(e){return NIApi.lightbox.close(e)})})},250)},e.prototype.preventDocumentScroll=function(){var e=this,t=!1,i=0;document.addEventListener("touchend",function(n){var s=document.activeElement.tagName.toLowerCase();if("input"!==s&&"textarea"!==s)return Date.now()-i<100?void n.preventDefault():void(t===!0&&(i=Date.now(),window.scrollTo(0,0),e.epubNavigationTypeManager.forceResize(),n.preventDefault()))},!0),document.addEventListener("touchmove",function(e){var n=document.activeElement.tagName.toLowerCase();"input"!==n&&"textarea"!==n&&(t=0!==window.scrollY||0!==window.scrollX,Date.now()-i<100&&e.preventDefault())},!1)},e.prototype.setDocumentPagesAttributes=function(){var e=this.getCurrentPages();document.documentElement.setAttribute("pages",e.join("-")),document.documentElement.setAttribute("pages-left",e[0].toString()),e[1]?document.documentElement.setAttribute("pages-right",e[1].toString()):document.documentElement.setAttribute("pages-right","")},e.prototype.showMenu=function(e){return e===!1?(w.Main.menuManager.hideMenu(),void w.Main.menuManager.hideTopnav()):void w.Main.menuManager.showTopnav()},e.prototype.toggleMenu=function(){w.Main.toolsEvents&&(1===w.Main.toolsEvents.showToolsInfo?(w.Main.toolsEvents.showTools(!1),this.showMenu(!1)):(w.Main.toolsEvents.showTools(!0),this.showMenu(!0)))},e.prototype.pageChange=function(e){this.goToPage(e)},e.prototype.pageNext=function(){var e=this.epubSpreads.getSpreadPageNumberByOffset(0);this.currentPage+=e},e.prototype.pagePrevious=function(){var e=this.epubSpreads.getSpreadPageNumberByOffset(-1);this.currentPage-=e},e.prototype.pageFirst=function(){this.currentPage=1},e.prototype.pageLast=function(){this.currentPage=this.pageQuantity},e.prototype.canChangePage=function(e,t){var i=e.isVector,n=e.vectorDiff,s=e.pointDiff,o=Math.abs(n)>Math.abs(t.vectorDiff);return i&&o?n>0?s<0?y.STAY:y.GO_TO_PREVIOUS:n<0?s>0?y.STAY:y.GO_TO_NEXT:y.STAY:y.STAY},e.prototype.userInteractions=function(e){void 0===e&&(e=!0),document.documentElement.style.cursor=e?"default":"progress",document.body.style.pointerEvents=e?"all":"none"},e.prototype.gotoPageByCoordsDiff=function(e,t){void 0===t&&(t=!0);var i=this.navigationAxis===g.NavigationAxis.X?"y":"x",n=this.canChangePage(e[this.navigationAxis],e[i]);return n===y.GO_TO_NEXT?void this.pageNext():n===y.GO_TO_PREVIOUS?void this.pagePrevious():void(t?this.currentPage=this.currentPage:this.currentPageNoAnimation=this.currentPage)},e.prototype.getPagePosition=function(){console.log(arguments)},e.prototype.getPageCoordX=function(){console.log(arguments)},e.prototype.getFrameCoordX=function(){console.log(arguments)},e.prototype.getFrameCoordY=function(){console.log(arguments)},e.prototype.getDeltaFrameForPage=function(){console.log(arguments)},e.prototype.scrollFrame=function(e){"next"===e||1===e?this.pageNext():"prev"!==e&&e!==-1||this.pagePrevious()},e.prototype.getCurrentPages=function(e){return void 0===e&&(e=this.currentPage),void 0===this.epubSpreads?[]:this.epubSpreads.getCurrentPageIndexes(e-1).map(function(e){return e+1})},e.prototype.getPagesOfFrame=function(){return this.getCurrentPages()},e.prototype.getFrameOfPage=function(e){return this.getCurrentPages(e)[0]},e.prototype.setConfig=function(e){this.config.setConfig(e)},e.prototype.updateSpreadsSize=function(){void 0!==this.epubSpreads&&this.epubSpreads.updateSpreadsSize()},e.prototype.switchNavigation=function(e){return e?(this.navigationAxis=e,this.navigationAxis):this.navigationAxis===g.NavigationAxis.X?(this.navigationAxis=g.NavigationAxis.Y,this.navigationAxis):(this.navigationAxis=g.NavigationAxis.X,this.navigationAxis)},e.prototype.isZoomed=function(){return 0!==this.epubSpreads.getScaleFromCurrentSpread()},e.prototype.zoomByStep=function(e){this.epubSpreads.zoomByStep({x:.5,y:0,step:e,animate:!0})},e.prototype.zoomIn=function(){this.epubSpreads.zoomToggle({x:.5,y:0,scale:this.defaultPageScaleAt,animate:!0})},e.prototype.zoomOut=function(){this.epubSpreads.zoomToggle({x:.5,y:0,scale:0,animate:!0})},e.prototype.zoomTo=function(e){this.epubSpreads.zoomToggle({x:.5,y:0,scale:e,animate:!0})},e.prototype.zoomNow=function(e){this.epubSpreads.zoomToggle({x:.5,y:0,scale:e,animate:!1})},e.prototype.initStartingPage=function(){var e="startPage",t=w.Main.urlManager.get(e);t&&this.goToPage(parseInt(t,10))},e.prototype.init=function(e,t){return n(this,void 0,void 0,function(){return s(this,function(i){switch(i.label){case 0:return f.resizeHTMLTagElement(),this.setConfig(e),this.epubCssManager=new a.EpubCssManager(this.config),[4,this.epubCssManager.init(t)];case 1:return i.sent(),this.epubNavigationTypeManager=new u["default"](this,this.config,this.viewMain),this.epubSpreads=new l["default"](this,this.config,this.viewMain,this.epubCssManager),this.pageControl=new h.Controller(this),this.epubSpreads.getMainViewElement().setAttribute("tabindex","1"),this.epubKeyBoardEvent=new d.EpubKeyBoardEvent(this.epubSpreads.getMainViewElement(),this.config),this.screenSize=this.epubNavigationTypeManager.screenSize,this.epubNavigationTypeManager.forceResize(),w.Main.pagesLoaderNew.setCurrentPage(this.currentPage),this.userInteractions(!0),this.initStartingPage(),[2]}})})},e}();i["default"]=S},{"./EpubConfig":3,"./EpubConfig/EpubDefaultConfig":4,"./EpubCssManager":5,"./EpubEvent":7,"./EpubGalleryManager":8,"./EpubGesturesEvent":9,"./EpubGesturesEvent/EpubKeyBoardEvent":11,"./EpubNavigationTypeManager":15,"./EpubSpreads":60,"./EpubStatistics":62,"./components/pageControl/Controller":68,"./utils/functions":85}],15:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubEvent"),s=e("./utils/functions"),o=function(){function e(e,t,i){var n=this;this.sizeIDString="",this.timers={resize:0,orientationchange:0},this.parent=e,this.config=t,this.epubEvent=w.epubEvent,this.screenSize=this.parent.screenSize,this.onResize=this.onResize.bind(this),this.pageLayout=w.Main.pageLayoutService.get("pageLayout");var s=w.Main.xmlManager.get("common-configuration","contents","zoom","width"),o=w.Main.xmlManager.get("common-configuration","contents","zoom","height");this.isWidePage=s>o,this.pageSize={width:this.pageWidth,height:this.pageHeight,ratio:1.5*this.pageWidth/this.pageHeight},this.updateScreenSize(),this.epubScreenElement=i,window.addEventListener(w.Param.eventResize,this.onResize.bind(this)),window.addEventListener("focus",this.onResize,!1),setTimeout(function(){return n.forceResize()},0),setTimeout(function(){n.localCheckWindowSize()},1e3)}return Object.defineProperty(e.prototype,"timeToRefreshScreenResize",{get:function(){return this.config.timeToRefreshScreenResize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddinigs",{get:function(){return this.config.paddings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpreadMax",{get:function(){return this.config.pagesBySpreadMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.config.pageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.config.pageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"switchLandScapeUsingPageSize",{get:function(){return this.config.switchLandScapeUsingPageSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerWidth",{get:function(){return window.innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerHeight",{get:function(){return window.innerHeight},enumerable:!0,configurable:!0}),e.prototype.needUpdateScreenSize=function(){return this.screenSize.width===this.innerWidth&&this.screenSize.height===this.innerHeight},e.prototype.updateScreenSize=function(){var e=this.needUpdateScreenSize();return this.screenSize.width=this.innerWidth,this.screenSize.height=this.innerHeight,this.screenSize.ratio=this.screenSize.width/this.screenSize.height,e},e.prototype.isWideScreen=function(){if(!w.Param.isDesktop){var e=screen;if(e.orientation)return e.orientation.type.includes("landscape");if(e.msOrientation)return e.msOrientation.type.includes("landscape")}return this.screenSize.width>this.screenSize.height},e.prototype.onResizeSync=function(){var e;return s.resizeHTMLTagElement(),window.scrollTo(0,0),this.config.paddinigsUpdate(),this.sizeIDString=this.innerHeight+"-"+this.innerWidth,this.updateScreenSize()!==!0||(this.parent.updateSpreadsSize(),e=s.isWindowLandscape(),e!==this.windowLandscape&&(this.windowLandscape=e,this.epubEvent.fire({type:n.EPUB_EVENTS.SCREEN_ORIENTATION,data:{landscape:e}})),!1)},e.prototype.onResize=function(e){window.scrollTo(0,0),clearTimeout(this.timers[e.type]),this.onResizeSync()!==!1&&(this.timers[e.type]=setTimeout(this.onResize.bind(this,e),this.timeToRefreshScreenResize))},e.prototype.localCheckWindowSize=function(){var e=this,t=this.innerHeight,i=this.innerWidth;this.sizeIDString!==t+"-"+i&&this.forceResize(),window.setTimeout(function(){e.localCheckWindowSize()},500)},e.prototype.forceResize=function(){this.onResize({type:"resize"})},e}();i["default"]=o},{"./EpubEvent":7,"./utils/functions":85}],16:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),e("es6-promise");var n=e("./utils/enums"),s=e("./utils/XHRPromise"),o=e("./utils/XHRPromise"),r=e("./EpubPage/LinksManager"),a=e("./EpubPageEnrichment"),u=e("./utils/functions"),l=e("./EpubEvent"),p='\\<\\?xml version="1.0" encoding="UTF-8" standalone="no"\\?\\>\\n\\<\\!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"\\>',h=function(){function e(t,i,s,o){this.epubPages=t,this.config=i,this.pageNumber=s,this.epubCssManager=o,this.isVisible=!1,this.loadList=[],this._formatType=n.READER_TYPES.EPUB_HTML,this.inCache=!1,this.synchronizedWidthSpread=!1,this.isOnLoad=!1,this._pageContainsCPUElement=!1,this.load_xhrError=function(){this.inCache=!1,this.isOnLoad=!1,this.callCallBackOnload(!1)},this.epubEvent=w.epubEvent,this.pageSizeCoefLinkCallBack=this.pageSizeCoefLinkCallBack.bind(this),this.currentPageNumber=s,void 0===e.pageSizeCoefLink&&(e.pageSizeCoefLink=new Promise(this.pageSizeCoefLinkCallBack)),this.elementContainer=this.element=document.createElement("figure"),this.linksManager=new r["default"](this,i,s,this.element),this.setRootElemAttributes(this.element,s),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&(this.epubPageEnrichment=new a["default"](this,this.config,this.elementContainer))}return e.prototype.pageSizeCoefLinkCallBack=function(t){e.pageSizeCoefLinkResolve=t},Object.defineProperty(e.prototype,"readerPageSrcType",{get:function(){return this.config.readerPageSrcType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"srcHdpi",{set:function(e){this.urlPageHdpi=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"src",{set:function(e){this.inCache!==!0&&(this.urlPage=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onload",{set:function(e){this._onload(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"atSpreadOffset",{set:function(e){this._lastSpreadOffset=this._spreadOffset,this._spreadOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageContainsCPUElement",{get:function(){return this._pageContainsCPUElement},set:function(e){var t="no";e===!0&&(t="yes"),"yes"===t&&this.pageContainsCPUElement===!0||"no"===t&&this.pageContainsCPUElement===!1||(this._pageContainsCPUElement=e,this.updateAttributesIframe(t))},enumerable:!0,configurable:!0}),e.prototype.updateIframesZoom=function(e){this.epubPageEnrichment&&this.epubPageEnrichment.updateIframesZoom(e),this.linksManager&&this.linksManager.updateIframesZoom(e)},e.prototype.updateAttributesIframe=function(e){this.zoomableParentElement&&this.zoomableParentElement.setAttribute("contains-iframe",e)},e.prototype.innerHTML=function(e,t){e.innerHTML=t},e.prototype.epubPageEnrichmentStat=function(){if(this.inCache!==!1)return 0===this._spreadOffset?void this.onVisible():void this.onNonVisible()},e.prototype.pathToSvg=function(e,t){var i=new RegExp(p,"gmi");return e=e.replace(/(\/[^\/]+)$/g,"/svg/"),t=t.replace(i,""),t.replace(/svg\//gim,e).trim()},e.prototype.parseImage=function(e){var t=this;u.htmlSecureRemoveChildren(e);var i=new Image;i.src=this.urlPage,e.appendChild(i);var n=new Promise(function(n,s){var o=i.onload=i.onerror=i.onabort=function(){n(i),e.classList.add("epub-image-page-loaded"),null!==i.parentElement&&setTimeout(function(){if(null!==i.parentElement){var n=new Image;n.src=t.urlPageHdpi,n.style.width=i.width+"px",n.style.height=i.height+"px",n.onload=function(){null!==i.parentElement&&e.replaceChild(n,i)},t.onFlush.then(function(){n.src=""})}},400)};i.complete===!0&&o()});return this.onFlush.then(function(){e.classList.remove("epub-image-page-loaded"),i.src=""}),n},e.prototype.parseHtmlImgsload=function(e){return new Promise(function(t,i){var n=e.onload=e.onerror=e.onabort=function(){t(e)},s=!e.src&&!e.srcset;(e.complete===!0||s)&&n()})},e.prototype.parseHtml=function(e,t){var i,s=[];this.readerPageSrcType===n.READER_TYPES.PDF_SVG&&(t=this.pathToSvg(this.urlPage,t)),u.htmlSecureRemoveChildren(e);var o=document.createElement("div");if(this.innerHTML(o,t),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML)for(var r=o.querySelectorAll("iframe"),a=function(e,t){l.pageContainsCPUElement=!0;var i=r[e].getAttribute("src");if(null===i)return"continue";i=i.replace("%num%",l.currentPageNumber.toString()),r[e].removeAttribute("src");var n=NIApi.common.resolveValues(i.toString()).then(function(t){r[e].setAttribute("data-src",t)});s.push(n)},l=this,p=0,h=r.length;p<h;p++)a(p,h);var c=o.childNodes[0],d=c.querySelectorAll("img");if(e.appendChild(c),(i=e.querySelector("div"))&&(this.readerPageSrcType===n.READER_TYPES.PDF_SVG?i.setAttribute("class","webpub-viewer__epub-container-spread-page-sub epub_content_tag_type-"+n.READER_TYPES[this.readerPageSrcType].toLowerCase()):(i.id="",i.classList.add("webpub-viewer__epub-container-spread-page-sub"),i.classList.add("epub_content_tag_type-"+n.READER_TYPES[this.readerPageSrcType].toLowerCase()))),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML){var f=e.querySelectorAll("[src],[href]");Array.prototype.forEach.call(f,function(e){if(e.hasAttribute("src")){var t=e.getAttribute("src");NIApi.common.resolveValues(t).then(function(t){e.setAttribute("src",t)})}if(e.hasAttribute("href")){var t=e.getAttribute("href");NIApi.common.resolveValues(t).then(function(t){e.setAttribute("href",t)})}}),this.parseEpubHyperlinks(e),this.parseEpubVideos(e),this.parseEpubScrolls(e),this.parseEditedTextFields(e)}for(var m=[],p=0,h=d.length;p<h;p++)m.push(this.parseHtmlImgsload(d[p]));var g=Promise.all(m);g.then(function(){e.classList.add("epub-image-page-loaded")}),this.onFlush.then(function(){e.classList.remove("epub-image-page-loaded")});var v=new Promise(function(t,i){g.then(function(){Promise.all(s).then(function(){t(e)})})});return v},e.prototype.parseEpubHyperlinks=function(e){for(var t="a[href]",i=[].slice.call(e.querySelectorAll(t)),n=0;n<i.length;n++){var s=i[n];s.addEventListener("click",function(e){var i=e.target.closest(t),n=i.getAttribute("href"),s=["","javascript:void(0)"];s.includes(n)||w.Main.trackerManager.trackEvent({name:"externalLink",variables:{1:n}})})}},e.prototype.parseEpubVideos=function(e){for(var t=[].slice.call(e.querySelectorAll("video")),i=0;i<t.length;i++){var n=t[i];w.Utils.addVideoStats(n),w.Param.userAgent.browser.name!==w.Param.userAgent.BROWSER.SAFARI||n.hasAttribute("autoplay")||(n.setAttribute("autoplay",""),n.dataset.ignoreAutoplay="true",n.pause())}},e.prototype.parseEpubScrolls=function(e){for(var t=["touchstart","touchmove","mousewheel","wheel","DOMMouseScroll"],i=function(e){return e.stopPropagation()},n=function(e){return e.preventDefault()},s='[class*="plugin-animationScrollableBox"], .edited[class*="editable-text"]:not(.is-empty)',o=[].slice.call(e.querySelectorAll(s)),r=function(e){var s=o[e];t.forEach(function(e){s.addEventListener(e,i)}),w.Param.userAgent.browser.name===w.Param.userAgent.BROWSER.FIREFOX&&s.addEventListener("mousedown",n)},a=0;a<o.length;a++)r(a)},e.prototype.parseEditedTextFields=function(e){for(var t='.edited[class*="editable-text"] .rte-subscript, .edited[class*="editable-text"] .rte-superscript',i=[].slice.call(e.querySelectorAll(t)),n=0;n<i.length;n++){var s=i[n],o=u.getNumberFromString(s.style.fontSize);s.style.fontSize=.75*o+"px"}},e.prototype.parsePdf=function(e){u.htmlSecureRemoveChildren(e);var t=document.createElement("embed");return t.src=this.urlPage+"#zoom=200",t.width=1536,t.height=2172,t.style.width=t.width+"px",t.style.height=t.height+"px",t.style.pointerEvents="none",e.appendChild(t),Promise.resolve(e)},e.prototype.setRootElemAttributes=function(e,t){e.classList.add("spread-page-"+t),e.classList.add("webpub-viewer__epub-container-spread-page")},e.prototype.load_loaded=function(e){var t,i=this;return this.inCache=!0,this.isOnLoad=!1,t=this.readerPageSrcType===n.READER_TYPES.PDF_IMG?this.parseImage(this.elementContainer):this.readerPageSrcType===n.READER_TYPES.PDF_PDF?this.parsePdf(this.elementContainer):this.parseHtml(this.elementContainer,e.responseText),t.then(function(){i.epubPageEnrichmentStat(),i.callCallBackOnload(!0),i.linksManager.load().then(function(){i.tryDispatchIsInDom()})}),t},e.prototype.load=function(){var e=this;if(this.inCache===!0)return this.epubPageEnrichmentStat(),Promise.resolve();if(this.isOnLoad===!0)return Promise.resolve();this.isOnLoad=!0;var t=u.getSplitedPromise();return new o["default"](s.Protocol.GET,this.urlPage).init().then(function(i){e.load_loaded(i).then(function(){t.resolve()})})["catch"](this.load_xhrError.bind(this)),t},e.prototype.callCallBackOnload=function(e){for(var t=0,i=this.loadList.length;t<i;t++)this.loadList[t].bind(this)(e);this.loadList=[]},e.prototype._onload=function(e){return this.inCache===!0?void e.bind(this)(!0):void this.loadList.push(e)},e.prototype.tryDispatchIsInDom=function(){if(this.inCache!==!1&&this.synchronizedWidthSpread!==!1&&this.linksManager.isLoaded()!==!1){this.epubEvent.fire({type:l.EPUB_EVENTS.PAGE_IN_DOM,data:{epubPage:this}});var t=e.coef;this.setCoefOfPageSizeToLink(),e.pageSizeCoefLinkResolve&&e.coef&&!t&&e.pageSizeCoefLinkResolve()}},e.prototype.syncElemWithSpread=function(e){var t=this;this.onFlush=u.getSplitedPromise();var i=this.load().then(function(){return t});return this.zoomableParentElement=e,this.synchronizedWidthSpread=!0,this.tryDispatchIsInDom(),{element:this.element,loaded:i}},e.prototype.setCoefOfPageSizeToLink=function(){e.coef||(e.coef=this.element.offsetHeight/this.config.linksSizePageHeight)},e.prototype.onVisible=function(){this.isVisible!==!0&&(this.isVisible=!0,this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.start(),this.linksManager.start())},e.prototype.onNonVisible=function(){this.isVisible!==!1&&(this.isVisible=!1,this.synchronizedWidthSpread=!1,this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.stop(),this.linksManager.stop())},e.prototype.flush=function(){this.onFlush&&this.onFlush.resolve(),this.inCache!==!1&&(this.synchronizedWidthSpread=!1,this.isVisible=!1,this.loadList=[],this.inCache=!1,u.htmlSecureRemoveChildren(this.elementContainer),this.readerPageSrcType===n.READER_TYPES.EPUB_HTML&&null!==this.epubPageEnrichment&&this.epubPageEnrichment.flush(),this.linksManager.flush())},e}();i["default"]=h},{"./EpubEvent":7,"./EpubPage/LinksManager":18,"./EpubPageEnrichment":46,"./utils/XHRPromise":82,"./utils/enums":84,"./utils/functions":85,"es6-promise":1}],17:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EpubEvent"),s=e("../EpubPage"),o=e("./shapes/ShapesManager"),r=e("./useracts/UserActs"),a=function(){function e(e,t,i,s,o){this.linksManager=e,this.config=t,this.data=i,this.container=s,this.pageElement=o,this.events=new n.EpubEvent,this.started=!1,this.status=!1,this.epubEvent=w.epubEvent,this.ePubPage=e.epubPage,this.start()}return e.prototype.createHtmlElement=function(){this.linksElem=this.linksElem||document.createElement("div"),this.linksElem.innerHTML="",this.linksElem.className="epub-links_container-link webpub-viewer__link-clickable"},e.prototype.setShapes=function(){this.shapesManager=new o.ShapesManager(this,this.config,this.data,this.pageElement,this.linksElem,s["default"].coef)},e.prototype.setUserActs=function(){this.userActs=new r.UserActs(this,this.config,this.data.useract,this.linksElem)},e.prototype.start=function(){var e=this;this.status=!0,s["default"].pageSizeCoefLink.then(function(){e.started===!1&&(e.createHtmlElement(),e.setShapes(),e.setUserActs()),e.started=!0,e.container.appendChild(e.linksElem)})},e.prototype.stop=function(){this.status=!1,this.started!==!1&&(this.started=!1,this.shapesManager.stop(),this.userActs.stop())},e.prototype.flush=function(){this.started=!1,this.shapesManager.flush(),this.userActs.flush()},e.prototype.updateZoomIfIframe=function(e){this.shapesManager&&this.shapesManager.updateZoomIfIframe(e)},e}();i["default"]=a},{"../EpubEvent":7,"../EpubPage":16,"./shapes/ShapesManager":28,"./useracts/UserActs":44}],18:[function(e,t,i){"use strict";var n=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e};Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Link"),o=e("./../utils/enums"),r=e("../EpubEvent"),a=function(){function e(e,t,i,n){var s=this;this.epubPage=e,this.config=t,this.pageNumber=i,this.container=n,this._src="",this.promise=!1,this.inCache=!1,this.isStarted=!1,this.links=[],this.blinkLink=this.blinkLinkPre.bind(this),this.epubEvent=w.epubEvent,this.linkBoxAspect=this.config.linkBoxAspect,this.epubEvent.addListener(r.EPUB_EVENTS.ADMIN_LINK_CREATE,function(e){e.data.pageNumber===i&&s.loadLink(e.data.linkData)})}return Object.defineProperty(e.prototype,"enableAspLinks",{get:function(){return this.config.enableAspLinks},enumerable:!0,configurable:!0}),e.prototype.blinkLinkPre=function(e){var t=this;this.linksElem.classList.add("epub-links-unreveal"),clearTimeout(this.toggleTimer),this.toggleTimer=setTimeout(function(){t.linksElem.classList.remove("epub-links-unreveal")},0)},e.prototype.initLinksBehaviors=function(){this.linkBoxAspect===o.LinksBehaviors.blink&&this.epubEvent.addListener(r.EPUB_EVENTS.PAGE_CLICK,this.blinkLink)},e.prototype.createHtmlElement=function(){this.linksElem=this.linksElem||document.createElement("div"),this.linksElem.innerHTML="",this.linksElem.className="epub-links_container epub-links_container-behaviour-"+o.LinksBehaviors[this.linkBoxAspect]},e.prototype.removeHtmlElement=function(){void 0!==this.linksElem&&(this.linksElem.innerHTML="")},e.prototype.isEnable=function(){return this.enableAspLinks},e.prototype.loadLink=function(e){for(var t=0,i=e.content.length;t<i;t++){var o=n({},e);o.content=[e.content[t]],this.links.push(new s["default"](this,this.config,o,this.linksElem,this.container))}},e.prototype.loadLinks=function(){this.createHtmlElement();for(var e=0,t=this.data.length;e<t;e++)this.loadLink(this.data[e]);this.initLinksBehaviors()},e.prototype.stopLinks=function(){for(var e=0,t=this.links.length;e<t;e++)this.links[e].stop()},e.prototype.flushLinks=function(){this.epubEvent.removeListener(r.EPUB_EVENTS.PAGE_CLICK,this.blinkLink),this.removeHtmlElement();for(var e=0,t=this.links.length;e<t;e++)this.links[e].flush();this.links=[]},e.prototype.startOnReady=function(){this.isStarted!==!1&&this.inCache!==!1&&(this.loadLinks(),this.container.appendChild(this.linksElem))},e.prototype.load=function(e){var t=this;return void 0===e&&(e=this.pageNumber),this.isEnable()===!1?Promise.resolve():(this.promise=w.Main.pageManager.getLinksPromise(e),this.promise===!0?(this.data=w.Main.pageManager.getRealLinks(e),this.inCache=!0,this.startOnReady(),Promise.resolve()):(this.promise=this.promise,this.promise.then(function(e){t.data=e,t.inCache=!0,t.startOnReady()}),this.promise))},e.prototype.isLoaded=function(){return this.inCache},e.prototype.flush=function(){this.isEnable()!==!1&&(this.isStarted=!1,this.inCache=!1,this.flushLinks())},e.prototype.start=function(){this.isEnable()!==!1&&(this.isStarted=!0,this.startOnReady())},e.prototype.stop=function(){this.isEnable()!==!1&&(this.isStarted=!1,this.stopLinks())},e.prototype.updateIframesZoom=function(e){this.links.forEach(function(t){return t.updateZoomIfIframe(e)})},e}();i["default"]=a},{"../EpubEvent":7,"./../utils/enums":84,"./Link":17}],19:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Video"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentTag="audio",t}return n(t,e),t.prototype.setElement=function(){this.element=window.document.createElement("audio"),this.element.className=this.className+"-audio",this.element.setAttribute("controls",""),this.element.src=this.url,this.setPreventGestures(),this.linksElem.appendChild(this.element)},t._name="audio",t}(s.Video);i.Audio=o},{"./Video":29}],20:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){
var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Shape"),o=function(e){function t(t,i,n,s,o){var r=e.call(this,t,i,n,s,o)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=s,r.coef=o,r.setRadius(),r}return n(t,e),t.prototype.setRadius=function(){var t=[],i=this.content.circle;"undefined"!=typeof i&&(t[0]=i.radius,e.prototype.setRadius.call(this,t,"%"))},t._name="circle",t}(s.Shape);i.Circle=o},{"./Shape":27}],21:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Shape"),o=e("./utils/IframeInteractions"),r=("ontouchstart"in window,function(e){function t(t,i,n,s,o,r){var a=e.call(this,t,i,n,s,o)||this;return a.shapesManager=t,a.config=i,a.data=n,a.linksElem=s,a.coef=o,a.pageElement=r,a.url="",a.foreground=!1,a.url=a.content.file.url,a.foreground=a.content.file.foreground||!1,a.setInfoToPage(),a.setElement(),a}return n(t,e),t.prototype.setInfoToPage=function(){this.ePubPage.pageContainsCPUElement=!0},t.prototype.setElement=function(){this.element=window.document.createElement("iframe"),this.element.style.opacity="0",this.element.style.pointerEvents="none",this.element.className=this.className+"-iframe",this.element.setAttribute("data-foreground",this.foreground?"true":"false"),this.element.setAttribute("contenteditable","true"),this.iframeInteractions=new o.IframeInteractions(this,this.config,this.element,this.linksElem,this.foreground)},t.prototype.checkLoaded=function(){this.element.addEventListener("load",this.loaded.bind(this))},t.prototype.loaded=function(){this.element.style.opacity="1";try{this.iFrameContentWindow=this.element.contentWindow,this.setAnimationInitIfNot(),this.foreground===!0&&"object"==typeof this.iFrameContentWindow.AdobeAn?this.iframeInteractions.init(this.iFrameContentWindow):this.foreground===!0&&(this.element.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow))}catch(e){}},t.prototype.setAnimationInitIfNot=function(){var e=this;try{var t=this.iFrameContentWindow.document.body,i=t.getAttribute("onload");t.removeAttribute("onload"),i&&t.addEventListener("load",function(){e.iFrameContentWindow.exportRoot||new e.iFrameContentWindow.Function(i)()})}catch(n){}},t.prototype.start=function(){var t=this;this.setInfoToPage(),this.isVisible!==!1&&(this.timerBeforAppend=setTimeout(function(){t.element.src=t.url,t.linksElem.appendChild(t.element)},850),this.checkLoaded(),e.prototype.start.call(this))},t.prototype.stop=function(){var t=this;clearTimeout(this.timerBeforAppend),this.element.parentElement&&setTimeout(function(){t.linksElem.removeChild(t.element)},300),e.prototype.stop.call(this)},t.prototype.flush=function(){this.iframeInteractions.flush(),e.prototype.flush.call(this)},t.prototype.updateZoom=function(e){var t=[this.coef*e,0,0,this.coef*e,this.x*this.coef*e,this.y*this.coef*e];this.linksElem.style.transform="matrix("+t.join(",")+")",this.linksElem.style.zoom=""+1/e},t._name="iframe",t}(s.Shape));i.Iframe=r},{"./Shape":27,"./utils/IframeInteractions":30}],22:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Shape"),o=function(e){function t(t,i,n,s,o){var r=e.call(this,t,i,n,s,o)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=s,r.coef=o,r.url="",r.foreground=!1,r.url=r.content.file.url,r.setElement(),r}return n(t,e),t.prototype.setElement=function(){this.linksElem.style.backgroundImage="url('"+this.url+"')"},t._name="image",t}(s.Shape);i.Image=o},{"./Shape":27}],23:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){this.mediaElement=e,this.enablePlayButton=!0,this.enableSeekBar=!0,this.enableRemainingTime=!0,this.enableCurrentTime=!0,this.enableVolumeButton=!0,this.enableFullScreenButton=!0,this.displayState=!0,this.toggleControls=this.toggleControls.bind(this),this.showControls=this.showControls.bind(this),this.addDelayUnDisplay=this.addDelayUnDisplay.bind(this),this.playState=this.playState.bind(this),this.onPlay=this.onPlay.bind(this),this.seekState=this.seekState.bind(this),this.timeupdate=this.timeupdate.bind(this),this.volumeState=this.volumeState.bind(this),this.onVolume=this.onVolume.bind(this),this.fullScreenState=this.fullScreenState.bind(this),this.eventsList=[],this.init()}return e.prototype.init=function(){this.initRootElement(),this.enablePlayButton===!0&&this.initPlayButton(),this.enableCurrentTime===!0&&this.initCurrentTime(),this.enableSeekBar===!0&&this.initSeekBar(),this.enableRemainingTime===!0&&this.initRemainingTime(),this.enableVolumeButton===!0&&this.initVolumeButton(),this.enableFullScreenButton===!0&&this.initFullScreenButton()},e.prototype.updateView=function(){this.mediaElement.parentElement&&this.mediaElement.parentElement.appendChild(this.rootElement)},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){this.removeEvents()},e.prototype.initRootElement=function(){this.rootElement=document.createElement("div"),this.initSuperPlayButton(),this.rootElement.classList.add("media_player_custom"),this.itemsElement=document.createElement("div"),this.itemsElement.classList.add("media_player_custom-items"),this.rootElement.appendChild(this.itemsElement),this.addDelayUnDisplay(),this.addEvent(this.mediaElement,"click",this.toggleControls),this.addEvent(this.mediaElement,"touchend",this.toggleControls),this.addEvent(this.mediaElement,"mousemove",this.showControls)},e.prototype.initSuperPlayButton=function(){this.superPlayButton=document.createElement("div"),this.rootElement.appendChild(this.superPlayButton),this.superPlayButton.classList.add("super-play_button-custom"),this.addEvent(this.superPlayButton,"click",this.playState),this.setIcon(this.superPlayButton,"play-bold-v4")},e.prototype.toggleControls=function(e){return e.preventDefault(),this.displayState===!1?void this.showControls(e):void this.hideControls()},e.prototype.showControls=function(e){this.addDelayUnDisplay(),this.rootElement.classList.remove("hide"),this.displayState=!0},e.prototype.hideControls=function(){this.rootElement.classList.add("hide"),this.displayState=!1},e.prototype.addDelayUnDisplay=function(){var e=this;clearTimeout(this.delayDisplayTimer),this.delayDisplayTimer=setTimeout(function(){e.hideControls()},4e3)},e.prototype.initPlayButton=function(){this.playButton=this.createItem(),this.playButton.classList.add("play_button-custom"),this.addEvent(this.playButton,"click",this.playState),this.addEvent(this.mediaElement,"play",this.onPlay),this.addEvent(this.mediaElement,"pause",this.onPlay),this.setIcon(this.playButton,"play-bold-v4"),this.setIcon(this.playButton,"pause")},e.prototype.playState=function(){return this.addDelayUnDisplay(),this.mediaElement.paused?void this.mediaElement.play():void this.mediaElement.pause()},e.prototype.onPlay=function(){return this.mediaElement.paused?(this.playButton.classList.remove("play-enbaled"),void this.superPlayButton.classList.remove("play-enbaled")):(this.playButton.classList.add("play-enbaled"),void this.superPlayButton.classList.add("play-enbaled"))},e.prototype.initCurrentTime=function(){this.currentTimeElement=this.createItem(),this.currentTimeElement.classList.add("current_time-custom"),this.currentTimeElement.classList.add("no-hover")},e.prototype.initSeekBar=function(){this.seekButton=this.createItem(),this.seekButton.classList.add("seek_button-custom"),this.seekButton.classList.add("no-hover"),this.seekButtonRange=document.createElement("input"),this.seekButton.appendChild(this.seekButtonRange),this.seekButtonRange.setAttribute("type","range"),this.seekButtonRange.setAttribute("step","0.1"),this.seekButtonRange.setAttribute("min","0"),this.seekButtonRange.setAttribute("max","100"),this.seekButtonRange.setAttribute("value","0"),this.addEvent(this.seekButtonRange,"touchstart",this.cancelBubble),this.addEvent(this.seekButtonRange,"mousemove",this.cancelBubble),this.seekButtonRange.onchange=this.seekState;try{this.seekButtonRange.oninput=this.seekState}catch(e){console.warn(e)}this.addEvent(this.mediaElement,"timeupdate",this.timeupdate)},e.prototype.initRemainingTime=function(){this.remainingTimeElement=this.createItem(),this.remainingTimeElement.classList.add("remaining_time-custom"),this.remainingTimeElement.classList.add("no-hover")},e.prototype.timeupdate=function(){var e=this.mediaElement.currentTime,t=this.mediaElement.duration-this.mediaElement.currentTime;this.seekButtonRange.value=(e/this.mediaElement.duration*100).toString(),this.onVolume(),this.currentTimeElement&&(this.currentTimeElement.innerHTML=this.getReadableTime(e)),this.remainingTimeElement&&(this.remainingTimeElement.innerHTML="-"+this.getReadableTime(t))},e.prototype.seekState=function(){this.addDelayUnDisplay();var e=parseFloat(this.seekButtonRange.value),t=e/100*this.mediaElement.duration;this.mediaElement.currentTime=t},e.prototype.initVolumeButton=function(){this.volumeButton=this.createItem(),this.volumeButton.classList.add("volume_button-custom"),this.addEvent(this.volumeButton,"click",this.volumeState),this.addEvent(this.mediaElement,"volumechange",this.onVolume),this.onVolume(),this.setIcon(this.volumeButton,"speaker-on"),this.setIcon(this.volumeButton,"speaker-off")},e.prototype.volumeState=function(){return this.addDelayUnDisplay(),0===this.mediaElement.volume||this.mediaElement.muted===!0?(this.mediaElement.muted=!1,void(this.mediaElement.volume=1)):(this.mediaElement.muted=!0,void(this.mediaElement.volume=0))},e.prototype.onVolume=function(){if(this.volumeButton){var e=this.volumeButton.classList.contains("volume-enbaled");return 0===this.mediaElement.volume||this.mediaElement.muted===!0?void(e===!0&&this.volumeButton.classList.remove("volume-enbaled")):void(e===!1&&this.volumeButton.classList.add("volume-enbaled"))}},e.prototype.initFullScreenButton=function(){this.fullscreenButton=this.createItem(),this.fullscreenButton.classList.add("fullscreen_button-custom"),this.addEvent(this.fullscreenButton,"click",this.fullScreenState),this.setIcon(this.fullscreenButton,"fullscreen-v4")},e.prototype.fullScreenState=function(){if(this.mediaElement.requestFullscreen)this.mediaElement.requestFullscreen();else if(this.mediaElement.mozRequestFullScreen)this.mediaElement.mozRequestFullScreen();else if(this.mediaElement.webkitRequestFullscreen)this.mediaElement.webkitRequestFullscreen();else if(this.mediaElement.webkitEnterFullscreen)try{this.mediaElement.webkitEnterFullscreen()}catch(e){}},e.prototype.createItem=function(){var e=document.createElement("div");return e.classList.add("media-item"),this.itemsElement.appendChild(e),e},e.prototype.setIcon=function(e,t){var i=document.createElement("div");w.Utils.svgIcon(i,{icon:t,color:null}),e.innerHTML+=i.innerHTML},e.prototype.getReadableTime=function(e){var t=[],i=parseInt(e.toString(),10),n=Math.floor(i/86400);i-=3600*n*24;var s=Math.floor(i/3600);i-=3600*s;var o=Math.floor(i/60);return i-=60*o,s&&t.push(s),t.push(o),t.push(this.padNumber(i,2)),t.join(":")},e.prototype.padNumber=function(e,t){var i="00"+e;return i.substr(i.length-t)},e.prototype.addEvent=function(e,t,i){this.eventsList.push({element:e,type:t,callBack:i}),e.addEventListener(t,i)},e.prototype.removeEvent=function(e,t,i){for(var n=0;n<this.eventsList.length;n++){var s=this.eventsList[n];if(e===s.element&&t===s.type&&i===s.callBack)return delete this.eventsList[n],this.eventsList.splice(n,1),e.removeEventListener(t,i),void this.removeEvent(e,t,i)}},e.prototype.removeEvents=function(){for(var e=0;e=this.eventsList.length;){var t=this.eventsList[e-1];this.removeEvent(t.element,t.type,t.callBack)}},e.prototype.cancelBubble=function(e){e.cancelBubble=!0},e}();i.MediaPlayer=n},{}],24:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Shape"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t._name="rect",t}(s.Shape);i.Rect=o},{"./Shape":27}],25:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Shape"),o=function(e){function t(t,i,n,s,o){var r=e.call(this,t,i,n,s,o)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=s,r.coef=o,r.setRadius(),r}return n(t,e),t.prototype.setRadius=function(){var t=[],i=this.content.roundrect;"undefined"!=typeof i&&(t[0]=i.radius,t[1]=i.radius,t[2]=i.radius,t[3]=i.radius,e.prototype.setRadius.call(this,t))},t._name="roundrect",t}(s.Shape);i.RoundRect=o},{"./Shape":27}],26:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./Shape"),o=function(e){function t(t,i,n,s,o){var r=e.call(this,t,i,n,s,o)||this;return r.shapesManager=t,r.config=i,r.data=n,r.linksElem=s,r.coef=o,r.setRadius(),r}return n(t,e),t.prototype.setRadius=function(){var t=[],i=this.content.roundrectcomplex;"undefined"!=typeof i&&(t[0]=i.tl_radius,t[1]=i.tr_radius,t[2]=i.br_radius,t[3]=i.bl_radius,e.prototype.setRadius.call(this,t))},t._name="roundrectcomplex",t}(s.Shape);i.RoundRectComplex=o},{"./Shape":27}],27:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./../../utils/enums"),s=e("../../utils/functions"),o=function(){function e(t,i,s,o,r,a){this.shapesManager=t,this.config=i,this.data=s,this.linksElem=o,this.coef=r,this.pageElement=a,this.className="",this.width=0,this.height=0,this.x=0,this.y=0,this.radius=[],this.status=n.ShapeActivityStatus.INIT,this.orientation="auto",this.isVisible=!1,this.Id=0,this.Id=e.globalID++,this.ePubPage=t.ePubPage,this.content=this.getDataContent(),this.className="epub-link-type_"+this.data.type,this.width=this.content.width,this.height=this.content.height,this.x=this.content.x,this.y=this.content.y,this.linkBlinkDuration=this.config.linkBlinkDuration,this.linkBoxAspect=this.config.linkBoxAspect,this.orientation=(this.data.orientation||this.orientation).toLowerCase(),this.setSizes(),this.initLinksBehaviors()}return e.prototype.setAnimationDuration=function(e,t){void 0===t&&(t="ms"),this.linksElem.style.webkitAnimationDuration=e+t,this.linksElem.style.animationDuration=e+t},e.prototype.initLinksBehaviors=function(){this.linkBoxAspect===n.LinksBehaviors["static"]&&this.linksElem.classList.add("webpub-viewer__link--focused")},e.prototype.setRadius=function(e,t){void 0===t&&(t="px"),0!==e.length&&(this.linksElem.style.webkitBorderRadius=e.join(t+" ")+t,this.linksElem.style.borderRadius=e.join(t+" ")+t)},e.prototype.setSizes=function(){var e=[this.coef,0,0,this.coef,this.x*this.coef,this.y*this.coef];this.linksElem.style.width=this.width+"px",this.linksElem.style.height=this.height+"px",s.styleTransform(this.linksElem,"matrix("+e.join(",")+")"),this.linksElem.classList.add(this.className)},e.prototype.getDataContent=function(){return this.data.content[0]},e.prototype.display=function(e){if(e===!0&&this.isVisible!==!0)return this.isVisible=!0,this.linksElem.classList.add("epub-link-visible"),void this.start();if(e===!0);else if(e===!1&&this.isVisible!==!1)return this.isVisible=!1,this.linksElem.classList.remove("epub-link-visible"),void this.stop()},e.prototype.start=function(){this.status=n.ShapeActivityStatus.START},e.prototype.stop=function(){this.status=n.ShapeActivityStatus.STOP},e.prototype.flush=function(){this.status=n.ShapeActivityStatus.FLUSH},e.prototype.getType=function(){return this.data.type},e._name="shape",e.globalID=0,e}();i.Shape=o},{"../../utils/functions":85,"./../../utils/enums":84}],28:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./../../utils/enums"),s=e("../../utils/functions"),o=e("./Rect"),r=e("./RoundRect"),a=e("./RoundRectComplex"),u=e("./Circle"),l=e("./Iframe"),p=e("./Video"),h=e("./Audio"),c=e("./Image"),d=e("../../EpubEvent"),f={Rect:o.Rect,RoundRect:r.RoundRect,RoundRectComplex:a.RoundRectComplex,Circle:u.Circle,Iframe:l.Iframe,Video:p.Video,Audio:h.Audio,Image:c.Image},m=function(){function e(e,t,i,n,s,o){this.link=e,this.config=t,this.data=i,this.pageElement=n,this.linksElem=s,this.coef=o,this.shapes=[],this.epubEvent=w.epubEvent,this.ePubPage=e.ePubPage,this.setShapes(),this.startShapes(),this.setEventOrientations()}return e.prototype.setShapes=function(){for(var e in f)f[e]._name===this.data.type&&this.shapes.push(new f[e](this,this.config,this.data,this.linksElem,this.coef,this.pageElement));0===this.shapes.length&&console.warn("Shape type not supported :"+this.data.type,this.data)},e.prototype.startShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].status!==n.ShapeActivityStatus.START&&this.shapes[e].start()},e.prototype.stopShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].status===n.ShapeActivityStatus.START&&this.shapes[e].stop()},e.prototype.setEventOrientations=function(){var e=this;this.epubEvent.addListener(d.EPUB_EVENTS.SCREEN_ORIENTATION,function(t){e.setOrientations(t.data.landscape)}),this.setOrientations(s.isWindowLandscape())},e.prototype.setOrientations=function(e){for(var t=0,i=this.shapes.length;t<i;t++)this.setOrientation(e,this.shapes[t])},e.prototype.setOrientation=function(e,t){return"auto"===t.orientation?void t.display(!0):"landscape"===t.orientation&&e===!0||"portrait"===t.orientation&&e===!1?void t.display(!0):void t.display(!1)},e.prototype.flushShapes=function(){for(var e=0,t=this.shapes.length;e<t;e++)this.shapes[e].flush()},e.prototype.start=function(){this.startShapes()},e.prototype.stop=function(){this.stopShapes()},e.prototype.flush=function(){this.flushShapes()},e.prototype.updateZoomIfIframe=function(e){this.shapes.filter(function(e){return l.Iframe._name===e.getType()}).forEach(function(t){return t.updateZoom(e)})},e._name="shapes",e}();i.ShapesManager=m},{"../../EpubEvent":7,"../../utils/functions":85,"./../../utils/enums":84,"./Audio":19,"./Circle":20,"./Iframe":21,"./Image":22,"./Rect":24,"./RoundRect":25,"./RoundRectComplex":26,"./Video":29}],29:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./../../utils/enums"),o=e("./Shape"),r=e("./../../EpubGesturesEvent"),a=e("./MediaPlayer"),u=function(e){function t(t,i,n,s,o,r){var a=e.call(this,t,i,n,s,o)||this;return a.shapesManager=t,a.config=i,a.data=n,a.linksElem=s,a.coef=o,a.pageElement=r,a.url="",a.label="",a.contentTag="video",a._isPlaying=!1,a.enableDefaultControls=!1,a.userAgent=w.Param.userAgent,a.url=a.content[a.contentTag].url,a.label=a.content[a.contentTag].label,a.setInfoToPage(),a.setElement(),a}return n(t,e),t.prototype.setInfoToPage=function(){this.ePubPage.pageContainsCPUElement=!0},t.prototype.setElement=function(){var e=window.document.createElement("source");this.element=window.document.createElement("video"),this.element.className=this.className+"-video",this.enableDefaultControls?this.element.setAttribute("controls",""):this.mediaPlayer=new a.MediaPlayer(this.element),this.element.setAttribute("controlsList","nodownload"),this.element.setAttribute("data-label",this.label),this.userAgent.os.name===w.Param.userAgent.OS.IOS&&this.content.video.autoplay&&this.element.setAttribute("muted",""),e.src=this.url,this.element.appendChild(e),this.setPreventGestures(),this.linksElem.appendChild(this.element),this.mediaPlayer&&this.mediaPlayer.updateView(),w.Utils.addVideoStats(this.element),w.Param.userAgent.browser.name!==w.Param.userAgent.BROWSER.SAFARI||this.element.hasAttribute("autoplay")||(this.element.setAttribute("autoplay",""),this.element.dataset.ignoreAutoplay="true",this.element.pause())},t.prototype.setPreventGestures=function(){this.element.onvolumechange=this.makeDefaultPreventGesture.bind(this),this.element.onseeking=this.element.onvolumechange,this.element.onplay=this.onplay.bind(this),this.element.onpause=this.onpause.bind(this)},t.prototype.makeDefaultPreventGesture=function(){r["default"].prototype.preventAllGesture()},t.prototype.setAnimationDuration=function(e,t){void 0===t&&(t="ms")},t.prototype.initLinksBehaviors=function(){},t.prototype.setRadius=function(e,t){void 0===t&&(t="px")},t.prototype.setSizes=function(){this.linksElem.style.width=Math.round(this.width*this.coef)+"px",this.linksElem.style.height=Math.round(this.height*this.coef)+"px",this.linksElem.style.left=Math.round(this.x*this.coef)+"px",this.linksElem.style.top=Math.round(this.y*this.coef)+"px",this.linksElem.classList.add(this.className)},t.prototype.onplay=function(){this.makeDefaultPreventGesture(),this._isPlaying=!0,this.status!==s.ShapeActivityStatus.STOP&&this.status!==s.ShapeActivityStatus.FLUSH||this.element.pause()},t.prototype.onpause=function(){this.makeDefaultPreventGesture(),this._isPlaying=!1},t.prototype.start=function(){var t=this;this.isVisible!==!1&&(e.prototype.start.call(this),this.setInfoToPage(),this.content.video.autoplay&&this.element.paused&&this._isPlaying===!1&&(this.playPromise=this.element.play(),"object"==typeof this.playPromise&&this.playPromise.then&&this.playPromise.then(function(){})["catch"](function(){var e=t.element.play();e["catch"](function(){})})))},t.prototype.stop=function(){this.mediaPlayer&&this.mediaPlayer.stop(),this.element.paused===!1&&this._isPlaying===!0&&this.element.pause(),e.prototype.stop.call(this)},t.prototype.flush=function(){this.mediaPlayer&&this.mediaPlayer.flush(),e.prototype.flush.call(this)},t._name="video",t}(o.Shape);i.Video=u},{"./../../EpubGesturesEvent":9,"./../../utils/enums":84,"./MediaPlayer":23,"./Shape":27}],30:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../../EpubEvent"),s=e("../../../utils/functions"),o="ontouchstart"in window,r=400,a=function(){function e(e,t,i,n,o){this.parent=e,this.config=t,this.element=i,this.linksElem=n,this.foreground=o,this.supportCreateMouseEvent=0,this.eventsListe=["mousemove","mousedown","mouseup","mouseover","mouseout"],this.eventsListeTouch=["touchmove","touchstart","touchend"],this.epubEvent=w.epubEvent,this.removableListeners=[];var r=s.getSplitedPromise();this.waitAction=r,r.resolve()}return e.prototype.init=function(e){try{document.createEvent("MouseEvents"),this.preventZoomInteraction=!1,this.supportCreateMouseEvent=1}catch(t){if("MouseEvent"in window==!1)return this.supportCreateMouseEvent=2,this.element.style.pointerEvents="all",this.linksElem.style.pointerEvents="none",void(this.preventZoomInteraction=!0)}this.iFrameContentWindow=e,this.simulateInteractions()},Object.defineProperty(e.prototype,"zoomSingleClick",{get:function(){return this.config.zoomSingleClick},enumerable:!0,configurable:!0}),e.prototype.createMouseEvent=function(e,t){var i,n=null,s=e.type;return"mouseover"!==s&&"mouseout"!==s||(n=t),1===this.supportCreateMouseEvent?(i=document.createEvent("MouseEvents"),i.initMouseEvent(s,!0,!0,this.iFrameContentWindow,0,e.offsetX,e.offsetY,e.offsetX,e.offsetY,!1,!1,!1,!1,0,n)):i=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:this.iFrameContentWindow,screenX:e.offsetX,screenY:e.offsetY,clientX:e.offsetX,clientY:e.offsetY}),i},e.prototype.getCoordsTouches=function(e){var t=e.touches[0]||e;return this.getCoords(t)},e.prototype.getCoords=function(e){var t=e.currentTarget||e.target,i=t.getBoundingClientRect(),n=t.offsetWidth/i.width;return[(e.pageX-i.left)*n,(e.pageY-i.top)*n]},e.prototype.simulateEvt=function(e){var t=this;e.preventDefault();var i,a=this.canvasElement,u=e.type,l=0,p=0;switch(u){case"touchmove":u="mousemove";break;case"touchend":u="mouseup";break;case"touchstart":u="mousedown"}var h;if(o&&void 0!==e.touches?(h=this.getCoordsTouches(e),p=h[0],l=h[1]):(p=e.offsetX,l=e.offsetY,p||l||(h=this.getCoords(e),p=h[0],l=h[1])),i=this.createMouseEvent({type:u,offsetX:p,offsetY:l},a),this.canvasElement&&("mousemove"===u&&(this.canvasElement.style.cursor?document.body.style.cursor=this.canvasElement.style.cursor:document.body.style.cursor=null),"mouseout"===u&&(document.body.style.cursor=null)),"mouseup"===u){var c=s.getSplitedPromise();this.waitAction=c.promise;var d=setTimeout(function(){c.resolve(),t.epubEvent.removeListener(n.EPUB_EVENTS.PAGE_CLICK,f)},r),f=function(){clearTimeout(d),t.epubEvent.removeListener(n.EPUB_EVENTS.PAGE_CLICK,f),a.dispatchEvent(i),i=t.createMouseEvent({type:"click",offsetX:p,offsetY:l},a),a.dispatchEvent(i),c.resolve()};return void this.epubEvent.addListener(n.EPUB_EVENTS.PAGE_CLICK,f)}a.dispatchEvent(i)},e.prototype.simulateInteractions=function(){var e=this;if(this.canvasElement=this.iFrameContentWindow.document.querySelector("canvas"),this.canvasElement){this.linksElem.style.pointerEvents="all";var t=this.eventsListe;o&&(t=this.eventsListeTouch),t.forEach(function(t){e.removableListeners.push({type:t,action:function(t){e.waitAction.then(function(){e.simulateEvt(t)})}})}),this.removableListeners.forEach(function(t){e.linksElem.addEventListener(t.type,t.action)})}},e.prototype.removeEvents=function(){var e=this;this.removableListeners.forEach(function(t){e.linksElem.removeEventListener(t.type,t.action)}),this.removableListeners=[]},e.prototype.setPreventZoomInteraction=function(e){if(o&&this.preventZoomInteraction!==!1){var t=e.document;t.addEventListener("touchmove",function(e){var t=e;1!==t.scale&&e.preventDefault()},!1);var i=0;t.addEventListener("touchend",function(e){var t=Date.now();t-i<=300&&(e.preventDefault(),e.cancelBubble=!0,e.stopPropagation()),i=t},!0)}},e.prototype.flush=function(){this.removeEvents()},e}();i.IframeInteractions=a},{"../../../EpubEvent":7,"../../../utils/functions":85}],31:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./GotoPage"),o=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openFirst()})}}}),this.executedAction(arguments),!1},t._name="firstPage",t}(s.GotoPage);i.FirstPage=r},{"../../EpubEvent":7,"./GotoPage":32}],32:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./UserAct"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.page.open(parseInt(e.param||0))})}}}),this.executedAction(arguments),!1},t.prototype.setTooltip=function(){var t=this.data.param;if(void 0===t)return void e.prototype.setTooltip.call(this);""===t&&(t="1");var i=w.Main.xmlManager.get("locale","tooltip_"+this.data.type),n=parseInt(t,10),s=w.Main.xmlManager.get("common-configuration","config","shift"),o=n-s;i=i.concat(" ",o.toString()),e.prototype.setTooltip.call(this,i)},t._name="gotoPage",t}(s.UserAct);i.GotoPage=r},{"../../EpubEvent":7,"./UserAct":43}],33:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./UserAct"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){if(t!==!1)return"fwd"===e.param?void i.historyFwd():void i.historyBack()})}}}),this.executedAction(arguments),!1},t.prototype.historyBack=function(){window.history.back()},t.prototype.historyFwd=function(){window.history.forward()},t._name="history",t}(s.UserAct);i.History=r},{"../../EpubEvent":7,"./UserAct":43}],34:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./UserAct"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){if(t!==!1)try{new Function("linkData","linkElement",e.param)(e,i.linksElem)}catch(t){console.warn(t)}})}}}),this.executedAction(arguments),!1},t._name="javascript",t}(s.UserAct);i.JavaScriptCall=r},{"../../EpubEvent":7,
"./UserAct":43}],35:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./GotoPage"),o=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openLast()})}}}),this.executedAction(arguments),!1},t._name="lastPage",t}(s.GotoPage);i.LastPage=r},{"../../EpubEvent":7,"./GotoPage":32}],36:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./UserAct"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.lightbox.openPopup(null,e)})}}}),this.executedAction(arguments),!1},t._name="lightbox",t}(s.UserAct);i.LightBox=r},{"../../EpubEvent":7,"./UserAct":43}],37:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./UserAct"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.mailTo=function(e){var t=e.trim(),i="mailto:",n=t.match(/^mailto:|^mailto :/gi);null!==n&&0!==n.length&&(i=""),window.location.href=i+t},t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&i.mailTo(e.param)})}}}),this.executedAction(arguments),!1},t._name="mailto",t}(s.UserAct);i.MailTo=r},{"../../EpubEvent":7,"./UserAct":43}],38:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./GotoPage"),o=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openNext()})}}}),this.executedAction(arguments),!1},t._name="nextPage",t}(s.GotoPage);i.NextPage=r},{"../../EpubEvent":7,"./GotoPage":32}],39:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./UserAct"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&(NIApi.navigator.openUrl(e.param),i.successAction(e))})}}}),this.executedAction(arguments),!1},t._name="url",t}(s.UserAct);i.OpenUrl=r},{"../../EpubEvent":7,"./UserAct":43}],40:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./LightBox"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&NIApi.lightbox.openPopup(null,e)})}}}),this.executedAction(arguments),!1},t._name="popup",t}(s.LightBox);i.PopUp=r},{"../../EpubEvent":7,"./LightBox":36}],41:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./GotoPage"),o=e("../../EpubEvent"),r=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i.pointerEvents="all",i.pointerCursor="pointer",i._static=t,i}return n(t,e),t.prototype.exec=function(e,t){return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(e){e.then(function(e){e!==!1&&NIApi.page.openPrevious()})}}}),this.executedAction(arguments),!1},t._name="prevPage",t}(s.GotoPage);i.PrevPage=r},{"../../EpubEvent":7,"./GotoPage":32}],42:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./UserAct"),o=e("../../EpubEvent"),r=function(e){function t(i,n,s){var o=e.call(this,i,n,s)||this;return o.data=i,o.linksElem=n,o.index=s,o.pointerEvents="all",o.pointerCursor="pointer",o._static=t,o.init(),o}return n(t,e),t.prototype.mailTo=function(e){var t=e.trim(),i="tel:",n=t.match(/^tel:|^tel :/gi);null!==n&&0!==n.length&&(i=""),window.location.href=i+t},t.prototype.exec=function(e,t){var i=this;return this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,data:{override:this.overrideOtherActions,action:function(t){t.then(function(t){t!==!1&&i.mailTo(e.param)})}}}),this.executedAction(arguments),!1},t._name="tel",t}(s.UserAct);i.Tel=r},{"../../EpubEvent":7,"./UserAct":43}],43:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../EpubDomApi"),s=e("../../EpubEvent"),o=function(){function e(t,i,n){this.data=t,this.linksElem=i,this.index=n,this.pointerEvents="none",this.pointerCursor="auto",this._static=e,this.overrideOtherActions=!0,this.epubEvent=w.epubEvent}return e.prototype.init=function(){this.defineAction(),this.setPointers(),this.setTooltip()},e.prototype.defineAction=function(){0===this.index?this.setActionDefault():this.setAction()},e.prototype.setTooltip=function(e){void 0===e&&(e=""),"string"==typeof this.data.textField&&""!==this.data.textField.trim()&&(e=this.data.textField),""===e&&(e=w.Main.xmlManager.get("locale","tooltip_"+this.data.type)),this.linksElem.setAttribute("data-tooltip",e||""),w.Main.tooltipManager.register(this.linksElem)},e.prototype.setPointers=function(){this.linksElem.style.pointerEvents=this.pointerEvents,this.linksElem.style.cursor=this.pointerCursor},e.prototype.exec=function(e,t){return n["default"](this._static._name,[t,e.param,e]),this.executedAction(arguments),!1},e.prototype.executedAction=function(e){console.log("From LinksManager this action was exectuted",e)},e.prototype.setActionDefault=function(){var e=this.exec.bind(this,this.data,this.linksElem);this.linksElem.onclick=e,this.linksElem.ontouchend=e},e.prototype.setAction=function(){},e.prototype.successAction=function(e){this.epubEvent.fire({type:s.EPUB_EVENTS.ACTION_LINK_SUCCESS,data:{userAct:e}})},e._name="userAct",e}();i.UserAct=o},{"../../EpubDomApi":6,"../../EpubEvent":7}],44:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./MailTo"),s=e("./Tel"),o=e("./OpenUrl"),r=e("./GotoPage"),a=e("./PrevPage"),u=e("./NextPage"),l=e("./PopUp"),p=e("./LightBox"),h=e("./Youtube"),c=e("./LastPage"),d=e("./FirstPage"),f=e("./JavaScriptCall"),m=e("./History"),g={MailTo:n.MailTo,Tel:s.Tel,OpenUrl:o.OpenUrl,GotoPage:r.GotoPage,PrevPage:a.PrevPage,NextPage:u.NextPage,LastPage:c.LastPage,FirstPage:d.FirstPage,PopUp:l.PopUp,LightBox:p.LightBox,Youtube:h.Youtube,JavaScriptCall:f.JavaScriptCall,History:m.History},v=function(){function e(e,t,i,n){this.link=e,this.config=t,this.data=i,this.linksElem=n,this.userActs=[],this.setUserActs()}return e.prototype.makeActionFromUserAct=function(e,t){var i=[];for(var n in g)g[n]._name===e.type&&i.push(new g[n](e,this.linksElem,t));return i},e.prototype.setUserActs=function(){for(var e,t=0,i=this.data.length;t<i;t++)e=this.makeActionFromUserAct(this.data[t],t),0===e.length&&console.warn("useract type not supported :"+this.data[t].type,this.data[t]),this.userActs=this.userActs.concat(e)},e.prototype.stop=function(){},e.prototype.flush=function(){},e._name="userActs",e}();i.UserActs=v},{"./FirstPage":31,"./GotoPage":32,"./History":33,"./JavaScriptCall":34,"./LastPage":35,"./LightBox":36,"./MailTo":37,"./NextPage":38,"./OpenUrl":39,"./PopUp":40,"./PrevPage":41,"./Tel":42,"./Youtube":45}],45:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./LightBox"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t._name="youtube",t}(s.LightBox);i.Youtube=o},{"./LightBox":36}],46:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./EpubGesturesEvent"),o=e("./EpubPageEnrichment/IFrames"),r=e("./EpubPageEnrichment/Medias"),a=e("./EpubPageEnrichment/Sliders");!function(e){e.Scroll="SCROLL"}(n||(n={}));var u="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",l=0,p=100,h=function(){function e(e,t,i){this.epubPage=e,this.config=t,this.element=i,this.eventListeners=[],this.enableRegisterInteractiveHandlers=!1,this.started=!1,this.pendingAnimationMap={},this.setTimeoutIds=[],this.delayedAnimations=[],this.epubAnimationsHistory=[],this.epubPageEnrichmentID=l++,this.launchVisibleAnimations=this.launchVisibleAnimations.bind(this),w.epubAnimUtils={goToState:this.goToState.bind(this)}}return e.getActionHistoryTemplate=function(){return{func:null,args:[]}},e.prototype.start=function(){this.started=!0,this.startGifs();var e=this.element.childNodes[0],t=e.getAttribute("data-onload");return null!==t&&t.indexOf("RegisterInteractiveHandlers")===-1?void(this.enableRegisterInteractiveHandlers=!1):(this.enableRegisterInteractiveHandlers=!0,void this.registerInteractiveHandlers())},e.prototype.stop=function(){this.clearEnrichmentTimeouts(),this.started!==!1&&(this.started=!1,this.stopGifs(),this.enableRegisterInteractiveHandlers!==!1&&(this.stopMedias(),this.removeEventListeners(),this.reloadActionHistory(),this.stopIFrames(),this.stopSliders()))},e.prototype.flush=function(){this.stop(),this.gifs=null},e.prototype.updateIframesZoom=function(e){this.iFramesObject&&this.iFramesObject.updateZoom(e)},e.prototype.makeDefaultPreventGesture=function(){s["default"].prototype.preventAllGesture()},e.prototype.clearEnrichmentTimeouts=function(){for(var e=0;e<this.setTimeoutIds.length;e++){var t=this.setTimeoutIds[e];clearTimeout(t)}this.setTimeoutIds=[],clearTimeout(this.crossnavAnimationTimer)},e.prototype.evalActions=function(e,t){new Function("_self","selfContainerID","with(_self){ "+e+" }")(this,t)},e.prototype.removeEventListeners=function(){for(var e=0,t=this.eventListeners.length;e<t;e++)this.eventListeners[e].element.removeEventListener(this.eventListeners[e].type,this.eventListeners[e].func,this.eventListeners[e].useCapture);this.eventListeners=[]},e.prototype.addToEventListeners=function(e,t,i,n){void 0===n&&(n=!1),e.addEventListener(i,t,n),this.eventListeners.push({element:e,type:i,func:t,useCapture:n})},e.prototype.reloadActionHistory=function(){for(var e=this.epubAnimationsHistory.length;e--;)this.epubAnimationsHistory[e].func(this.epubAnimationsHistory[e].args[0],this.epubAnimationsHistory[e].args[1]);this.epubAnimationsHistory=[]},e.prototype.registerInteractiveHandlers=function(){var e=this;this.registerButtonEventHandlers(),this.processAnimations(),this.processMediaGesture(),this.processIFrames(),this.processSliders(),this.crossnavAnimationTimer=setTimeout(function(){var t=e.config.isCrossNavPage(e.epubPage.pageNumber);t&&(e.spreadElement=e.element.closest(".webpub-viewer__epub-container-spread"),e.registerPublicationEventHandlers(),e.launchVisibleAnimations())},200)},e.prototype.processMediaGesture=function(){this.medias=this.element.querySelectorAll("video,audio"),0!==this.medias.length&&(this.mediasObject=new r.Medias(this.medias,this.config),this.mediasObject.start())},e.prototype.processIFrames=function(){this.iFrames=this.element.querySelectorAll("iframe"),0!==this.iFrames.length&&(this.iFramesObject=new o.IFrames(this.iFrames,this.config),this.iFramesObject.start())},e.prototype.processSliders=function(){if(this.sliders=this.element.querySelectorAll("[class*="+a.SLIDER_CLASSNAME+']:not([data-hidden="true"])'),0!==this.sliders.length){var e=w.Main.configsJsonManager.getPagesData(["sliders"]),t=e[this.epubPage.pageNumber-1];t&&t.sliders&&(this.slidersObject=new a.Sliders(this.sliders,t.sliders,this.epubPage.pageNumber))}},e.prototype.startGifs=function(){var e=this;this.gifs=this.gifs||this.element.querySelectorAll("img[src$='.gif']");for(var t=0,i=this.gifs.length;t<i;t++){var n=this.gifs[t];null===n.getAttribute("data-src")&&n.setAttribute("data-src",n.getAttribute("src")),n.src=u,function(t){e.createEnrichmentTimeout(function(){t.classList.add("gif-visible"),t.src=t.getAttribute("data-src")},0)}(n)}},e.prototype.createEnrichmentTimeout=function(e,t){var i=setTimeout(e,t);return this.setTimeoutIds.push(i),i},e.prototype.stopGifs=function(){this.gifs=this.gifs||this.element.querySelectorAll("img[src$='.gif']");for(var e=0,t=this.gifs.length;e<t;e++){var i=this.gifs[e];null===i.getAttribute("data-src")&&i.setAttribute("data-src",i.getAttribute("src")),i.src=u}},e.prototype.stopIFrames=function(){this.iFramesObject&&this.iFramesObject.stop()},e.prototype.stopMedias=function(){this.mediasObject&&this.mediasObject.stop()},e.prototype.stopSliders=function(){this.slidersObject&&this.slidersObject.stop()},e.prototype.processMedia=function(){for(var e,t,i,n=this.element.querySelectorAll("._idGenMedia"),s=0,o=n.length;s<o;s++)if(e=n[s].getAttribute("data-mediaOnPageLoadActions")){t=n[s].querySelectorAll("video,audio");for(var r=0,a=t.length;r<a;r++)t[r].paused&&(i=t[r],this.evalActions(e,i))}},e.prototype.processAnimations=function(){var e=this.element.querySelectorAll("._idGenAnimation");e.length>0&&(this.epubPage.pageContainsCPUElement=!0);for(var t,i,s,o=this.config.isCrossNavPage(this.epubPage.pageNumber),r=0;r<e.length;r++)t=e[r].getAttribute("data-animationOnPageLoadActions"),t&&(i=e[r],o?this.delayedAnimations.push({element:i,actions:t,trigger:{type:n.Scroll,scrollDistance:200}}):this.evalActions(t,i)),s=e[r].className,s.indexOf("_idGenCurrentState")!=-1&&(t=e[r].getAttribute("data-animationOnStateLoadActions"),t&&(i=e[r],this.evalActions(t,i))),t=e[r].getAttribute("data-animationOnSelfClickActions"),t&&(this.addToEventListeners(e[r],this.onTouchEndForAnimations.bind(this,e[r]),"touchend",!1),this.addToEventListeners(e[r],this.onMouseUpForAnimations.bind(this,e[r]),"mouseup",!1)),t=e[r].getAttribute("data-animationOnSelfRolloverActions"),t&&this.addToEventListeners(e[r],this.onMouseOverForAnimations.bind(this,e[r]),"mouseover",!1);this.addToEventListeners(this.element,this.onPageTouchEndForAnimations.bind(this,this.element),"touchend",!1),this.addToEventListeners(this.element,this.onPageMouseUpForAnimations.bind(this,this.element),"mouseup",!1)},e.prototype.onMediaChange=function(e,t){this.makeDefaultPreventGesture()},e.prototype.onPageTouchEndForAnimations=function(e,t){for(var i,n,s=this.element.querySelectorAll("._idGenAnimation"),o=0;o<s.length;o++)i=s[o].getAttribute("data-animationOnPageClickActions"),i&&(n=s[o],this.evalActions(i,n))},e.prototype.onPageMouseUpForAnimations=function(e,t){for(var i,n,s=this.element.querySelectorAll("._idGenAnimation"),o=0;o<s.length;o++)i=s[o].getAttribute("data-animationOnPageClickActions"),i&&(n=s[o],this.evalActions(i,n))},e.prototype.onTouchEndForAnimations=function(e,t){t.preventDefault();for(var i,n,s="."+e.getAttribute("data-animationObjectType"),o=this.element.querySelectorAll(s),r=0;r<o.length;r++)i=o[r].getAttribute("data-animationOnSelfClickActions"),i&&(n=o[r],this.evalActions(i,n))},e.prototype.onMouseUpForAnimations=function(e,t){for(var i,n,s="."+e.getAttribute("data-animationObjectType"),o=this.element.querySelectorAll(s),r=0;r<o.length;r++)i=o[r].getAttribute("data-animationOnSelfClickActions"),i&&(n=o[r],this.evalActions(i,n))},e.prototype.onMouseOverForAnimations=function(e,t){var i=e.getAttribute("data-idGenAnimationClass"),n=e.className;if(null===i||n.indexOf(i)==-1)for(var s,o,r="."+e.getAttribute("data-animationObjectType"),a=this.element.querySelectorAll(r),u=0;u<a.length;u++)s=a[u].getAttribute("data-animationOnSelfRolloverActions"),s&&(o=a[u],this.evalActions(s,o))},e.prototype.registerButtonEventHandlers=function(){for(var e=this.element.querySelectorAll("._idGenButton"),t=0;t<e.length;t++)this.addToEventListeners(e[t],this.onTouchStart.bind(this,e[t]),"touchstart",!1),this.addToEventListeners(e[t],this.onTouchEnd.bind(this,e[t]),"touchend",!1),this.addToEventListeners(e[t],this.onClick.bind(this,e[t]),"click",!1),this.addToEventListeners(e[t],this.onMouseUp.bind(this,e[t]),"mouseup",!1),this.addToEventListeners(e[t],this.onMouseOver.bind(this,e[t]),"mouseover",!1),this.addToEventListeners(e[t],this.onMouseOut.bind(this,e[t]),"mouseout",!1)},e.prototype.registerPublicationEventHandlers=function(){this.spreadElement.addEventListener("scroll",this.launchVisibleAnimations)},e.prototype.launchVisibleAnimations=function(){for(var e=this.spreadElement.scrollTop+this.spreadElement.clientHeight>=this.spreadElement.scrollHeight-1,t=0;t<this.delayedAnimations.length;t++){var i=this.delayedAnimations[t],n=i.element.getBoundingClientRect(),s=n.top<=window.innerHeight;(s||e)&&(this.evalActions(i.actions,i.element),this.delayedAnimations.splice(t,1),t--)}},e.prototype.hasAppearance=function(e,t){for(var i,n=e.children,s=0;s<n.length;s++)if(i=n[s].className,i.indexOf(t)!=-1)return!0;return!1},e.prototype.isDescendantOf=function(e,t){for(var i=e;i;){if(i==t)return!0;i=i.parentNode}return!1},e.prototype.addClass=function(t,i){if(null!==i&&t.classList.contains(i)!==!0){var n=e.getActionHistoryTemplate();n.func=this.removeClass.bind(this),n.args.push(t),n.args.push(i),this.epubAnimationsHistory.push(n),t.classList.add(i)}},e.prototype.removeClass=function(t,i){if(null!==i&&t.classList.contains(i)!==!1){var n=e.getActionHistoryTemplate();n.func=this.addClass.bind(this),n.args.push(t),n.args.push(i),this.epubAnimationsHistory.push(n),t.classList.remove(i)}},e.prototype.onClick=function(e,t){this.hasAppearance(e,"_idGen-Appearance-Click")&&this.addClass(e,"_idGenStateClick");var i=e.getAttribute("data-clickactions");i&&this.evalActions(i,null)},e.prototype.onMouseUp=function(e,t){this.removeClass(e,"_idGenStateClick");var i=e.getAttribute("data-releaseactions");i&&this.evalActions(i,null)},e.prototype.onMouseOver=function(e,t){if(!t.relatedTarget||!this.isDescendantOf(t.relatedTarget,e)){this.hasAppearance(e,"_idGen-Appearance-Rollover")&&this.addClass(e,"_idGenStateHover");var i=e.getAttribute("data-rolloveractions");i&&this.evalActions(i,null)}},e.prototype.onMouseOut=function(e,t){if(!t.relatedTarget||!this.isDescendantOf(t.relatedTarget,e)){this.removeClass(e,"_idGenStateHover"),this.removeClass(e,"_idGenStateClick");var i=e.getAttribute("data-rolloffactions");i&&this.evalActions(i,null)}},e.prototype.onTouchStart=function(e,t){t.preventDefault(),this.hasAppearance(e,"_idGen-Appearance-Click")&&this.addClass(e,"_idGenStateClick");var i=e.getAttribute("data-clickactions");i&&this.evalActions(i,null)},e.prototype.onTouchEnd=function(e,t){t.preventDefault(),this.removeClass(e,"_idGenStateClick");var i=e.getAttribute("data-releaseactions");i&&this.evalActions(i,null)},e.prototype.onHide=function(e){var t=this.element.querySelector("#"+e);null!==t&&(this.handleMSOStateParentOfObject(t),this.addClass(t,"_idGenStateHide"))},e.prototype.onShow=function(e){var t=this.element.querySelector("#"+e);null!==t&&(this.handleMSOStateParentOfObject(t),this.removeClass(t,"_idGenStateHide"))},e.prototype.handleMSOStateParentOfObject=function(e){for(var t,i,n=e,s=n.parentNode;null!==s&&!t;)i=s.className,i&&i.indexOf("_idGenMSO")!=-1?t=!0:n=s,s=n.parentNode;if(t)for(var o=n,r=s.children,a=0,u=void 0;u=r[a];a++){var l=u.className.indexOf("_idGenCurrentState")!=-1;if(l&&u!==o)return this.handleMediaInMSOState(u,!1),this.removeClass(u,"_idGenCurrentState"),this.addClass(u,"_idGenStateHide"),this.handleMediaInMSOState(o,!0),this.removeClass(o,"_idGenStateHide"),void this.addClass(o,"_idGenCurrentState")}},e.prototype.goToDestination=function(e){if(e=e.trim(),0===e.indexOf("http"))return void webpublicationNamespace.EpubDomApi("url",[null,e]);if(0===e.indexOf("javascript")||0===e.indexOf("js:")||0===e.indexOf("js :"))return void webpublicationNamespace.EpubDomApi("javascript",[null,e]);if(0===e.indexOf("NIApi"))return void webpublicationNamespace.EpubDomApi("NIApi",[null,e]);var t=/-([0-9]*).xhtml$/gim,i=t.exec(e)||[];i.length>0&&this.callIfClickAuthorized(function(){return webpublicationNamespace.EpubDomApi("gotoPage",[null,~~i[1]])})},e.prototype.callIfClickAuthorized=function(e){var t=4;w.epubEvent.fire({type:t,data:{override:!0,action:function(t){t.then(function(t){t&&e()})}}})},e.prototype.handleMediaInMSOState=function(e,t){for(var i,n,s=e.getElementsByTagName("*"),o=0;o<s.length;o++)i=s[o],n=i.tagName.toLowerCase(),"video"!=n&&"audio"!=n||(t?i.play():i.pause())},e.prototype.handleAnimationInMSOState=function(e){var t,i,n,s,o=e.className;o.indexOf("_idGenAnimation")!=-1&&(t=e.getAttribute("data-idGenAnimationStartState"),i=e.getAttribute("data-idGenAnimationEndState"),this.removeClass(e,i),this.addClass(e,t),n=e.getAttribute("data-animationOnStateLoadActions"),n&&(s=e.id,this.evalActions(n,s)));for(var r,a=e.getElementsByTagName("*"),u=0;u<a.length;u++)r=a[u],o=r.className,o.indexOf("_idGenAnimation")!=-1&&(t=e.getAttribute("data-idGenAnimationStartState"),i=e.getAttribute("data-idGenAnimationEndState"),this.removeClass(e,i),this.addClass(e,t),n=r.getAttribute("data-animationOnStateLoadActions"),n&&(s=r.id,this.evalActions(n,s)))},e.prototype.goToNextState=function(e,t,i){var n=this;this.makeDefaultPreventGesture(),this.createEnrichmentTimeout(function(){n.goToNextStateWrapper(e,t)},1e3*i)},e.prototype.goToNextStateWrapper=function(e,t){var i,n,s,o=this.element.querySelector("#"+e);if(null!==o){this.removeClass(o,"_idGenStateHide"),i=o.children;for(var r=0,a=void 0;a=i[r];r++)if(n=a.className,n.indexOf("_idGenCurrentState")!=-1)return s=t?r==i.length-1?i[0]:i[r+1]:r==i.length-1?i[r]:i[r+1],this.handleMediaInMSOState(a,!1),this.removeClass(a,"_idGenCurrentState"),this.addClass(a,"_idGenStateHide"),this.handleMediaInMSOState(s,!0),this.removeClass(s,"_idGenStateHide"),this.addClass(s,"_idGenCurrentState"),void this.handleAnimationInMSOState(s)}},e.prototype.goToPreviousState=function(e,t,i){var n=this;this.makeDefaultPreventGesture(),this.createEnrichmentTimeout(function(){n.goToPreviousStateWrapper(e,t)},1e3*i)},e.prototype.goToPreviousStateWrapper=function(e,t){var i,n,s,o=document.getElementById(e);if(o){this.removeClass(o,"_idGenStateHide"),i=o.children;for(var r=0,a=void 0;a=i[r];r++)if(n=a.className,n.indexOf("_idGenCurrentState")!=-1)return s=t?0==r?i[i.length-1]:i[r-1]:0==r?i[0]:i[r-1],this.handleMediaInMSOState(a,!1),this.removeClass(a,"_idGenCurrentState"),this.addClass(a,"_idGenStateHide"),this.handleMediaInMSOState(s,!0),this.removeClass(s,"_idGenStateHide"),this.addClass(s,"_idGenCurrentState"),void this.handleAnimationInMSOState(s)}},e.prototype.playAnimation=function(e,t,i,n){this.addAnimationToAnimationMap(!1,e,t,i,n)},e.prototype.reverseAnimation=function(e,t,i){this.addAnimationToAnimationMap(!0,e,t,i,"")},e.prototype.pauseAnimation=function(e,t){var i=this.getIdByAnimationId(e),n=this.pendingAnimationMap[i];if(n){for(var s=0;s<n.length;s++)clearTimeout(n[s]);delete this.pendingAnimationMap[i]}},e.prototype.goToState=function(e,t,i,n){var s=document.getElementById(e);if(s)for(var o=s.children,r=0;r<o.length;r++){var a=o[r],u=a.getAttribute("data-idgenobjectstate");u===t?(this.handleMediaInMSOState(a,!0),this.removeClass(a,"_idGenStateHide"),this.addClass(a,"_idGenCurrentState"),this.handleAnimationInMSOState(a)):(this.handleMediaInMSOState(a,!1),this.removeClass(a,"_idGenCurrentState"),this.addClass(a,"_idGenStateHide"))}},e.prototype.addAnimationToAnimationMap=function(e,t,i,n,s){var o=this,r=this.getIdByAnimationId(t),a=this.createEnrichmentTimeout(function(){var u=o.pendingAnimationMap[r].indexOf(a);o.pendingAnimationMap[r].splice(u,1),o.executeAnimation(e,t,i,n,s)},p);this.pendingAnimationMap[r]=this.pendingAnimationMap[r]||[],this.pendingAnimationMap[r].push(a)},e.prototype.getElementByAnimationId=function(e){return"object"==typeof e?e:this.element.querySelector("#"+e)},e.prototype.getIdByAnimationId=function(e){return"object"==typeof e?e.id:e},e.prototype.animateElement=function(e,t,i,n){var s=this;this.removeClass(t,"_idGenStateHide"),this.removeClass(t,"_idGenPauseAnimation");var o=t.className,r=t.getAttribute("data-idGenAnimationClass");o.indexOf(i)==-1&&o.indexOf(r)==-1?(this.addClass(t,i),t.setAttribute("data-idGenAnimationClass",i)):(this.removeClass(t,i),this.removeClass(t,r),t.removeEventListener("webkitAnimationEnd",function(i){s.onAnimationEnd(e,t,n,i)}),t.removeEventListener("animationend",function(i){s.onAnimationEnd(e,t,n,i)}),setTimeout(function(){s.addClass(t,i)},10),t.setAttribute("data-idGenAnimationClass",i)),this.addToEventListeners(t,this.onAnimationEnd.bind(this,e,t,n),"webkitAnimationEnd"),this.addToEventListeners(t,this.onAnimationEnd.bind(this,e,t,n),"animationend")},e.prototype.executeAnimation=function(e,t,i,n,s){var o=this,r=this.getElementByAnimationId(t);if(r){this.handleMSOStateParentOfObject(r);var a=r.getAttribute("data-idGenAnimationStartState"),u=r.getAttribute("data-idGenAnimationEndState"),l=r.classList.contains("_idGenStateHide");l&&!r.hasAttribute("data-initially-hidden")&&r.setAttribute("data-initially-hidden","true"),this.removeClass(r,e?a:u),this.addClass(r,e?u:a),this.createEnrichmentTimeout(function(){o.animateElement(e,r,i,s)},1e3*n)}},e.prototype.onAnimationEnd=function(e,t,i,n){var s=t.getAttribute("data-idGenAnimationClass"),o=t.getAttribute("data-idGenAnimationStartState"),r=t.getAttribute("data-idGenAnimationEndState");this.removeClass(t,s),this.removeClass(t,e?r:o);var a=e?o:r;this.addFinishCssClass(t,a),i&&this.addClass(t,"_idGenStateHide"),n.stopPropagation()},e.prototype.addFinishCssClass=function(e,t){var i=this;"safari"===w.Param.userAgent.browser.name&&12===w.Param.userAgent.browser.version?setTimeout(function(){i.addClass(e,t)},0):this.addClass(e,t)},e}();i["default"]=h},{"./EpubGesturesEvent":9,"./EpubPageEnrichment/IFrames":48,"./EpubPageEnrichment/Medias":50,"./EpubPageEnrichment/Sliders":53}],47:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../EpubPage/shapes/utils/IframeInteractions"),s=e("../utils/enums"),o=e("../utils/youtube"),r=function(){function e(e,t){this.iFrame=e,this.config=t,this.init()}return e.prototype.init=function(){this.element=this.iFrame.parentElement,this.iFrame.style.pointerEvents="none",this.iFrame.dataset.foreground="true",this.iFrame.contentEditable="true",this.iframeInteractions=new n.IframeInteractions(this,this.config,this.iFrame,this.element,(!0)),this.iFrame.addEventListener("load",this.onLoad.bind(this))},e.prototype.onLoad=function(){try{this.iFrameContentWindow=this.iFrame.contentWindow;var e="object"==typeof this.iFrameContentWindow.AdobeAn;if(e)return void this.iframeInteractions.init(this.iFrameContentWindow);this.config.readerPageSrcType===s.READER_TYPES.EPUB_HTML&&this.preventZoomConflict()}catch(t){this.preventZoomConflict()}},e.prototype.preventZoomConflict=function(){this.iFrame.style.pointerEvents="all",this.iframeInteractions.setPreventZoomInteraction(this.iFrameContentWindow)},e.prototype.start=function(){var e=this.iFrame.dataset.src;!this.iFrame.src&&e&&(this.iFrame.src=o.getCorrectYoutubeDomain(e))},e.prototype.stop=function(){this.iFrame.src="",this.iframeInteractions.flush()},e.prototype.updateZoom=function(e){if(!this.iFrame.style.width&&!this.iFrame.style.height){var t=window.getComputedStyle(this.iFrame);this.iFrame.style.width=t.getPropertyValue("width"),this.iFrame.style.height=t.getPropertyValue("height")}this.iFrame.parentElement&&(this.iFrame.style.zoom=""+1/e,this.iFrame.parentElement.style.transform="scale("+e+")",this.iFrame.parentElement.style.transformOrigin="0 0")},e}();i.IFrame=r},{"../EpubPage/shapes/utils/IframeInteractions":30,"../utils/enums":84,"../utils/youtube":87}],48:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./IFrame"),s=function(){function e(e,t){this.htmlIframes=e,this.config=t,this.iFrames=[],this.init()}return e.prototype.init=function(){for(var e=0,t=this.htmlIframes.length;e<t;e++)this.iFrames.push(new n.IFrame(this.htmlIframes[e],this.config))},e.prototype.start=function(){for(var e=0,t=this.iFrames.length;e<t;e++)this.iFrames[e].start()},e.prototype.stop=function(){for(var e=0,t=this.iFrames.length;e<t;e++)this.iFrames[e].stop()},e.prototype.updateZoom=function(e){this.iFrames.forEach(function(t){return t.updateZoom(e)})},e}();i.IFrames=s},{"./IFrame":47}],49:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{
value:!0});var n=e("../EpubGesturesEvent"),s=function(){function e(e,t){this.media=e,this.config=t,this.foreground=!0,this.startableAsyncDate=0,this.status={start:!1},this.init()}return e.prototype.init=function(){this._onMediaChange=this.onMediaChange.bind(this),this.media.setAttribute("controlsList","nodownload"),this.media.addEventListener("volumechange",this._onMediaChange,!0),this.media.addEventListener("seeking",this._onMediaChange,!0)},e.prototype.onMediaChange=function(){n["default"].prototype.preventAllGesture()},e.prototype.onScroll=function(){this.startableAsync()},e.prototype.startableAsync=function(){var e=this;return clearTimeout(this.startableAsyncTimer),Date.now()-this.startableAsyncDate>1e3?(this.startableAsyncDate=Date.now(),void this.startable()):void(this.startableAsyncTimer=setTimeout(function(){e.startableAsyncDate=Date.now(),e.startable()},100))},e.prototype.startable=function(){if(this.status.start===!1)return void this.media.pause();var e=this.media.hasAttribute("autoplay")&&"false"!==this.media.getAttribute("autoplay"),t=this.media.dataset.ignoreAutoplay;e&&!t&&this.media.play()},e.prototype.start=function(){this.status.start=!0,this.startableAsync()},e.prototype.stop=function(){this.media.removeEventListener("volumechange",this._onMediaChange,!0),this.media.removeEventListener("seeking",this._onMediaChange,!0),this.status.start=!1,this.media.pause()},e}();i.Media=s},{"../EpubGesturesEvent":9}],50:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Media"),s=function(){function e(e,t){this.htmlMedias=e,this.config=t,this.medias=[],this.init()}return e.prototype.init=function(){for(var e=0,t=this.htmlMedias.length;e<t;e++)this.medias.push(new n.Media(this.htmlMedias[e],this.config))},e.prototype.start=function(){for(var e=0,t=this.medias.length;e<t;e++)this.medias[e].start()},e.prototype.stop=function(){for(var e=0,t=this.medias.length;e<t;e++)this.medias[e].stop()},e}();i.Medias=s},{"./Media":49}],51:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=5,s=11,o=3,r={LEVEL_1:1,LEVEL_2:.83,LEVEL_3:.66},a=function(){function e(e,t,i){this.sliderElement=e,this.slidesLength=t,this.prevSlideIndex=i,this.init(),this.update(i)}return e.prototype.init=function(){for(var e=this.sliderElement.querySelector(".webpublication-pswp__dots-line"),t=0;t<this.slidesLength;t++){var i=document.createElement("span");0===t&&i.classList.add("is-active"),this.slidesLength>n?(3===t&&(i.style.transform="scale("+r.LEVEL_2+")"),t>3&&(i.style.transform="scale("+r.LEVEL_3+")")):e.classList.add("is-static"),e.appendChild(i)}},e.prototype.updateActiveDot=function(e){for(var t=[].slice.call(this.sliderElement.querySelectorAll(".webpublication-pswp__dots span")),i=0;i<t.length;i++)t[i].classList.toggle("is-active",i===e)},e.prototype.updateDotsLine=function(e){var t=this.sliderElement.querySelector(".webpublication-pswp__dots-line"),i=e<3,o=e>this.slidesLength-3,r=e===this.slidesLength-1&&0===this.prevSlideIndex;if(i&&(t.style.transform="translateX(0)"),!i&&!o){var a=(e-2)*s;t.style.transform="translateX("+-a+"px)"}if(r||o){var a=(this.slidesLength-n)*s;t.style.transform="translateX("+-a+"px)"}this.prevSlideIndex=e},e.prototype.updateDotsScale=function(e){for(var t=[].slice.call(this.sliderElement.querySelectorAll(".webpublication-pswp__dots span")),i=0;i<t.length;i++)t[i].style.transform="scale("+r.LEVEL_3+")";var n=e<o,s=e>=this.slidesLength-o;if(n){for(var i=0;i<o;i++)t[i].style.transform="scale("+r.LEVEL_1+")";t[o].style.transform="scale("+r.LEVEL_2+")"}else if(s){for(var i=this.slidesLength-1;i>this.slidesLength-1-o;i--)t[i].style.transform="scale("+r.LEVEL_1+")";t[this.slidesLength-1-o].style.transform="scale("+r.LEVEL_2+")"}else t[e].style.transform="scale("+r.LEVEL_1+")",t[e-1].style.transform="scale("+r.LEVEL_1+")",t[e+1].style.transform="scale("+r.LEVEL_1+")",t[e-2].style.transform="scale("+r.LEVEL_2+")",t[e+2].style.transform="scale("+r.LEVEL_2+")"},e.prototype.update=function(e){this.updateActiveDot(e),this.slidesLength>n&&(this.updateDotsLine(e),this.updateDotsScale(e))},e}();i.Pagination=a},{}],52:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./Pagination"),o=e("../../utils/youtube"),r=e("../../utils/isTouchSupported");!function(e){e.IMAGE="IMAGE",e.MOVIE="MOVIE"}(n||(n={}));var a;!function(e){e.IFRAME="IFRAME",e.VIDEO="VIDEO"}(a||(a={}));var u=function(){function e(e,t,i,n){this.fakeFullscreenElementId="webpublication-pswp-fake-fullscreen",this.options={index:0,loop:!0,closeEl:!1,closeOnScroll:!1,closeOnVerticalDrag:!1,pinchToClose:!1,tapToClose:!1,clickToCloseNonZoomable:!1,closeElClasses:[],escKey:!1,zoomEl:!1,counterEl:!1,arrowEl:!1,captionEl:!1,fullscreenEl:!1,shareEl:!1,preloaderEl:!1,history:!1,barsSize:{top:0,bottom:0},timeToIdle:2e3,getDoubleTapZoom:void 0,arrowKeys:!1,isClickableElement:function(e){return"VIDEO"===e.tagName}},this.handleBeforeSlideChange=this.handleBeforeSlideChange.bind(this),this.handleAfterSlideChange=this.handleAfterSlideChange.bind(this),this.handleSliderResize=this.handleSliderResize.bind(this),this.handleSliderDestroy=this.handleSliderDestroy.bind(this),this.handleFullscreenChange=this.handleFullscreenChange.bind(this),this.closeFakeFullscreen=this.closeFakeFullscreen.bind(this),this.handleCloseFullscreenButtonClick=this.handleCloseFullscreenButtonClick.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.pageNumber=n,this.hasFullscreen=w.Main.fullScreenManager.hasFullScreen(),this.parentElement=e,this.data=t,this.className=i,this.addSpreadWrapperStyleObserver(),this.init(e,t)}return e.prototype.init=function(e,t,i){var n=this,s=this.getPageWrapper();if(!s)return this.addContainerSubtreeObserver(function(){n.init(e,t,i),n.observeSpreadWrapperStyle()});this.observeSpreadWrapperStyle(),e.innerHTML=this.getTemplate(),this.sliderElement=e.querySelector(".pswp");var o=this.getSlides(t);void 0!==i&&(this.options.index=i),this.slider=new PhotoSwipe(this.sliderElement,PhotoSwipeUI_Default,o,this.options),this.slider.init(),this.initControls();var r=this.slider.currItem.videoType;r&&this.handleVideos(),this.slider.listen("beforeChange",this.handleBeforeSlideChange),this.slider.listen("afterChange",this.handleAfterSlideChange),this.slider.listen("resize",this.handleSliderResize),this.slider.listen("destroy",this.handleSliderDestroy),this.stopSwipeEventsPropogation()},e.prototype.initSlidesController=function(){var e=this.sliderElement.querySelector(".pswp__top-bar"),t=1===this.slider.items.length;t&&e.classList.add("no-controls");var i="desktop"===w.Param.userAgent.device.type,n=!t&&i;n&&e.classList.add("has-arrows"),this.setSlidesControllerSize(),this.pagination=new s.Pagination(this.sliderElement,this.slider.items.length,this.slider.getCurrentIndex())},e.prototype.initControls=function(){var e=this;this.initSlidesController();var t=this.sliderElement.querySelector(".webpublication-pswp__arrow.is-prev"),i=this.sliderElement.querySelector(".webpublication-pswp__arrow.is-next");t.addEventListener("click",function(){return e.slider.prev()}),i.addEventListener("click",function(){return e.slider.next()});var n=[].slice.call(this.sliderElement.querySelectorAll(".pswp__item"));n.forEach(function(t){t.addEventListener("click",function(t){if(!e.slider.isMainScrollAnimating())return e.hasFullscreen||e.isFakeFullscreenOpened?void(e.isSliderInFullscreen()||t.target.classList.contains("pswp__img")&&(e.isDocumentInFullscreen()?(e.exitFullscreen(),setTimeout(function(){e.requestSliderFullscreen()},1e3)):e.requestSliderFullscreen())):void e.openFakeFullscreen()})})},e.prototype.setSlidesControllerSize=function(){var e=this.sliderElement.querySelector(".webpublication-pswp__arrow.is-prev"),t=this.sliderElement.querySelector(".webpublication-pswp__arrow.is-next"),i=this.sliderElement.querySelector(".webpublication-pswp__dots");if(this.isSliderInFullscreen())return e.style.transform="",t.style.transform="",void(i.style.transform="");var n=this.getSpreadWrapper();if(n){var s=+n.style.transform.replace("matrix(","").split(",")[0];e.style.transform="scale("+1/s+")",t.style.transform="scale("+1/s+")",i.style.transform="translateX(-50%) scale("+1/s+")"}},e.prototype.openFakeFullscreen=function(){this.isFakeFullscreenOpened=!0;var e=document.createElement("div");e.id=this.fakeFullscreenElementId;var t=this.slider.currItem.videoType;t&&e.classList.add("is-video-slide"),document.body.appendChild(e),this.slider.close(),this.init(e,this.data,this.slider.getCurrentIndex());var i=this.sliderElement.querySelector(".webpublication-pswp__button.is-close");i.classList.remove("display-none"),i.addEventListener("click",this.closeFakeFullscreen),this.slider.options.getDoubleTapZoom=function(){return 1},this.slider.options.arrowKeys=!0,document.addEventListener("keyup",this.handleKeyUp)},e.prototype.closeFakeFullscreen=function(){this.isFakeFullscreenOpened=!1;var e=document.querySelector("#"+this.fakeFullscreenElementId);document.body.removeChild(e);var t=this.sliderElement.querySelector(".webpublication-pswp__button.is-close");t.classList.add("display-none"),t.removeEventListener("click",this.closeFakeFullscreen),document.removeEventListener("keyup",this.handleKeyUp),this.slider.close(),this.init(this.parentElement,this.data,this.slider.getCurrentIndex())},e.prototype.getFullScreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement},e.prototype.isDocumentInFullscreen=function(){var e=this.getFullScreenElement();return!!e&&e===document.documentElement},e.prototype.isSliderInFullscreen=function(){var e=this.getFullScreenElement();return!!e&&e===this.sliderElement||this.isFakeFullscreenOpened},e.prototype.requestSliderFullscreen=function(){this.sliderElement.requestFullscreen?this.sliderElement.requestFullscreen():this.sliderElement.webkitRequestFullscreen?this.sliderElement.webkitRequestFullscreen():this.sliderElement.msRequestFullscreen&&this.sliderElement.msRequestFullscreen(),document.addEventListener(this.getFullscreenChangeEventName(),this.handleFullscreenChange)},e.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},e.prototype.handleFullscreenChange=function(){this.slider.updateSize(!0)},e.prototype.getTemplate=function(){return'\n\t\t\t<div class="pswp">\n\t\t\t\t<div class="pswp__bg"></div>\n\t\t\t\t<div class="pswp__scroll-wrap">\n\t\t\t\t\t<div class="pswp__container">\n\t\t\t\t\t\t<div class="pswp__item"></div>\n\t\t\t\t\t\t<div class="pswp__item"></div>\n\t\t\t\t\t\t<div class="pswp__item"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="pswp__ui pswp__ui--hidden">\n\t\t\t\t\t\t<div class="pswp__top-bar">\n\t\t\t\t\t\t\t<button type="button" class="webpublication-pswp__arrow is-prev">\n\t\t\t\t\t\t\t\t<div class="svgicon-new svgicon-back-v4">\n\t\t\t\t\t\t\t\t\t<svg data-icon="back-v4">\n\t\t\t\t\t\t\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svgicon-back-v4"></use>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="button" class="webpublication-pswp__arrow is-next">\n\t\t\t\t\t\t\t\t<div class="svgicon-new svgicon-back-v4">\n\t\t\t\t\t\t\t\t\t<svg data-icon="back-v4">\n\t\t\t\t\t\t\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svgicon-back-v4"></use>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<div class="webpublication-pswp__dots">\n\t\t\t\t\t\t\t\t<div class="webpublication-pswp__dots-line"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button type="button" class="webpublication-pswp__button is-close display-none">\n\t\t\t\t\t\t\t<div class="svgicon-new svgicon-close">\n\t\t\t\t\t\t\t\t<svg data-icon="close">\n\t\t\t\t\t\t\t\t\t<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svgicon-close"></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'},e.prototype.getSlides=function(e){var t=this;return e.map(function(e,i){var s=e.isExternalLink,o=e.relUrl,r=e.externalRelUrl,a=e.type,u=e.resolution,l=e.label,p=s?r:w.Utils.resolveVariable("${media}"+o.replace(/^\/?\d+\//g,""));return a===n.MOVIE||s?t.getVideoSlide(p,l,i,s):t.getImageSlide(p,u)})},e.prototype.getImageSlide=function(e,t){var i=[1920,1080],n=t?t.split("x"):i,s=n[0],o=n[1];return{src:e,w:+s,h:+o}},e.prototype.getVideoSlide=function(e,t,i,n){var s='\n\t\t\t<iframe\n\t\t\t\tid="'+this.className+"-"+i+'-frame"\n\t\t\t\tsrc="'+o.getCorrectYoutubeDomain(e)+'?enablejsapi=1"\n\t\t\t\twidth="100%"\n\t\t\t\theight="100%"\n\t\t\t\tframeBorder="0"\n\t\t\t\tallowFullscreen\n\t\t\t/>\n\t\t',r='\n\t\t\t<video\n\t\t\t\tcontrols\n\t\t\t\tplaysinline\n\t\t\t\tdata-label="'+t+'"\n\t\t\t\tstyle="width:100%;height:100%"\n\t\t\t>\n\t\t\t\t<source src="'+e+'" />\n\t\t\t</video>\n\t\t';return{html:n?s:r,videoType:n?a.IFRAME:a.VIDEO}},e.prototype.handleBeforeSlideChange=function(){if(r.isTouchSupported()){var e=this.slider.currItem.videoType,t=this.sliderElement.querySelector(".pswp__top-bar");t.classList.toggle("is-video-slide",!!e)}if(this.pagination.update(this.slider.getCurrentIndex()),this.stopVideos(),this.isFakeFullscreenOpened){var e=this.slider.currItem.videoType,i=document.querySelector("#"+this.fakeFullscreenElementId);i.classList.toggle("is-video-slide",!!e)}},e.prototype.handleAfterSlideChange=function(){var e=this.slider.currItem.videoType;e&&this.handleVideos()},e.prototype.addContainerSubtreeObserver=function(e){var t=this.getContainerElement();if(t){var i=new MutationObserver(function(){e(),i.disconnect()});i.observe(t,{childList:!0,subtree:!0})}},e.prototype.addSpreadWrapperStyleObserver=function(){var e=this;this.spreadWrapperStyleObserver=new MutationObserver(function(){e.setSlidesControllerSize()})},e.prototype.observeSpreadWrapperStyle=function(){var e=this.getSpreadWrapper();e&&this.spreadWrapperStyleObserver.observe(e,{attributes:!0,attributeFilter:["style"]})},e.prototype.getContainerElement=function(){return document.querySelector(".webpub-viewer__epub-container")},e.prototype.getPageWrapper=function(){return document.querySelector(".webpub-viewer__epub-container-spread-zoomable [class*=spread-page-"+this.pageNumber+"]")},e.prototype.getSpreadWrapper=function(){var e=this.getPageWrapper();return e?e.closest(".spread-is-visible .webpub-viewer__epub-container-spread-zoomable"):null},e.prototype.handleSliderResize=function(){var e=this;this.setSlidesControllerSize(),this.isSliderInFullscreen()||(this.addContainerSubtreeObserver(function(){return e.observeSpreadWrapperStyle()}),this.observeSpreadWrapperStyle());var t=w.Param.userAgent.os.name===w.Param.userAgent.OS.MAC,i=w.Param.userAgent.os.name===w.Param.userAgent.OS.ANDROID,n=w.Param.userAgent.os.name===w.Param.userAgent.OS.WINDOWS,s=t||i||n&&w.Param.isApp,o=this.sliderElement.querySelector(".webpublication-pswp__button.is-close");this.isSliderInFullscreen()?(w.Param.viewHtml.classList.add("is-slider-full-screen"),this.slider.options.getDoubleTapZoom=function(){return 1},this.slider.options.arrowKeys=!0,document.addEventListener("keyup",this.handleKeyUp),s&&(o.classList.remove("display-none"),o.addEventListener("click",this.handleCloseFullscreenButtonClick))):(w.Param.viewHtml.classList.remove("is-slider-full-screen"),this.slider.options.getDoubleTapZoom=void 0,this.slider.options.arrowKeys=!1,document.removeEventListener("keyup",this.handleKeyUp),document.removeEventListener(this.getFullscreenChangeEventName(),this.handleFullscreenChange),s&&(o.classList.add("display-none"),o.removeEventListener("click",this.handleCloseFullscreenButtonClick)))},e.prototype.handleCloseFullscreenButtonClick=function(){this.exitFullscreen()},e.prototype.handleSliderDestroy=function(){this.spreadWrapperStyleObserver.disconnect()},e.prototype.getFullscreenChangeEventName=function(){return void 0!==document.onfullscreenchange?"fullscreenchange":void 0!==document.onwebkitfullscreenchange?"webkitfullscreenchange":void 0!==document.onmsfullscreenchange?"MSFullscreenChange":"fullscreenchange"},e.prototype.stopSwipeEventsPropogation=function(){var e=this,t=["touchstart","touchmove","mousewheel","wheel","DOMMouseScroll"],i=function(e){return e.stopPropagation()};t.forEach(function(t){e.sliderElement.addEventListener(t,i)})},e.prototype.handleKeyUp=function(e){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&e.stopPropagation()},e.prototype.handleVideos=function(){var e=this.slider.currItem,t=e.videoType,i=e.container;if(t===a.VIDEO){var n=i.querySelector("video");w.Utils.addVideoStats(n),w.Param.userAgent.browser.name===w.Param.userAgent.BROWSER.SAFARI&&(n.setAttribute("autoplay",""),n.pause())}},e.prototype.stopVideos=function(){var e=[].slice.call(this.sliderElement.querySelectorAll("video, iframe"));e.forEach(function(e){e instanceof HTMLVideoElement&&e.pause(),e instanceof HTMLIFrameElement&&e.contentWindow&&e.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*")})},e.prototype.stop=function(){this.stopVideos(),this.slider.close()},e}();i.Slider=u},{"../../utils/isTouchSupported":86,"../../utils/youtube":87,"./Pagination":51}],53:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./Slider/index"),s="plugin-slider";i.SLIDER_CLASSNAME=s;var o=function(){function e(e,t,i){this.htmlSliders=e,this.data=t,this.sliders=[],this.init(i)}return e.prototype.init=function(e){for(var t=0,i=this.htmlSliders.length;t<i;t++){var o=[].slice.call(this.htmlSliders[t].classList),r=o.find(function(e){return e.includes(s)});if(r){var a=this.data[r];a&&a.length>0&&this.sliders.push(new n.Slider(this.htmlSliders[t],a,r,e))}}},e.prototype.stop=function(){for(var e=0,t=this.sliders.length;e<t;e++)this.sliders[e].stop()},e}();i.Sliders=o},{"./Slider/index":52}],54:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubPage"),s=e("./utils/enums"),o=function(){function e(e,t,i){this.epubSpreads=e,this.config=t,this.epubCssManager=i,this.currentPage=0,this.pageQuantity=0,this.imagesMdpi=s.PagesImagesQualities[s.PagesImagesQualities.mdpi],this.imagesHdpi=s.PagesImagesQualities[s.PagesImagesQualities.hdpi],this.parent=this.epubSpreads,this.currentPage=this.config.currentPage,this.pageQuantity=this.config.pageQuantity,this.setPagesObject()}return Object.defineProperty(e.prototype,"readerPageSrcType",{get:function(){return this.config.readerPageSrcType},enumerable:!0,configurable:!0}),e.prototype.setPagesQty=function(){this.epubPages=new Array(this.pageQuantity),this.epubPagesRequested=new Array(this.pageQuantity)},e.prototype.setPageObject=function(e,t){return this.readerPageSrcType===s.READER_TYPES.EPUB_HTML?void(e.src=w.Main.pageManager.getEpubHtml(t)):this.readerPageSrcType===s.READER_TYPES.PDF_HTML?void(e.src=w.Main.pageManager.getPdfHtml(t)):this.readerPageSrcType===s.READER_TYPES.PDF_SVG?void(e.src=w.Main.pageManager.getSvg(t)):this.readerPageSrcType===s.READER_TYPES.PDF_IMG?(e.srcHdpi=w.Main.pageManager.getImage(this.imagesHdpi,t),void(e.src=w.Main.pageManager.getImage(this.imagesMdpi,t))):this.readerPageSrcType===s.READER_TYPES.PDF_PDF?void(e.src=w.Main.pageManager.getPdf(t)):void 0},e.prototype.setPagesObject=function(){this.setPagesQty();for(var e=0;e<this.pageQuantity;e++)this.epubPages[e]=new n["default"](this,this.config,e+1,this.epubCssManager),this.setPageObject(this.epubPages[e],e+1)},e.prototype.pageExist=function(e){return"undefined"!=typeof this.epubPages[e]},e.prototype.pageGetForSpread=function(e){return this.epubPagesRequested[e]=!0,this.epubPages[e]},e.prototype.pageGet=function(e){return this.epubPages[e]},e.prototype.resetRequested=function(){for(var e=0,t=this.pageQuantity;e<t;e++)this.epubPagesRequested[e]=!1},e.prototype.flushNotRequested=function(){for(var e=0,t=this.pageQuantity;e<t;e++)this.epubPagesRequested[e]===!1&&this.epubPages[e].flush()},e}();i["default"]=o},{"./EpubPage":16,"./utils/enums":84}],55:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t,i){this.epubScrollables=e,this.config=t,this.epubSpread=i,this.x=0,this.y=0,this.parent=this.epubScrollables,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize}return e}();i["default"]=n},{}],56:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubScrollable"),s=e("./EpubGesturesEvent"),o=e("./EpubEvent"),r=e("./EpubConfig/EpubDefaultConfig"),a=400;i.EVENT_FORCE_CHECK_LAST_ACTION="forceCheckLastAction";var u=function(){function e(e,t,n){this.epubSpreads=e,this.config=t,this.mainViewElement=n,this.scrollablesLength=0,this.xStart=0,this.yStart=0,this.x=0,this.y=0,this.tapeGestureDate=0,this.epubEvent=w.epubEvent,this.parent=this.epubSpreads,this.screenSize=this.epubSpreads.screenSize,this.mainViewElementSize=this.epubSpreads.mainViewElementSize,this.element=n,this.scrollables=[],this.permissionTapList=[],this.epubGesturesEvent=new s["default"](this,this.element),this.spreadDraggable&&(this.epubGesturesEvent.addEventListener(s["default"].GESTURESNAME.SWIPEGESTURE,this.trySwip.bind(this)),this.epubGesturesEvent.addEventListener(s["default"].GESTURESNAME.PANGESTURE,this.tryDrag.bind(this)),this.epubGesturesEvent.addEventListener(s["default"].GESTURESNAME.MOUSEWHEELGESTURE,this.onMouseWheel.bind(this))),this.epubGesturesEvent.addEventListener(s["default"].GESTURESNAME.TAPGESTURE,this.checkLastActionForTapGesture.bind(this)),document.addEventListener(i.EVENT_FORCE_CHECK_LAST_ACTION,this.checkLastActionForTapGesture.bind(this)),this.epubEvent.addListener(o.EPUB_EVENTS.PAGE_CLICK_PERMISSION,this.permissionTapEvent.bind(this)),this.setEnableScrollElement()}return e.prototype.setEnableScrollElement=function(){this.epubGesturesEvent.setEnableScrollElement(this.config.hasCrossNavPage())},Object.defineProperty(e.prototype,"spreadDraggable",{get:function(){return this.config.spreadDraggable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationAxis",{get:function(){return this.config.navigationAxis},enumerable:!0,configurable:!0}),e.prototype.onMouseWheel=function(t){var i=Date.now(),n=0;this.navigationAxis===r.NavigationAxis.X&&t.gestureData.wheel.isX?n=t.deltaX:this.navigationAxis===r.NavigationAxis.Y&&t.gestureData.wheel.isY&&(n=t.deltaY),n>0?n=1:n<0&&(n=-1),e.mouseWheelLastDelta=n,e.mouseWheelLast=i,n>0?this.epubSpreads.epubManager.pageNext():n<0&&this.epubSpreads.epubManager.pagePrevious()},e.prototype.initDrag=function(e,t){this.xStart=e,this.yStart=t},e.prototype.drag=function(e,t){return[this.x=e-this.xStart,this.y=t-this.yStart]},e.prototype.resetDrag=function(){return[this.xStart=this.x=0,this.yStart=this.y=0]},e.prototype.updateScrollablesDrop=function(e,t){0===t[0]&&0===t[1]||this.epubSpreads.gotoPageByCoordsDiff(e.gestureData)},e.prototype.updateScrollables=function(e,t){this.epubSpreads.scrollTo(t[0],t[1])},e.prototype.preserveScrollElement=function(){this.element.addEventListener("scroll",function(e){s["default"].prototype.preventAllGesture()},!0)},e.prototype.trySwip=function(e){this.resetPermissionTapActions(),e.defaultPreventGesture=!0,this.updateScrollablesDrop(e,this.drag(e.epubClientX,e.epubClientY))},e.prototype.tryDrag=function(e){this.resetPermissionTapActions(),e.defaultPreventGesture=!0,0===e.gestureData.x.pointDiff&&0===e.gestureData.y.pointDiff&&this.initDrag(e.epubClientX,e.epubClientY),this.updateScrollables(e,this.drag(e.epubClientX,e.epubClientY))},e.prototype.addScrollable=function(e){this.scrollables.push(new n["default"](this,this.config,e)),this.scrollablesLength++},e.prototype.permissionTapEvent=function(e){this.permissionTapList.push({action:e.data.action,date:Date.now()})},e.prototype.resetPermissionTapActions=function(){this.permissionTapList=[]},e.prototype.checkLastActionForTapGesture=function(e){for(var t=[],i=0,n=this.permissionTapList.length;i<n;i++)Date.now()-this.permissionTapList[i].date<a?t.push(this.permissionTapList[i]):this.permissionTapList[i].action(Promise.resolve(!1));if(this.permissionTapList=[],0===t.length)return void("pointercancel"!==e.type&&this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CLICK}));for(var i=0,n=t.length;i<n;i++)t[i].action(Promise.resolve(!0))},e.mouseWheelLast=0,e.mouseWheelLastDelta=0,e}();i["default"]=u},{"./EpubConfig/EpubDefaultConfig":4,"./EpubEvent":7,"./EpubGesturesEvent":9,"./EpubScrollable":55}],57:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./EpubSpreadZoomable"),o=e("./ProtoHTMLElement"),r=e("./EpubEvent");!function(e){e.LEFT="left",e.CENTER="center",e.RIGHT="right"}(n=i.SpreadAlignment||(i.SpreadAlignment={}));var a=function(){function e(e,t,i,n){this.epubSpreads=e,this.config=t,this.spreadIndex=i,this.mainViewElement=n,this.optimizeQuality=!0,this.cssClassSpreadVisible="spread-is-visible",this.lastOffset=0,this.pageIndexes=[],this.spreadOffset=0,this.parent=this.epubSpreads,this.epubEvent=w.epubEvent,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.pagesInSpread=[],this.elementSize={width:0,height:0},this.epubSpreadZoomable=new s["default"](this,this.config),this.spreadHTMLElement=new o["default"](this.config),this.spreadHTMLElement.initSpread(this,this.config,this.epubSpreadZoomable,this.spreadIndex),this.element=this.spreadHTMLElement.element,this.spreadHTMLElement.optimizeQuality=this.optimizeQuality,this.initSpreadContent(),this.epubEvent.addListener(r.EPUB_EVENTS.PAGE_CHANGE,this.initSpreadContent.bind(this));var a="configsJson.pageDataUpdated";document.addEventListener(a,this.onPageDataUpdate.bind(this))}return e.prototype.initSpreadContent=function(){if(this.spreadHTMLElement.setSpreadScrollable(this.config.isCrossNavPage(this.parent.currentPage)),this.element.parentElement){var e=this.element.querySelector("video.spread-bgVideo");if(e)if(this.pageIndexes.includes(this.parent.currentPage-1)){try{e.currentTime=0}catch(t){}e.play()}else e.pause()}},Object.defineProperty(e.prototype,"width",{get:function(){return this.elementSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.elementSize.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.config.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSpreadSize",{get:function(){return this.config.firstSpreadSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"epubPages",{get:function(){return this.parent.epubPages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pagesBySpread",{get:function(){return this.pageIndexes.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coverPageCenter",{get:function(){return this.config.coverPageCenter},enumerable:!0,configurable:!0}),e.prototype.getSpreadAlignment=function(e,t){var i=2===t;if(i)return n.CENTER;var s=w.Main.configsJsonManager.getPageData(["showAlone","showAloneSide"],e-1),o=s.showAlone,r=s.showAloneSide;if(o){if("left"===r)return n.LEFT;if("right"===r)return n.RIGHT}var a=1===e&&this.coverPageCenter===!1;return a?n.RIGHT:n.CENTER},e.prototype.updatePages=function(e){var t=this,i=0,n=e.length,s=!1;if(0===n)return this.epubSpreadZoomable.resetContent(),void(this.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")&&this.epubSpreadZoomable.element.classList.remove("epub-all-pages-loaded"));for(this.spreadHTMLElement.setBackground(e),this.pagesInSpread=e,this.epubSpreadZoomable.contentLength!==n&&(s=!0);i<n;i++)this.epubSpreadZoomable.lastContentIDs.indexOf(this.pagesInSpread[i].pageNumber)===-1&&(s=!0);s===!0&&(this.epubSpreadZoomable.resetContent(),this.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")&&this.epubSpreadZoomable.element.classList.remove("epub-all-pages-loaded")),this.epubSpreadZoomable.contentLength=n;var o=this.getSpreadAlignment(this.pagesInSpread[0].pageNumber,n);this.epubSpreadZoomable.contentPosition=o;var r=[],a=!1;for(i=0;i<n;i++)this.pagesInSpread[i].atSpreadOffset=this.spreadOffset,s===!0?r.push(this.epubSpreadZoomable.updateContent(this.pagesInSpread[i])):this.pagesInSpread[i].epubPageEnrichmentStat(),this.pagesInSpread[i].pageContainsCPUElement===!0&&(a=!0);this.epubSpreadZoomable.setContainIframe(a),Promise.all(r).then(function(e){0!==e.length&&t.epubSpreadZoomable.element.classList.contains("epub-all-pages-loaded")===!1&&t.epubSpreadZoomable.element.classList.add("epub-all-pages-loaded")})},e.prototype.displaySpread=function(){this.mainViewElement.appendChild(this.element)},e.prototype.updateSpread=function(e,t){var i;this.lastOffset=this.spreadOffset,this.spreadOffset=e,this.pageIndexes=t,0===this.spreadOffset?this.spreadHTMLElement.element.classList.contains(this.cssClassSpreadVisible)===!1&&this.spreadHTMLElement.element.classList.add(this.cssClassSpreadVisible):this.spreadHTMLElement.element.classList.contains(this.cssClassSpreadVisible)===!0&&this.spreadHTMLElement.element.classList.remove(this.cssClassSpreadVisible),this.epubSpreadZoomable.reset(),i=this.getPages(this.pageIndexes),this.spreadHTMLElement.element.setAttribute("pages",i.length.toString()),this.updatePages(i)},e.prototype.updateSpreadSize=function(){this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight,this.epubSpreadZoomable.updateSize(),this.elementSize.width=this.element.offsetWidth,this.elementSize.height=this.element.offsetHeight},e.prototype.getPages=function(e){var t=this;return e.map(function(e){return t.epubPages.pageGetForSpread(e)})},e.prototype.onPageDataUpdate=function(){var e=this.getPages(this.pageIndexes);this.spreadHTMLElement.setBackground(e)},e.prototype.updateIframesZoom=function(e){this.pagesInSpread.forEach(function(t){return t.updateIframesZoom(e)})},e}();i["default"]=a},{"./EpubEvent":7,"./EpubSpreadZoomable":58,"./ProtoHTMLElement":65}],58:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubConfig/EpubDefaultConfig"),s=e("./EpubEvent"),o=e("./EpubSpread"),r=e("./ProtoHTMLElement"),a=e("./EpubSpreadZoomableAnimations"),u=e("./EpubZoom"),l=e("./EpubGesturesEvent"),p=e("./utils/functions"),h=function(){function e(e,t){var i;this.epubSpread=e,this.config=t,this.contentLength=0,this.contentPosition=o.SpreadAlignment.CENTER,this.scale=0,this._x=0,this._y=0,this.widthScaled=0,this.heightScaled=0,this.savedEvent=null,this.paddingLeft=0,this.paddingRight=0,this.paddingTop=0,this.paddingBottom=0,this.epubEvent=w.epubEvent,this.parent=this.epubSpread,this.screenSize=this.epubSpread.screenSize,this.mainViewElementSize=this.epubSpread.mainViewElementSize,this.updateSize=this.updateSize.bind(this),this.lastContentIDs=[],this._pageSizeType=(i={},i[n.PagesSizeTypes.CONTAIN]=this.pageTypeContain.bind(this),i[n.PagesSizeTypes.COVER_HORIZONTALLY]=this.coverHorizontally.bind(this),i),this.elementSize={width:0,height:0},this.epubZoom=new u["default"](this,this.config),this.spreadZoomableHTMLElement=new r["default"](this.config),this.spreadZoomableHTMLElement.initZoomable(this,this.config),this.element=this.spreadZoomableHTMLElement.element,this.epubSpreadZoomableAnimations=new a["default"](this,this.config,this.spreadZoomableHTMLElement),this.epubGesturesEvent=new l["default"](this,this.spreadZoomableHTMLElement.element),this.zoomDoubleClick===!0&&this.epubGesturesEvent.addEventListener(l["default"].GESTURESNAME.DBLTAPGESTURE,this.tryZoom.bind(this)),this.zoomSingleClick===!0&&(this.epubEvent.addListener(s.EPUB_EVENTS.PAGE_CLICK,this.tryZoomOneClick.bind(this)),
this.epubGesturesEvent.addEventListener(l["default"].GESTURESNAME.TAPGESTURE,this.saveEvent.bind(this))),this.epubGesturesEvent.addEventListener(l["default"].GESTURESNAME.PANGESTURE,this.tryDrag.bind(this)),this.setEnableScrollElement(),this.epubEvent.addListener(s.EPUB_EVENTS.PAGE_CHANGE,this.setEnableScrollElement.bind(this)),this.epubEvent.addListener(s.EPUB_EVENTS.PAGE_CHANGE,this.updateSize.bind(this))}return e.prototype.setEnableScrollElement=function(){this.epubGesturesEvent.setEnableScrollElement(this.config.isCrossNavPage(this.spreadFirstPage))},Object.defineProperty(e.prototype,"spreadFirstPage",{get:function(){return this.parent.pageIndexes[0]+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomDoubleClick",{get:function(){return this.config.zoomDoubleClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomSingleClick",{get:function(){return this.config.zoomSingleClick},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultPageScaleAt",{get:function(){return this.config.defaultPageScaleAt},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentWidth",{get:function(){return this.parent.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentHeight",{get:function(){return this.parent.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadOffset",{get:function(){return this.parent.spreadOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.elementSize.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.elementSize.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageSizeType",{get:function(){var e=this.config.pageSizeType,t=this.config.isCrossNavPage(this.spreadFirstPage);return t&&(e=n.PagesSizeTypes.COVER_HORIZONTALLY),"function"==typeof this._pageSizeType[e]?this._pageSizeType[e]:this._pageSizeType.contain},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useMatrixTransform",{get:function(){return this.config.useMatrixTransformZoomable},enumerable:!0,configurable:!0}),e.prototype.roundPxDevice=function(e){return~~(100*e)/100},e.prototype.coverHorizontally=function(){return this.updateEpubContainerForCrossNav(),this.updateSpreadPositioning(!0)},e.prototype.pageTypeContain=function(){return this.updateSpreadPositioning(!1)},e.prototype.updateEpubContainerForCrossNav=function(){var e=".webpub-viewer__epub-container-spread-page",t=this.spreadZoomableHTMLElement.element.querySelector(e);if(t){var i=".webpub-viewer__epub-container-spread-page-sub",n=t.querySelector(i);if(n){var s=this.getPageHeight(t,n);n.style.height=s+"px"}}},e.prototype.getPageHeight=function(e,t){var i=e.className,n=i.match(/spread-page-(\d+)/);if(n){var s=Number(n[1])-1,o=w.Main.configsJsonManager.getPageData(["height"],s).height;if(o)return o}return this.calculatePageHeight(t)},e.prototype.calculatePageHeight=function(e){var t=this.spreadZoomableHTMLElement.scale,i=e.getAttribute("data-original-height");i||(i=e.offsetHeight.toString(),e.setAttribute("data-original-height",i));for(var n=parseInt(i),s=e.children,o=this.spreadZoomableHTMLElement.element.getBoundingClientRect().top,r=0;r<s.length;r++){var a=s[r],u=a.getBoundingClientRect(),l=(u.height+u.top-o)/t;n=Math.max(n,l)}return n},e.prototype.updateSpreadPositioning=function(e){var t=0,i=0,n=0;return 0!==this.width&&0!==this.height&&(t=Math.min(this.getHorizontalScale(),this.getVerticalScale(e)),this.widthScaled=t*this.width,this.heightScaled=t*this.height,i=this.getSpreadXCoordinate(),n=this.getSpreadYCoordinate(),this.scale!==t&&(this.scale=t,this._x=i,this._y=n,this.updateSizeFromPoint([t,0,0,i,n])),!0)},e.prototype.getHorizontalScale=function(){return(this.parentWidth-this.paddingLeft-this.paddingRight)/this.width},e.prototype.getVerticalScale=function(e){return e?1:(this.parentHeight-this.paddingTop-this.paddingBottom)/this.height},e.prototype.getSpreadXCoordinate=function(){var e=.5*(this.parentWidth+this.paddingLeft-this.paddingRight);if(this.contentPosition===o.SpreadAlignment.LEFT){var t=e-this.widthScaled,i=this.paddingLeft,n=Math.max(i,t);return this.roundPxDevice(n)}if(this.contentPosition===o.SpreadAlignment.RIGHT){var s=this.parentWidth-this.paddingRight-this.widthScaled,n=Math.min(s,e);return this.roundPxDevice(n)}var r=e-.5*this.widthScaled;return this.roundPxDevice(r)},e.prototype.getSpreadYCoordinate=function(){var e=.5*(this.parentHeight+this.paddingTop-this.paddingBottom),t=this.heightScaled+this.paddingTop+this.paddingBottom>=this.parentHeight;if(t)return this.paddingTop;var i=e-.5*this.heightScaled;return this.roundPxDevice(i)},e.prototype.updateSizeFromPointAnimation=function(e){this.epubSpreadZoomableAnimations.animateScale(e,this.spreadOffset)},e.prototype.updateSizeFromPoint=function(e){this.epubSpreadZoomableAnimations.scaleDrag(e,this.spreadOffset)},e.prototype.saveEvent=function(e){if(e.target.classList.contains("epub-link-type_iframe")!==!0||e.target.classList.contains("epub-link-visible")!==!0){var t=e.target;return l["default"].preventAllGestureStatus()===!0||p.isMediaElement(t)?void(this.savedEvent=null):void(this.savedEvent=e)}},e.prototype.tryZoomOneClick=function(e){var t=this.savedEvent;return null===t||l["default"].preventAllGestureStatus()===!0?void(this.savedEvent=null):(this.savedEvent=null,void this.tryZoom(t))},e.prototype.tryZoom=function(e){var t=p.getBoundingClientRect(this.spreadZoomableHTMLElement.element,this.useMatrixTransform?1:this.scale),i=this.epubZoom.scale;return e.defaultPreventGesture=!0,0!==i?(this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()),void this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})):void(0===this.spreadOffset&&(this.updateSizeFromPointAnimation(this.epubZoom.getZoom(e,this.defaultPageScaleAt,e.epubClientX,e.epubClientY,t)),0===i&&this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_ZOOM,data:{status:!0,scale:this.epubZoom.scale}})))},e.prototype.getBoundingClientRect=function(e){return void 0===e&&(e=this.spreadZoomableHTMLElement.element),p.getBoundingClientRect(e,this.useMatrixTransform?1:this.scale)},e.prototype.zoomToggle=function(e){var t=this.getBoundingClientRect(),i=t.left+t.width*e.x,n=t.top+t.height*e.y,o=e.scale;return 0===o?(e.animate===!0?this.updateSizeFromPointAnimation(this.epubZoom.resetZoom()):this.updateSizeFromPoint(this.epubZoom.resetZoom()),void this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})):(e.animate===!0?this.updateSizeFromPointAnimation(this.epubZoom.getZoomNoEvent(o,i,n,t)):this.updateSizeFromPoint(this.epubZoom.getZoomNoEvent(o,i,n,t)),void this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_ZOOM,data:{status:!0,scale:this.epubZoom.scale}}))},e.prototype.zoomByStep=function(e){var t={x:e.x,y:e.y,scale:this.epubZoom.scale+e.step,animate:e.animate};this.zoomToggle(t)},e.prototype.zoomProgress=function(e){this.zoomToggle(e)},e.prototype.tryDrag=function(e){var t,i;0===this.epubZoom.scale&&0===e.gestureData.pinchZoomDiff||(t=this.getBoundingClientRect(),e.defaultPreventGesture=!0,0===e.gestureData.x.pointDiff&&0===e.gestureData.y.pointDiff?this.epubZoom.initdrag(e,e.epubClientX,e.epubClientY,t):(0===e.gestureData.x.pointDiff&&this.epubZoom.initdragX(e,e.epubClientX,t),0===e.gestureData.y.pointDiff&&this.epubZoom.initdragY(e,e.epubClientY,t)),i=this.epubZoom.scale+e.gestureData.pinchZoomDiff*this.config.zoomFactor,this.epubZoom.getZoom(e,i,e.epubClientX,e.epubClientY,t),this.updateSizeFromPoint(this.epubZoom.drag(e,e.epubClientX,e.epubClientY)))},e.prototype.reset=function(){var e=this.epubZoom.scale;this.updateSizeFromPoint(this.epubZoom.resetZoom()),0===e&&this.epubEvent.fire({type:s.EPUB_EVENTS.PAGE_ZOOM,data:{status:!1,scale:this.epubZoom.scale}})},e.prototype.resetContent=function(){this.lastContentIDs=[],this.spreadZoomableHTMLElement.removeChilren()},e.prototype.updateContent=function(e){var t=this;this.lastContentIDs.push(e.pageNumber);var i=e.syncElemWithSpread(this.spreadZoomableHTMLElement.element);return this.spreadZoomableHTMLElement.element.appendChild(i.element),this.config.isCrossNavPage(this.parent.currentPage)&&(clearTimeout(this.timeoutId2),this.timeoutId2=setTimeout(function(){t.spreadZoomableHTMLElement.scrollToTop()},0)),e.onload=this.updateSize,i.loaded},e.prototype.setContainIframe=function(e){var t=this;this.spreadZoomableHTMLElement.element.setAttribute("contains-iframe",e?"yes":"no"),setTimeout(function(){return t.updateIframesZoomIfNeeded(t.scale)},100)},e.prototype.getElement=function(){return this.spreadZoomableHTMLElement.element},e.prototype.updateSize=function(){var e=this;this.scale=0,this.paddingLeft=this.config.paddingLeft,this.paddingRight=this.config.paddingRight,this.paddingTop=this.config.paddingTop,this.paddingBottom=this.config.paddingBottom,this.elementSize.width=this.spreadZoomableHTMLElement.element.offsetWidth,this.elementSize.height=this.spreadZoomableHTMLElement.element.offsetHeight,this.pageSizeType()===!1?(clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.updateSize,16)):setTimeout(function(){return e.updateIframesZoomIfNeeded(e.scale)},100)},e.prototype.updateIframesZoomIfNeeded=function(e){this.config.useMatrixTransformZoomable||this.epubSpread.updateIframesZoom(e)},e}();i["default"]=h},{"./EpubConfig/EpubDefaultConfig":4,"./EpubEvent":7,"./EpubGesturesEvent":9,"./EpubSpread":57,"./EpubSpreadZoomableAnimations":59,"./EpubZoom":63,"./ProtoHTMLElement":65,"./utils/functions":85}],59:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./utils/cssAnimations"),s=1e-4,o=.3,r=function(){function e(e,t,i){this.epubSpreadZoomable=e,this.config=t,this.spreadZoomableHTMLElement=i,this.fromPosition={x:0,y:0,scale:0},this.toPosition={x:0,y:0,scale:0},this.elementData={prc:0},this.epubTweens=new Tween(this.elementData,"prc",Tween.regularEaseInOut,0,0,s),this.epubTweens.onMotionChanged=this.tweenUpdate.bind(this)}return e.prototype.animationDomAsync=function(e,t,i,s,o){this.config.useMatrixTransformZoomable?n.matrixAsync(this.config.use3DMatrixTransform,e,t,i,s,o):n.positionDomAsync(e,t,i,s,o),this.epubSpreadZoomable.updateIframesZoomIfNeeded(t)},e.prototype.tweenUpdate=function(e){this.fromPosition.scale+=(this.toPosition.scale-this.fromPosition.scale)*e.target._pos,this.fromPosition.x+=(this.toPosition.x-this.fromPosition.x)*e.target._pos,this.fromPosition.y+=(this.toPosition.y-this.fromPosition.y)*e.target._pos,this.animationDomAsync(this.spreadZoomableHTMLElement,this.fromPosition.scale,this.fromPosition.x,this.fromPosition.y,0)},e.prototype.tweenUpdateZero=function(){this.animationDomAsync(this.spreadZoomableHTMLElement,this.toPosition.scale,this.toPosition.x,this.toPosition.y,0)},e.prototype.setOptimizequality=function(e){return 0===e?void(this.spreadZoomableHTMLElement.optimizeQuality=!0):void(this.spreadZoomableHTMLElement.optimizeQuality=!1)},e.prototype.animateScale=function(e,t){this.setOptimizequality(t),this.toPosition.scale=e[0],this.toPosition.x=e[3],this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=0,this.epubTweens.continueTo(1,o)},e.prototype.scaleDrag=function(e,t){this.setOptimizequality(t),this.fromPosition.scale=this.toPosition.scale=e[0],this.fromPosition.x=this.toPosition.x=e[3],this.fromPosition.y=this.toPosition.y=e[4],this.epubTweens.stop(),this.epubTweens._pos=1,this.tweenUpdateZero()},e}();i["default"]=r},{"./utils/cssAnimations":83}],60:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubSpread"),s=e("./EpubSpreadsAnimations"),o=e("./EpubPages"),r=e("./EpubScrollables"),a=e("./utils/functions"),u=function(){function e(e,t,i,n){this.epubManager=e,this.config=t,this.viewMain=i,this.epubCssManager=n,this.parent=this.epubManager,this.screenSize=this.epubManager.screenSize,this.mainViewElementSize={width:0,height:0},this.mainViewElementClassName=this.config.mainViewElementClassName,this.epubPages=new o["default"](this,this.config,this.epubCssManager),this.setMainViewElement(),this.epubScrollables=new r["default"](this,this.config,this.mainViewElement),this.generatePublicationSpreads(),this.appendMainViewElementToViewMain()}return Object.defineProperty(e.prototype,"currentPage",{get:function(){return this.config.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastPage",{get:function(){return this.config.lastPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSpreadSize",{get:function(){return this.config.firstSpreadSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spreadsLength",{get:function(){return void 0==this.publicationSpreads?-1:Math.min(this.publicationSpreads.length,this.config.maxSpreadsLength)},enumerable:!0,configurable:!0}),e.prototype.initSpreads=function(e,t){this.clearSpreadsElements();for(var i=0,s=e.length;i<s;i++)e[i]=new n["default"](this,this.config,i,t),this.epubScrollables.addScrollable(e[i]);this.updateSpreads(0),this.displaySpreads(e)},e.prototype.clearSpreadsElements=function(){for(;this.mainViewElement.lastChild;)this.mainViewElement.removeChild(this.mainViewElement.lastChild)},e.prototype.displaySpreads=function(e){for(var t=0,i=e.length;t<i;t++)e[t].displaySpread()},e.prototype.getMainViewElement=function(){return this.mainViewElement},e.prototype.setMainViewElement=function(){this.mainViewElement=document.createElement("div"),this.mainViewElement.classList.add(this.mainViewElementClassName)},e.prototype.updateMainViewElementSize=function(){this.mainViewElementSize.width=this.mainViewElement.offsetWidth,this.mainViewElementSize.height=this.mainViewElement.offsetHeight,this.mainViewElementSize.rect=a.getBoundingClientRect(this.mainViewElement)},e.prototype.appendMainViewElementToViewMain=function(){this.viewMain.appendChild(this.mainViewElement)},e.prototype.getSpreadByPageIndex=function(e){var t=this.spreadsPageIndexes.findIndex(function(t){return t&&t.includes(e-1)});return this.epubSpreads[t]},e.prototype.getPagesFromSpreadByPageIndex=function(e){return this.publicationSpreads.find(function(t){return t.includes(e)})},e.prototype.getScaleFromCurrentSpread=function(){return this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.epubZoom.scale},e.prototype.zoomToggle=function(e){this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.zoomToggle(e)},e.prototype.zoomByStep=function(e){this.getSpreadByPageIndex(this.currentPage).epubSpreadZoomable.zoomByStep(e)},e.prototype.updateSpreads=function(e){var t=this;this.epubPages.resetRequested();var i=this.publicationSpreads.findIndex(function(e){return e.includes(t.currentPage-1)}),n=this.lastSpreadIndex;this.lastSpreadIndex=i,this.updateSpreadsOffset(i,n),this.updateSpreadsPageIndexes(i);for(var s=this.epubSpreads.length,o=0;o<s;o++){var r=this.spreadOffsets[o],a=this.spreadsPageIndexes[o];a&&this.epubSpreads[o].updateSpread(r,a)}Math.abs(i-this.lastSpreadIndex)>1?this.epubSpreadsAnimations.updatePositionSizeOffset():this.epubSpreadsAnimations.animatePositionOffset(e),this.epubPages.flushNotRequested()},e.prototype.updateSpreadsOffset=function(e,t){if(1===this.spreadsLength)return void(this.spreadOffsets=[0]);if(2===this.spreadsLength)return 0===e?void(this.spreadOffsets=[0,1]):void(this.spreadOffsets=[-1,0]);var i=this.getThreeSpreadOffsets(e),n=this.spreadOffsets.map(function(e){return t+e}),s=i.map(function(t){return e+t}),o=[void 0,void 0,void 0];o=this.fillWithLoadedSpreads(o,i,n,s),o=this.fillWithNeededSpreads(o,i),this.spreadOffsets=o},e.prototype.getThreeSpreadOffsets=function(e){return 0===e?[0,1,2]:e===this.publicationSpreads.length-1?[-2,-1,0]:[-1,0,1]},e.prototype.fillWithLoadedSpreads=function(e,t,i,n){for(var s=function(s){var o=i[s],r=n.findIndex(function(e){return o===e});r!==-1&&(e[s]=t[r])},o=0;o<i.length;o++)s(o);return e},e.prototype.fillWithNeededSpreads=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(void 0===n)for(var s=0;s<t.length;s++){var o=t[s];e.includes(o)||(e[i]=o)}}return e},e.prototype.updateSpreadsPageIndexes=function(e){var t=this;this.spreadsPageIndexes=this.spreadOffsets.map(function(i){return t.publicationSpreads[e+i]})},e.prototype.updateSpreadsSize=function(){var e=0,t=0;for(this.updateMainViewElementSize(),this.epubSpreadsAnimations.updatePositionSizeOffset(),this.generatePublicationSpreads(),this.spreadsPageIndexes=this.publicationSpreads.slice(0,this.config.maxSpreadsLength),this.goToPage(this.currentPage,!1),e=0,t=this.epubSpreads.length;e<t;e++)this.epubSpreads[e].updateSpreadSize()},e.prototype.generatePublicationSpreads=function(){var e=this.isWideScreen();if(this.lastIsWideScreen!==e){this.lastIsWideScreen=e,this.publicationSpreads=[];for(var t=0;t<this.pageQuantity;){var i=this.getSpreadPageIndexes(t);this.publicationSpreads.push(i),t+=i.length}this.initLoadedSpreads()}},e.prototype.getSpreadPageIndexes=function(e){var t=[e,e+1],i=this.getSpreadPageNumber(t);return 1===i?[e]:t},e.prototype.getSpreadPageNumber=function(e){var t=w.Main.xmlManager.get("common-configuration","contents","zoom","width"),i=w.Main.xmlManager.get("common-configuration","contents","zoom","height"),n=t>i,s=this.parent.epubNavigationTypeManager.pageLayout,o=["best","auto"].indexOf(s)!==-1,r="single"===s,a="double"===s,u=this.isWideScreen(),l=e[0]<0||e[1]>=this.pageQuantity,p=1===this.config.firstSpreadSize&&e.includes(0),h=w.Main.xmlManager.get("comboPages","forcedSinglePages").map(function(e){return e-1}),c=w.Main.configsJsonManager.getPagesData(["showAlone"]),d=c.map(function(e,t){return t}).filter(function(e){return c[e].showAlone}),f=h.some(function(t){return e.includes(t)}),m=d.some(function(t){return e.includes(t)}),g=f||m;return r||l||p||g?1:a?2:o===!0&&n?1:o===!0&&u?2:1},e.prototype.initLoadedSpreads=function(){this.epubSpreads=new Array(this.spreadsLength),this.spreadOffsets=[];for(var e=0;e<this.spreadsLength;e++)this.spreadOffsets.push(e);this.epubSpreadsAnimations=new s["default"](this,this.config,this.epubSpreads,this.mainViewElement),this.initSpreads(this.epubSpreads,this.mainViewElement)},e.prototype.scrollTo=function(e,t){this.epubSpreadsAnimations.updatePosition(e,t)},e.prototype.gotoPageByCoordsDiff=function(e){this.epubManager.gotoPageByCoordsDiff(e)},e.prototype.goToPage=function(e,t){void 0===t&&(t=!0),this.epubManager.goToPage(e,t)},e.prototype.getSpreadPageNumberByOffset=function(e){var t=this.spreadOffsets.findIndex(function(t){return t===e});return t!==-1?this.spreadsPageIndexes[t].length:0},e.prototype.getCurrentPageIndexes=function(e){return this.publicationSpreads.find(function(t){return t.includes(e)})||[1]},e.prototype.isWideScreen=function(){var e=window.parent!==window;if(!w.Param.isDesktop&&!e){var t=screen;if(t.orientation)return t.orientation.type.includes("landscape");if(t.msOrientation)return t.msOrientation.type.includes("landscape")}return this.screenSize.width>this.screenSize.height},e}();i["default"]=u},{"./EpubPages":54,"./EpubScrollables":56,"./EpubSpread":57,"./EpubSpreadsAnimations":61,"./utils/functions":85}],61:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./utils/cssAnimations"),s=e("./EpubConfig/EpubDefaultConfig"),o=1,r=function(){function e(e,t,i,n){this.parent=e,this.config=t,this.epubSpreads=i,this.mainViewElement=n,this.epubSpreadsLength=i.length,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubSpreadsData=new Array(this.epubSpreads.length),this.makeSpreadData(this.epubSpreadsData),this.pixelTimeData={x:0,w:0,y:0,h:0,date:0,time:0},this.currentPosition={width:0,height:0,inX:0,inY:0,diffCoord:0}}return Object.defineProperty(e.prototype,"navigationAxis",{get:function(){return this.config.navigationAxis},enumerable:!0,configurable:!0}),e.prototype.setPixelTime=function(e,t){var i=e-this.pixelTimeData.x,n=t-this.pixelTimeData.y,s=Date.now(),o=s-this.pixelTimeData.date;this.pixelTimeData.x=e,this.pixelTimeData.w=i,this.pixelTimeData.y=t,this.pixelTimeData.h=n,this.pixelTimeData.date=s,this.pixelTimeData.time=o},e.prototype.getPixelTime=function(e,t){var i={w:~~Math.abs(e/this.pixelTimeData.w*this.pixelTimeData.time),h:~~Math.abs(t/this.pixelTimeData.y*this.pixelTimeData.time)};return this.pixelTimeData.x=0,this.pixelTimeData.w=0,this.pixelTimeData.y=0,this.pixelTimeData.h=0,this.pixelTimeData.date=0,this.pixelTimeData.time=0,i},e.prototype.makeSpreadData=function(e){for(var t=0,i=e.length;t<i;t++)e[t]={spreadOffset:0}},e.prototype.animationDomAsyncZero=function(e,t,i,s){this.config.useMatrixTransformScrollable?n.matrixAsync(this.config.use3DMatrixTransform,e,o,t,i,s):n.positionDomAsync(e,o,t,i,s)},e.prototype.animateSpreads=function(e,t,i,n,s,o,r){for(var a,u=0,l=this.epubSpreadsLength,p=0,h=0,c=0,d=0,f=0,m=0,g=0;u<l;u++)g=r,m=o,a=this.epubSpreads[u],0!==a.spreadOffset&&0!==a.lastOffset&&(m=1,g=0),f=a.spreadOffset-a.lastOffset,c=a.lastOffset*e+f*e*m+s*(1-m),d=a.lastOffset*t+f*t*m+s*(1-m),p=i*c,h=n*d,this.animationDomAsyncZero(a.spreadHTMLElement,p,h,g)},e.prototype.updatePositionSizeOffset=function(){this.updatePosition(0,0)},e.prototype.animatePositionOffset=function(e){var t=0,i=0,n=0,o=0;e=e||0,this.navigationAxis===s.NavigationAxis.X?(t=1,i=0):(t=0,i=1),n=this.mainViewElementSize.width,o=this.mainViewElementSize.height,this.currentPosition.width=n,this.currentPosition.height=o,this.currentPosition.inX=t,this.currentPosition.inY=i,this.animateSpreads(this.currentPosition.width,this.currentPosition.height,this.currentPosition.inX,this.currentPosition.inY,this.currentPosition.diffCoord,1,1e3*e)},e.prototype.updatePosition=function(e,t){var i,n=0,o=0,r=0,a=0,u=0,l=0,p=0,h=this.epubSpreadsLength;for(u=this.mainViewElementSize.width,l=this.mainViewElementSize.height,this.navigationAxis===s.NavigationAxis.X?(n=1,o=0,this.currentPosition.diffCoord=e):(n=0,o=1,this.currentPosition.diffCoord=t);p<h;p++)i=this.epubSpreads[p],this.epubSpreadsData[p].spreadOffset=i.spreadOffset,r=n*(i.spreadOffset*u+e),a=o*(i.spreadOffset*l+t),0!==i.spreadOffset&&((i.spreadOffset>0&&r>i.spreadOffset*u||i.spreadOffset<0&&r<i.spreadOffset*u)&&(r=i.spreadOffset*u),(i.spreadOffset>0&&a>i.spreadOffset*l||i.spreadOffset<0&&a<i.spreadOffset*l)&&(a=i.spreadOffset*l)),this.animationDomAsyncZero(i.spreadHTMLElement,r,a,0)},e}();i["default"]=r},{"./EpubConfig/EpubDefaultConfig":4,"./utils/cssAnimations":83}],62:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubEvent"),s=function(){function e(e){this.epubManager=e,this.trackDateMaxTime=500,this.trackPageDate=0,this.previousPages=[],this.epubEvent=w.epubEvent,this.epubEvent.addListener(n.EPUB_EVENTS.PAGE_CHANGE,this.trackPages.bind(this)),this.epubEvent.addListener(n.EPUB_EVENTS.PAGE_ZOOM,this.trackPagesZoom.bind(this)),this.epubEvent.addListener(n.EPUB_EVENTS.ACTION_LINK_SUCCESS,this.trackLinks.bind(this))}return e.prototype.trackPages=function(e){var t=this.epubManager.getCurrentPages(e.data.pageNumber);if(JSON.stringify(t)!==JSON.stringify(this.previousPages)){if(Date.now()-this.trackPageDate<this.trackDateMaxTime)return void(this.trackPageDate=Date.now());this.trackPageDate=Date.now(),this.previousPages=this.previousPages||t;for(var i={},n=0,s=t.length;n<s;n++)i[n+1]=t[n];var o=t[0],r=t[t.length-1],a=this.previousPages[0],u=this.previousPages[this.previousPages.length-1];o-1===u?w.Main.trackerManager.trackEvent({name:"pageNext",variables:{1:a}}):r+1===a&&w.Main.trackerManager.trackEvent({name:"pagePrev",variables:{1:u}}),this.previousPages=t,w.Main.trackerManager.trackPage({name:"page",variables:i})}},e.prototype.trackPagesZoom=function(e){var t=this.epubManager.getCurrentPages(),i="zoomIn",n={1:""};n[1]=t.join("-"),e.data.status!==!0&&(i="zoomOut"),this.lastZoomScale===e.data.scale&&this.lastZoomedPages===n[1]||0===e.data.scale&&this.lastZoomedPages!==n[1]||(this.lastZoomedPages=n[1],this.lastZoomScale=e.data.scale,w.Main.trackerManager.trackEvent({name:i,variables:n}))},e.prototype.trackLinks=function(e){var t=e.data.userAct;w.Main.trackerManager.trackEvent({name:"link",variables:{1:t.type,2:t.param}})},e}();i.EpubStatistics=s},{"./EpubEvent":7}],63:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./EpubZoomDraggable"),s=function(){function e(e,t){this.epubSpreadZoomable=e,this.config=t,this.totalScale=0,this.totalWidth=0,this.totalHeight=0,this.totalX=0,this.totalY=0,this._scale=0,this._x=0,this._y=0,this.xLimited=!1,this.yLimited=!1,this.xLimit=0,this.yLimit=0,this.elastic={axisMax:100,coef:10},this.parent=this.epubSpreadZoomable,this.maxTotalScale=this.config.maxPageTotalScale,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.epubZoomDraggable=new n["default"](this,this.config)}return Object.defineProperty(e.prototype,"element",{get:function(){return this.parent.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleOrig",{get:function(){return this.parent.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xOrig",{get:function(){return this.parent._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yOrig",{get:function(){return this.parent._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widthOrig",{get:function(){return this.parent.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightOrig",{get:function(){return this.parent.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.parent.paddingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.parent.paddingTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.parent.paddingRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.parent.paddingBottom},enumerable:!0,configurable:!0}),e.prototype.getBoundingClientRect=function(){return this.parent.getBoundingClientRect()},e.prototype.calcMaxCoord=function(e,t,i,n,s,o){return void 0===s&&(s=0),void 0===o&&(o=0),n.status=!1,t+s+o<i?(n.status=!0,i/2-(t+s+o)/2):e},e.prototype.setMaxX=function(){var e={status:!0},t=this.paddingLeft,i=this.paddingRight;return this.totalX=this.calcMaxCoord(this.totalX,this.totalWidth,this.mainViewElementSize.width,e,t,i),e.status},e.prototype.setMaxY=function(){var e={status:!0},t=this.paddingTop,i=this.paddingBottom;return this.totalY=this.calcMaxCoord(this.totalY,this.totalHeight,this.mainViewElementSize.height,e,t,i),e.status},e.prototype.calcMaxOnDragCoord=function(e,t,i,n,s,o,r){var a=t+i-o>-1,u=t+i+n+r<s+1;if(1===e)a===!0&&u===!0||(a===!0?i=o-t:u===!0&&(i=s-(t+n+r)));else{var l=n/2-(o/2-r/2);i=s/2-l}return i},e.prototype.getZoomNoEvent=function(e,t,i,n){return this.getZoom(null,e,t,i,n)},e.prototype.setZoomY=function(e,t,i){var n=this.paddingTop,s=this.paddingBottom,o=this.y,r=t-i.top||0,a=r/(this.heightOrig*e),u=this.heightOrig*this.totalScale;this.y=(this.heightOrig*e-u)*a+o,this.totalY=this.yOrig+this.y,this.totalHeight=u,this.yLimited=this.setMaxY(),this.yLimit=this.yLimited?0:1,this.totalY=this.calcMaxOnDragCoord(this.yLimit,this.epubZoomDraggable.y,this.totalY,u,this.mainViewElementSize.height,n,s)},e.prototype.setZoomX=function(e,t,i){var n=this.paddingLeft,s=this.paddingRight,o=this.x,r=t-i.left||0,a=r/(this.widthOrig*e),u=this.widthOrig*this.totalScale;this.x=(this.widthOrig*e-u)*a+o,this.totalX=this.xOrig+this.x,this.totalWidth=u,this.xLimited=this.setMaxX(),this.xLimit=this.xLimited?0:1,this.totalX=this.calcMaxOnDragCoord(this.xLimit,this.epubZoomDraggable.x,this.totalX,u,this.mainViewElementSize.width,n,s)},e.prototype.makeScale_=function(e){var t=this.scale;return e=e||1,this.scale=e,this.scale>this.maxTotalScale?this.scale=this.maxTotalScale:this.scale<1&&(this.scale=1),this.totalScale=this.scaleOrig*this.scale,this.scaleOrig*t},e.prototype.makeScale=function(e){var t=this.scale;return e=e||0,this.scale=e,this.scale+this.scaleOrig<this.scaleOrig?this.scale=0:this.scale+this.scaleOrig>this.maxTotalScale+this.scaleOrig&&(this.scale=this.maxTotalScale),this.totalScale=this.scale+this.scaleOrig,this.scaleOrig+t},e.prototype.getZoom=function(e,t,i,n,s){var o=0;this.paddingTop,this.paddingBottom;return o=this.makeScale(t),this.setZoomX(o,i,s),this.setZoomY(o,n,s),[this.totalScale,0,0,this.epubZoomDraggable.x+this.totalX,this.epubZoomDraggable.y+this.totalY]},e.prototype.resetZoom=function(){return this.epubZoomDraggable.resetdrag(),this.scale=0,this.x=0,this.y=0,this.totalX=0,this.totalY=0,this.totalScale=0,[this.scaleOrig,0,0,this.xOrig,this.yOrig]},e.prototype.initdrag=function(e,t,i,n){return this.epubZoomDraggable.initdrag(t,i,n)},e.prototype.initdragX=function(e,t,i){return this.epubZoomDraggable.initdragX(t,i.left)},e.prototype.initdragY=function(e,t,i){return this.epubZoomDraggable.initdragY(t,i.top)},e.prototype.drag=function(e,t,i){return this.epubZoomDraggable.drag(e,t,i)},e.prototype.resetdrag=function(){this.epubZoomDraggable.resetdrag()},e}();i["default"]=s},{"./EpubZoomDraggable":64}],64:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e,t){this.epubZoom=e,this.config=t,this.xRect=0,this.yRect=0,this.xStart=0,this.yStart=0,this._x=0,this._y=0,this.correctionX=0,this.correctionY=0,this.parent=this.epubZoom,this.screenSize=this.parent.screenSize,this.mainViewElementSize=this.parent.mainViewElementSize,this.dragedData=[1,0,0,0,0]}return Object.defineProperty(e.prototype,"element",{get:function(){return this.parent.element},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.parent.paddingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.parent.paddingTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.parent.paddingRight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.parent.paddingBottom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleOrig",{get:function(){return this.parent.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xOrig",{get:function(){return this.parent.xOrig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yOrig",{get:function(){return this.parent.yOrig},enumerable:!0,configurable:!0}),e.prototype.calcMaxOnDragCoord=function(e,t,i,n,s,o,r){if(1===e){var a=t+i-o>0,u=t+i+n+r<s;a===!0?i=o-t:u===!0&&(i=s-(t+n+r))}return i},e.prototype.initdragX=function(e,t){this.correctionX=0,this.xRect=t,this.xStart=e-this.xRect-this.x},e.prototype.initdragY=function(e,t){this.correctionY=0,this.yRect=t,this.yStart=e-this.yRect-this.y},e.prototype.getBoundingClientRect=function(){return this.parent.getBoundingClientRect()},e.prototype.initdrag=function(e,t,i){this.initdragX(e,i.left),this.initdragY(t,i.top);
},e.prototype.dragY=function(e,t){var i=this.paddingTop,n=this.paddingBottom,s=0,o=this.parent.yLimited?0:1;this.y=(t-this.yRect-this.yStart)*o,s=this.epubZoom.totalY||this.yOrig;var r=this.calcMaxOnDragCoord(o,s,this.y,this.parent.totalHeight,this.mainViewElementSize.height,i,n);return r!==this.y&&(this.y>0&&this.y<this.correctionY?(this.correctionY=this.y-1,e.gestureData.resetAxis("y")):this.y<0&&this.y>this.correctionY?(this.correctionY=this.y+1,e.gestureData.resetAxis("y")):this.correctionY=this.y),this.y=r,s+this.y},e.prototype.dragX=function(e,t){var i=this.paddingLeft,n=this.paddingRight,s=0,o=this.parent.xLimited?0:1;this.x=(t-this.xRect-this.xStart)*o,s=this.epubZoom.totalX||this.xOrig;var r=this.calcMaxOnDragCoord(o,s,this.x,this.parent.totalWidth,this.mainViewElementSize.width,i,n);return r!==this.x&&(this.x>0&&this.x<this.correctionX?(this.correctionX=this.x-1,e.gestureData.resetAxis("x")):this.x<0&&this.x>this.correctionX?(this.correctionX=this.x+1,e.gestureData.resetAxis("x")):this.correctionX=this.x),this.x=r,s+this.x},e.prototype.drag=function(e,t,i){return this.dragedData=[this.epubZoom.totalScale||this.epubZoom.scaleOrig,0,0,this.dragX(e,t),this.dragY(e,i)],this.dragedData},e.prototype.resetdragY=function(){this.yStart=0,this.y=0},e.prototype.resetdragX=function(){this.xStart=0,this.x=0},e.prototype.resetdrag=function(){this.resetdragX(),this.resetdragY()},e}();i["default"]=n},{}],65:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n,s=e("./utils/functions");!function(e){e.IMAGE="IMAGE",e.MOVIE="MOVIE"}(n||(n={}));var o=function(){function e(e){this.config=e,this.optimizeQuality=!1,this.optimizeQualityStat=!1,this.scale=1,this.scaleLastMax=1,this.x=0,this.y=0}return Object.defineProperty(e.prototype,"spreadViewElementClassName",{get:function(){return this.config.spreadViewElementClassName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomableViewElementClassName",{get:function(){return this.config.zoomableViewElementClassName},enumerable:!0,configurable:!0}),e.prototype.getBackgroundColor=function(e){return e&&e.backgroundColor?e.backgroundColor:"transparent"},e.prototype.getBackgroundImageUrl=function(e){return e&&e.backgroundImage&&e.backgroundImage.relUrl?w.Utils.resolveVariable(e.backgroundImage.relUrl):""},e.prototype.getBackgroundMediaUrl=function(e,t){return e&&e.backgroundMedia&&e.backgroundMedia.type===t?w.Utils.resolveVariable(e.backgroundMedia.relUrl):null},e.prototype.getGeneralBackgroundStyle=function(){return w.Main.configsJsonManager.get("generalData.bgStyle.epubStyle")},e.prototype.getPageBackgroundStyle=function(e){var t=e-1,i=w.Main.configsJsonManager.getPageData(["bgStyle"],t).bgStyle;return i&&i.epubStyle?i.epubStyle:null},e.prototype.getEpubBackgroundStyle=function(e){var t=this.getPageBackgroundStyle(e),i=t&&(t.backgroundMedia||t.backgroundColor||t.backgroundImage);return i?this.getPageBackgroundStyle(e):this.getGeneralBackgroundStyle()},e.prototype.setBackground=function(e){if(0!==e.length){var t,i=this.getEpubBackgroundStyle(e[0].pageNumber),s=i?this.getBackgroundColor(i):w.Main.pageManager.getBackgroundColor(e[0].pageNumber),o=s;if(e.length>1){var r=this.getEpubBackgroundStyle(e[1].pageNumber);o=r?this.getBackgroundColor(r):w.Main.pageManager.getBackgroundColor(e[1].pageNumber)}var a=this.getBackgroundImageUrl(i),u=this.getBackgroundMediaUrl(i,n.IMAGE),l=a||u;t=l?"url("+l+")":"linear-gradient(90deg,"+s+" 50%, "+o+" 50%)",this.background!==t&&(this.background=t,this.element.style.background=t,l&&(this.element.style.backgroundPosition="center",this.element.style.backgroundSize="cover",this.element.style.backgroundRepeat="no-repeat"));var p=this.getBackgroundMediaUrl(i,n.MOVIE),h=this.element.querySelector("video.spread-bgVideo");if(null===h&&p&&(h=document.createElement("video"),h.classList.add("spread-bgVideo"),h.autoplay=!1,h.muted=!0,h.setAttribute("playsinline",""),h.loop=!0,this.element.insertBefore(h,this.element.firstChild)),h)if(p){var c=h.src.split("/"),d=c[c.length-1],f=p.split("/"),m=f[f.length-1],g=d===m;g||(h.src=p)}else h.parentNode&&h.parentNode.removeChild(h)}},e.prototype.initSpread=function(e,t,i,n){this.epubSpread=e,this.config=t,this.epubSpreadZoomable=i,this.spreadIndex=n,this.element=document.createElement("div"),this.element.classList.add(this.spreadViewElementClassName),this.element.classList.add(this.spreadViewElementClassName+"-"+this.spreadIndex),this.element.innerHTML="",this.element.appendChild(this.epubSpreadZoomable.getElement())},e.prototype.initZoomable=function(e,t){this.element=document.createElement("div"),this.element.classList.add(this.zoomableViewElementClassName)},e.prototype.removeChilren=function(){s.htmlSecureRemoveChildren(this.element)},e.prototype.scrollToTop=function(){this.element.scrollTop=0},e.prototype.setSpreadScrollable=function(e){return e===!0?(this.element.style["overflow-y"]="auto",void(this.element.style.webkitOverflowScrolling="touch")):(this.element.style["overflow-y"]="hidden",void(this.element.style.webkitOverflowScrolling="auto"))},e}();i["default"]=o},{"./utils/functions":85}],66:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./View"),s=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.init()}return e.prototype.init=function(){var e=this;w.Main.fullScreenManager.hasFullScreen()!==!1&&(this.panel=new n.View(this.viewPanelParams),this.panel.init().then(function(){e.panel.onClick(e.toggle.bind(e))}))},e.prototype.toggle=function(e){w.Main.fullScreenManager.fullScreenToggle()},e}();i.Controller=s},{"./View":67}],67:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./../panel/View"),o=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/fullscreenToggle/index.html",i.dataSelect="fullscreen-toggle",i.iconID="fullscreen-v4",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},t.prototype.setElements=function(){this.epubEvent=new o.EpubEvent;var e=this.getElement();if(null!==e){var t=document.createElement("div");w.Utils.svgIcon(t,{icon:this.iconID,color:null}),e.innerHTML=t.innerHTML,this.view.appendChild(this.element),this.element.onclick=this.click.bind(this)}},t.prototype.click=function(){this.epubEvent.fire({type:o.EPUB_EVENTS.FULLSCREEN_TOGGLE,data:{range:0}})},t.prototype.onClick=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.FULLSCREEN_TOGGLE,e)},t}(s.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":72}],68:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../zoomMore/Controller"),s=e("../zoomLess/Controller"),o=e("../zoomRange/Controller"),r=e("../pageRange/Controller"),a=e("../zoomReset/Controller"),u=e("../fullscreenToggle/Controller"),l=e("./View"),p=function(){function e(e){this.epubManager=e,this.userAgent=w.Param.userAgent,this.config=this.epubManager.config,this.menuViewPageControlItems=this.config.menuViewPageControlItems,this.viewPanelParams={parentElement:this.epubManager.viewMain},this.setSupportedModules(),this.init()}return e.prototype.init=function(){var e=this;try{if("true"!==this.menuViewPageControlItems.enable||this.userAgent.browser.name===w.Param.userAgent.BROWSER.IE&&w.Param.userAgent.browser.version<11)return}catch(t){return}this.panel=new l.View(this.viewPanelParams),this.panel.init().then(function(t){e.viewChildrenPanelParams={parentElement:t[t.length-1]};for(var i=e.menuViewPageControlItems.children,n=0,s=i.length;n<s;n++)"true"===i[n].enable&&e.supportedModules[i[n].name]&&new e.supportedModules[i[n].name](e.epubManager,e.viewChildrenPanelParams)})},e.prototype.setSupportedModules=function(){this.supportedModules={zoom_range:o.Controller,page_range:r.Controller,zoom_less:s.Controller,zoom_more:n.Controller,zoom_reset:a.Controller,fullscreen_toggle:u.Controller}},e}();i.Controller=p},{"../fullscreenToggle/Controller":66,"../pageRange/Controller":70,"../zoomLess/Controller":73,"../zoomMore/Controller":75,"../zoomRange/Controller":77,"../zoomReset/Controller":79,"./View":69}],69:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./../panel/View"),o=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.classElement="epub-page-control",i.pageControlPath=w.Param.pathTemplate+"epub/component/pageControl/index.html",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.pageControlPath,{})),i[1].then(function(e){t.pageControlElement=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.setElements=function(){this.view.appendChild(this.pageControlElement)},t}(s.View);i.View=o},{"./../panel/View":72}],70:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../EpubEvent"),s=e("./View"),o=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.rangeDelay=50,this.config=this.epubManager.config,this.init()}return Object.defineProperty(e.prototype,"pageQuantity",{get:function(){return this.config.pageQuantity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageNumber",{get:function(){return this.epubManager.currentPage},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.panel=new s.View(this.viewPanelParams,1,this.pageQuantity),this.panel.init().then(function(){e.epubEvent=w.epubEvent,e.panel.updateRange(e.pageNumber),e.epubEvent.addListener(n.EPUB_EVENTS.PAGE_CHANGE,e.pageChange.bind(e)),e.panel.onRangeChange(e.changePage.bind(e))})},e.prototype.changePage=function(e){var t=e.data.range;this.pageNumber!==t&&this.changePageAsync(e)},e.prototype.changePageAsync=function(e){var t=this;clearTimeout(this.timerRange),this.timerRange=setTimeout(function(){t.timerRangeDate=Date.now(),t.epubManager.goToPage(e.data.range)},this.rangeDelay)},e.prototype.pageChange=function(e){var t=this;e.data.pageNumber;NIApi.page.getVisiblePages().then(function(e){var i=e.indexOf(parseInt(t.panel.rangeValue));i!==-1?t.panel.updateRange(e[i]):t.panel.updateRange(e[0])})},e}();i.Controller=o},{"../../EpubEvent":7,"./View":71}],71:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./../panel/View"),o=e("../../EpubEvent"),r=function(e){function t(t,i,n){var s=e.call(this,t)||this;return s.params=t,s.rangeMinValue=i,s.rangeMaxValue=n,s.classElement="epub-page-range",s.pagePanelPath=w.Param.pathTemplate+"epub/component/pageRange/index.html",s.rangeStepValue=1,s}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.pagePanelPath,{_min:this.rangeMinValue.toString(),_max:this.rangeMaxValue.toString(),_step:this.rangeStepValue.toString(),_value:this.rangeValue})),i[1].then(function(e){t.pagePanelElement=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.setElements=function(){this.view.appendChild(this.pagePanelElement),this.epubEvent=new o.EpubEvent,this.createRangeValueElement(),this.createRangeInput()},Object.defineProperty(t.prototype,"rangeValue",{get:function(){return void 0===this._rangeValue&&(this._rangeValue=this.rangeMinValue.toString()),this._rangeValue},set:function(e){this._rangeValue=e,this.updateRangeValueElement()},enumerable:!0,configurable:!0}),t.prototype.rangeChange=function(e){void 0===e&&(e=!0),this.rangeValue=this.rangeElement.value,e!==!1&&this.epubEvent.fire({type:o.EPUB_EVENTS.PAGE_CHANGE,data:{range:this.rangeValue}})},t.prototype.createRangeInput=function(){this.rangeElement=this.pagePanelElement.querySelector("[data-select='range-cursor']"),this.rangeElement.onchange=this.rangeChange.bind(this);try{this.rangeElement.oninput=this.rangeElement.onchange}catch(e){console.warn(e)}this.view.appendChild(this.rangeElement)},t.prototype.createRangeValueElement=function(){this.rangeValueElement=this.pagePanelElement.querySelector("[data-select='range-value']")},t.prototype.updateRangeValueElement=function(){this.rangeValueElement.innerHTML=this.rangeValue.toString()},t.prototype.setStepAttribute=function(e){this.rangeElement.setAttribute("step",e.toString())},t.prototype.updateRange=function(e){this.rangeElement.value=e.toString(),this.rangeChange(!1)},t.prototype.onRangeChange=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.PAGE_CHANGE,e)},t.prototype.removeOnRangeChange=function(e){this.epubEvent.removeListener(o.EPUB_EVENTS.PAGE_CHANGE,e)},t}(s.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":72}],72:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(e){this.params=e,this.classElement="epub-page_control-button",this.shown=!1,this.opened=!1,this.panelTemplatePath=w.Param.pathTemplate+"epub/component/panel/index.html",this.htmlPlaceHolder=document.createElement("div"),this.htmlPlaceHolder.style.display="none",this.params.parentElement.appendChild(this.htmlPlaceHolder)}return e.prototype.init=function(){var e=this,t=this.setView();return t.then(function(){e.addView()}),t},e.prototype.addToView=function(e){this.view.replaceChild(this.htmlPlaceHolder,e)},e.prototype.loadTemplate=function(e,t){var i=document.createElement("div"),n=new Promise(function(n,s){w.Main.templateManager.load(e,i,t).then(function(e){n(e[0])})});return n},e.prototype.setView=function(){var e=this,t=this.loadTemplate(this.panelTemplatePath,{});return t.then(function(t){e.view=t,e.view.classList.add.apply(e.view.classList,e.classElement.split(" "))}),t},e.prototype.addView=function(){this.params.parentElement.replaceChild(this.view,this.htmlPlaceHolder)},e.prototype.show=function(e){e===!0&&this.shown===!1||e===!1&&this.shown===!0},e.prototype.open=function(e){e===!0&&this.opened===!1||e===!1&&this.opened===!0},e}();i.View=n},{}],73:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./View"),s=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.config=this.epubManager.config,this.init()}return e.prototype.init=function(){var e=this;this.panel=new n.View(this.viewPanelParams),this.panel.init().then(function(){e.epubEvent=w.epubEvent,e.panel.onClick(e.zoomChangeLevel.bind(e))})},e.prototype.zoomChangeLevel=function(e){this.epubManager.zoomByStep(e.data.level)},e}();i.Controller=s},{"./View":74}],74:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("../zoomMore/View"),o=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/zoomLess/index.html",i.iconID="minus-v4",i}return n(t,e),t}(s.View);i.View=o},{"../zoomMore/View":76}],75:[function(e,t,i){arguments[4][73][0].apply(i,arguments)},{"./View":76,dup:73}],76:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./../panel/View"),o=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/zoomMore/index.html",i.classElement="epub-page_control-button epub-zoom-steps",i.iconID="plus-v4",i.level=10,i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.getLevelElement=function(){var e;if(e=null!==this.element.getAttribute("data-zoom-step")?this.element:this.element.querySelector("[data-zoom-step]"),null===e)return null;var t=e.getAttribute("data-zoom-step");return null!==t&&(this.level=parseFloat(t)),e},t.prototype.setElements=function(){var e=this.getLevelElement();if(null!==e){var t=document.createElement("div");w.Utils.svgIcon(t,{icon:this.iconID,color:null}),e.innerHTML=t.innerHTML,this.view.appendChild(this.element),this.epubEvent=new o.EpubEvent,this.element.onclick=this.click.bind(this)}},t.prototype.click=function(){this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_LEVEL_CLICK,data:{level:this.level}})},t.prototype.onClick=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_LEVEL_CLICK,e)},t}(s.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":72}],77:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("../../EpubEvent"),s=e("./View"),o=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.config=this.epubManager.config,this.init()}return Object.defineProperty(e.prototype,"maxPageTotalScale",{get:function(){return this.config.maxPageTotalScale},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.panel=new s.View(this.viewPanelParams),this.panel.init().then(function(){e.epubEvent=w.epubEvent,e.epubEvent.addListener(n.EPUB_EVENTS.PAGE_ZOOM,e.zoomChange.bind(e)),e.panel.onRangeChange(e.zoomRangeChange.bind(e))})},e.prototype.zoomRangeChange=function(e){var t=~~e.data.range/100,i=t*this.maxPageTotalScale;this.scale=i,this.zoomRangeChangeAsync()},e.prototype.zoomRangeChangeAsync=function(){var e=this;Date.now()-this.timerScaleDate<16&&clearTimeout(this.timerScale),this.timerScale=setTimeout(function(){e.timerScaleDate=Date.now(),Math.abs(e.scaleLast-e.scale)>.1?e.epubManager.zoomTo(e.scale):e.epubManager.zoomNow(e.scale),e.scaleLast=e.scale},16)},e.prototype.zoomChange=function(e){var t=e.data.scale/this.maxPageTotalScale;this.scaleLast=t;var i=~~(100*t)/100;this.panel.updateRange(i)},e}();i.Controller=o},{"../../EpubEvent":7,"./View":78}],78:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./../panel/View"),o=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.classElement="epub-zoom-range",i.dataSelect="zoom-range-cursor",i.rangeMinValue=0,i.rangeMiddleValue=50,i.rangeMaxValue=100,i.rangeStepValue=2,i.path=w.Param.pathTemplate+"epub/component/zoomRange/index.html",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{_min:this.rangeMinValue.toString(),_max:this.rangeMaxValue.toString(),_step:this.rangeStepValue.toString(),_value:this.rangeValue})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.setElements=function(){this.view.appendChild(this.element),this.epubEvent=new o.EpubEvent,this.createRangeInput()},Object.defineProperty(t.prototype,"rangeValue",{get:function(){return void 0===this._rangeValue&&(this._rangeValue=this.rangeMinValue.toString()),this._rangeValue},set:function(e){this._rangeValue=e},enumerable:!0,configurable:!0}),t.prototype.rangeToggle=function(){var e=parseInt(this.rangeValue);0===e?this.rangeValue=this.rangeMiddleValue.toString():this.rangeValue=this.rangeMinValue.toString(),this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:this.rangeValue}})},t.prototype.rangeChange=function(e){void 0===e&&(e=!0),this.rangeValue=this.rangeElement.value,e!==!1&&this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:this.rangeValue}})},t.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},t.prototype.createRangeInput=function(){this.rangeElement=this.getElement(),this.rangeElement.onchange=this.rangeChange.bind(this);try{this.rangeElement.oninput=this.rangeElement.onchange}catch(e){console.warn(e)}},t.prototype.updateRange=function(e){this.rangeElement.value=Math.round(100*e).toString(),this.rangeChange(!1)},t.prototype.onRangeChange=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},t.prototype.removeOnRangeChange=function(e){this.epubEvent.removeListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},t}(s.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":72}],79:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./View"),s=function(){function e(e,t){this.epubManager=e,this.viewPanelParams=t,this.init()}return e.prototype.init=function(){var e=this;this.panel=new n.View(this.viewPanelParams),this.panel.init().then(function(){e.panel.onClick(e.zoomReset.bind(e))})},e.prototype.zoomReset=function(e){this.epubManager.zoomTo(0)},e}();i.Controller=s},{"./View":80}],80:[function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var s=e("./../panel/View"),o=e("../../EpubEvent"),r=function(e){function t(t){var i=e.call(this,t)||this;return i.params=t,i.path=w.Param.pathTemplate+"epub/component/zoomReset/index.html",i.dataSelect="zoom-reset",i.iconID="close-1-v4",i}return n(t,e),t.prototype.setView=function(){var t=this,i=[];i.push(e.prototype.setView.call(this)),i.push(this.loadTemplate(this.path,{})),i[1].then(function(e){t.element=e});var n=Promise.all(i);return n.then(function(){t.setElements()}),n},t.prototype.getElement=function(){var e;return e=this.element.getAttribute("data-select")===this.dataSelect?this.element:this.element.querySelector("[data-select='"+this.dataSelect+"']")},t.prototype.setElements=function(){this.epubEvent=new o.EpubEvent;var e=this.getElement();if(null!==e){var t=document.createElement("div");w.Utils.svgIcon(t,{icon:this.iconID,color:null}),e.innerHTML=t.innerHTML,this.view.appendChild(this.element),this.element.onclick=this.click.bind(this)}},t.prototype.click=function(){this.epubEvent.fire({type:o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,data:{range:0}})},t.prototype.onClick=function(e){this.epubEvent.addListener(o.EPUB_EVENTS.ZOOM_CONTROLLER_RANGE,e)},t}(s.View);i.View=r},{"../../EpubEvent":7,"./../panel/View":72}],81:[function(e,t,i){"use strict";function n(){function e(e,t){var n=i.prototype,s=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||function(e){return[].indexOf.call(document.querySelectorAll(e),this)!==-1};return s.call(e,t)}function t(t){for(var i;i=this.parentElement;)if(e(i,t))return i}var i=window.Element;i&&!i.prototype.closest&&(i.prototype.closest=t)}Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=n},{}],82:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),e("es6-promise");var n=function(){function e(){}return e.GET="GET",e.get="GET",e.POST="POST",e.post="POST",e}();i.Protocol=n;var s=function(){function e(e,t,i){void 0===e&&(e=n.GET),void 0===t&&(t=""),void 0===i&&(i=null),this.protocol=e,this.url=t,this.data=i,this.xhr=new XMLHttpRequest}return e.prototype.onreadystatechange=function(){if(4===this.xhr.readyState)return 404===this.xhr.status?void this.reject(this):void this.resolve(this.xhr)},e.prototype.executeur=function(e,t){this.resolve=e,this.reject=t,this.xhr.open(this.protocol,this.url,!0),this.xhr.onreadystatechange=this.onreadystatechange.bind(this),this.xhr.send(this.data)},e.prototype.init=function(){return new Promise(this.executeur.bind(this))},e}();i["default"]=s},{"es6-promise":1}],83:[function(e,t,i){"use strict";function n(e){if(e.element.style.transitionDuration="0",e.optimizeQualityStat!==!0){var t=e.scale;e.optimizeQualityStat=!0,u[0]=t,u[3]=t,u[4]=e.x,u[5]=e.y,e.frameTimer2d=r.styleTransform(e.element,"matrix("+u.join(",")+")")}}function s(e,t,i,s,o,l){if(i=~~(1e3*i)/1e3,s=~~s,o=~~o,t.scale!==i||t.x!==s||t.y!==o||t.optimizeQualityStat!==!0){t.scale=i,t.x=s,t.y=o,t.matrix2d=t.matrix2d||n.bind(null,t);var p;e?(a[0]=i,a[5]=i,a[12]=s,a[13]=o,p="matrix3d("+a.join(",")+")"):(u[0]=i,u[3]=i,u[4]=s,u[5]=o,p="matrix("+u.join(",")+")"),cancelAnimationFrame(t.frameTimer3d),t.frameTimer3d=r.styleTransform(t.element,p,function(){t.element.style.transitionDuration=(l||"0")+"ms"}),t.optimizeQualityStat=!1,cancelAnimationFrame(t.frameTimer2d),clearTimeout(t.timer)}}function o(e,t,i,n,s){e.scale===t&&e.x===i&&e.y===n||(e.scale=t,e.x=i,e.y=n,e.element.style.cssText+="transition-duration:"+(s+"ms"||"0")+" ;transform: none; left: "+i/t+"px; top: "+n/t+"px; zoom: "+t+";",e.optimizeQualityStat=!1)}Object.defineProperty(i,"__esModule",{value:!0});var r=e("./functions"),a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[1,0,0,1,0,0];i.matrixAsync=s,i.positionDomAsync=o},{"./functions":85}],84:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;!function(e){e[e.EPUB_HTML=0]="EPUB_HTML",e[e.PDF_HTML=1]="PDF_HTML",e[e.PDF_SVG=2]="PDF_SVG",e[e.PDF_IMG=3]="PDF_IMG",e[e.PDF_PDF=4]="PDF_PDF"}(n=i.READER_TYPES||(i.READER_TYPES={}));var s;!function(e){e[e.INIT=0]="INIT",e[e.START=1]="START",e[e.STOP=2]="STOP",e[e.FLUSH=3]="FLUSH"}(s=i.ShapeActivityStatus||(i.ShapeActivityStatus={}));var o;!function(e){e[e.blink=0]="blink",e[e["static"]=1]="static",e[e.none=2]="none",e[e.revealOnTap=3]="revealOnTap"}(o=i.LinksBehaviors||(i.LinksBehaviors={}));var r;!function(e){e[e.hdpi=0]="hdpi",e[e.mdpi=1]="mdpi",e[e.ldpi=2]="ldpi",e[e.svg=3]="svg"}(r=i.PagesImagesQualities||(i.PagesImagesQualities={}))},{}],85:[function(e,t,i){"use strict";function n(e,t){void 0===t&&(t=1);var i=e.getBoundingClientRect();return{bottom:i.bottom*t,height:i.height*t,left:i.left*t,top:i.top*t,width:i.width*t}}function s(e){for(var t;t=e.lastChild;)e.removeChild(t)}function o(e){var t=e.tagName.toLowerCase();return"video"===t||"audio"===t}function r(){return w.Param.isPortrait=window.innerWidth<=window.innerHeight,!w.Param.isPortrait}function a(){var e=window.innerHeight/document.documentElement.clientHeight*100;document.documentElement.style.height=e+"%"}function u(){var e={promise:null,resolve:null,reject:null,then:function(){}};e.promise=new Promise(function(t,i){e.resolve=t,e.reject=i});var t=e.promise;return e.then=t.then.bind(t),e}function l(e){var t=/[+-]?\d+(\.\d+)?/g,i=e.match(t);return i?+i[0]:0}Object.defineProperty(i,"__esModule",{value:!0}),i.getBoundingClientRect=n;var p=function(){var e="transform";return"transform"in document.body.style?e="transform":"webkitTransform"in document.body.style?e="webkitTransform":"msTransform"in document.body.style&&(e="msTransform"),function(t,i,n){return window.requestAnimationFrame(function(){n&&n(),t.style[e]=i})}}();i.styleTransform=p,i.htmlSecureRemoveChildren=s,i.isMediaElement=o,i.isWindowLandscape=r,i.resizeHTMLTagElement=a,i.getSplitedPromise=u,i.getNumberFromString=l},{}],86:[function(e,t,i){"use strict";function n(){return"ontouchstart"in window||navigator.maxTouchPoints>0}Object.defineProperty(i,"__esModule",{value:!0}),i.isTouchSupported=n},{}],87:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n;!function(e){e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.VIDEO_CUED=5]="VIDEO_CUED"}(n||(n={}));var s=function(e){return w.Main.consentManager&&w.Main.consentManager.getServiceConsent("webpublicationYoutube")===!0?e:e.replace("www.youtube.com","www.youtube-nocookie.com")};i.getCorrectYoutubeDomain=s},{}]},{},[13]);